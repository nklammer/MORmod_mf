# GAS WATER HEATERS AS A STAND-IN
After extensive testing, my knowledge of the OpenStudio SDK is not enough to solve the problem of using Ideal Air Loads in models with HPWHs. Instead I have opted for a gas heater tank to complete my comparison table for my thesis. This way, the latent and sensible gains of DHW use are reflected in my sizing calculations.


# NOTES
I do not recommend using the OpenStudio visual application to do ideal air loads.

# CLUSTER VARIABLES
The variable chosen for clustering is the idealized cooling load (sensible and latent) from the ZoneHVAC:IdealLoadsAirSystem objects, `Zone Ideal Loads Zone Total Cooling Energy`.

# STANDARDS BUG
Currently, only ASHRAE90.1-2013 is supported in `Standard.build('90.1-2013')`. Trying to use `'ZE AEDG Multifamily'` throws an error. The `openstudio-standards` library tries to invoke the method `#model_apply_hvac_efficiency_standard` whose definition a line:
`model.getWaterHeaterMixeds.sort.each { |obj| water_heater_mixed_apply_efficiency_and_curves(obj) }`. The WaterHeater:Mixed objects include those used with natural gas fuel.
There is likely a difference in JSON data between standards `90.1-2013` and `ZE AEDG Multifamily` and this is causing a error to be thrown. `String can't be coerced into Float` for the ruby line `ef = base_ef - (vol_drt * volume_gal)` in `standards/Standards.WaterHeaterMixed.rb`.
This comes from the `wh_props` array that is generated by the method call `model_find_object(standards_data['water_heaters'], search_criteria, capacity_btu_per_hr)`
Look for `#model_find_object` method in class `Standard`.
The answer lies in the file `standards/ashrae_90_1/*/data/ze_aedg_multifamily.water_heaters.json`.
There are four templates for water heaters. My natural gas water heaters in units fall under:

`     "template": "ZE AEDG Multifamily",
      "fuel_type": "NaturalGas",
      "minimum_capacity": 0.0,
      "maximum_capacity": 74999.99,
      "start_date": "1919-09-09T00:00:00+00:00",
      "end_date": "2999-09-09T00:00:00+00:00",
      "energy_factor_base": 0.67,
      "energy_factor_volume_derate": "",
      "standby_loss_base": null,
      "standby_loss_capacity_allowance": null,
      "standby_loss_volume_allowance": null,
      "hourly_loss_base": null,
      "hourly_loss_volume_allowance": null,
      "thermal_efficiency": null,
      "notes": "Code of Federal Regulations 10 CFR Part 430."
`

when in standard `'90.1-2013'` water heater templates look like:

`    {
      "template": "90.1-2013",
      "fuel_type": "NaturalGas",
      "minimum_capacity": 0.0,
      "maximum_capacity": 74999.99,
      "start_date": "1919-09-09T00:00:00+00:00",
      "end_date": "2999-09-09T00:00:00+00:00",
      "energy_factor_base": 0.67,
      "energy_factor_volume_derate": 0.0019,
      "standby_loss_base": null,
      "standby_loss_capacity_allowance": null,
      "standby_loss_volume_allowance": null,
      "hourly_loss_base": null,
      "hourly_loss_volume_allowance": null,
      "thermal_efficiency": null,
      "notes": "From 90.1-2013 Table 7.8"
    },
`
# STANDARDS BUG WORKAROUND
I put the gem `openstudio-standards-0.2.13` in the case subfolder. I then run on the CLI:
`openstudio --verbose -I C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/openstudio-standards-0.2.13/lib`
and test it true with:
`-e "require 'openstudio-standards'" -e "puts OpenstudioStandards::VERSION"`

`C:/custom_os_standards/openstudio-standards-0.2.13/lib`

