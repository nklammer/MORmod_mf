<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Ze multifamily</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.2/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.2/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.2/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.2/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.2/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2021-02-18T10:53:34-07:00">2021-02-18T10:53:34-07:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">23.33%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         115.06
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>10</b> files in total.
    <b>5855</b> relevant lines. 
    <span class="green"><b>1366</b> lines covered</span> and
    <span class="red"><b>4489</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#e3f4cdfa05ded6d96be418bd4dfa208fef6fc9b3" class="src_link" title="measures/HPXMLtoOpenStudio/resources/constants.rb">measures/HPXMLtoOpenStudio/resources/constants.rb</a></td>
        <td class="red strong">43.84 %</td>
        <td>1477</td>
        <td>787</td>
        <td>345</td>
        <td>442</td>
        <td>4.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ab6c9d48711bcc527f75f63ab958a843bacca2c4" class="src_link" title="measures/HPXMLtoOpenStudio/resources/geometry.rb">measures/HPXMLtoOpenStudio/resources/geometry.rb</a></td>
        <td class="red strong">12.7 %</td>
        <td>2004</td>
        <td>1220</td>
        <td>155</td>
        <td>1065</td>
        <td>1.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#612e7db5149b5b3c1dcde194505c8c6038e5cc49" class="src_link" title="measures/HPXMLtoOpenStudio/resources/materials.rb">measures/HPXMLtoOpenStudio/resources/materials.rb</a></td>
        <td class="red strong">40.89 %</td>
        <td>565</td>
        <td>269</td>
        <td>110</td>
        <td>159</td>
        <td>0.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#23e66f8ac7cb169893785d2f9f0b43d4f3ef9d09" class="src_link" title="measures/HPXMLtoOpenStudio/resources/psychrometrics.rb">measures/HPXMLtoOpenStudio/resources/psychrometrics.rb</a></td>
        <td class="red strong">12.35 %</td>
        <td>921</td>
        <td>243</td>
        <td>30</td>
        <td>213</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b938637b8a673ce33a589b0c60b078eeb0653b18" class="src_link" title="measures/HPXMLtoOpenStudio/resources/schedules.rb">measures/HPXMLtoOpenStudio/resources/schedules.rb</a></td>
        <td class="red strong">36.15 %</td>
        <td>1016</td>
        <td>650</td>
        <td>235</td>
        <td>415</td>
        <td>993.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#384c393ea7b735cce18fd405d761af909be7a8f2" class="src_link" title="measures/HPXMLtoOpenStudio/resources/unit_conversions.rb">measures/HPXMLtoOpenStudio/resources/unit_conversions.rb</a></td>
        <td class="red strong">33.67 %</td>
        <td>358</td>
        <td>294</td>
        <td>99</td>
        <td>195</td>
        <td>57.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b4eac09eb29ede414a3f438670ed93c930701d59" class="src_link" title="measures/HPXMLtoOpenStudio/resources/util.rb">measures/HPXMLtoOpenStudio/resources/util.rb</a></td>
        <td class="red strong">8.26 %</td>
        <td>1474</td>
        <td>835</td>
        <td>69</td>
        <td>766</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6a7596d8745120e6b52f7f21cdccff6dcf15dcdc" class="src_link" title="measures/HPXMLtoOpenStudio/resources/waterheater.rb">measures/HPXMLtoOpenStudio/resources/waterheater.rb</a></td>
        <td class="red strong">4.51 %</td>
        <td>1259</td>
        <td>843</td>
        <td>38</td>
        <td>805</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0aa39e41020e8931587412864b17907370c35c3d" class="src_link" title="measures/HPXMLtoOpenStudio/resources/weather.rb">measures/HPXMLtoOpenStudio/resources/weather.rb</a></td>
        <td class="red strong">9.17 %</td>
        <td>736</td>
        <td>458</td>
        <td>42</td>
        <td>416</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bd7e86cc71296baf36f11dc1c3c7434beed899f7" class="src_link" title="measures/ResidentialHotWaterFixtures/measure.rb">measures/ResidentialHotWaterFixtures/measure.rb</a></td>
        <td class="green strong">94.92 %</td>
        <td>410</td>
        <td>256</td>
        <td>243</td>
        <td>13</td>
        <td>18.1</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.17.1 
        and simplecov-html v0.10.2<br/>
        using MiniTest
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="e3f4cdfa05ded6d96be418bd4dfa208fef6fc9b3">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/constants.rb</h3>
    <h4><span class="red">43.84 %</span> covered</h4>
    <div>
      <b>787</b> relevant lines. 
      <span class="green"><b>345</b> lines covered</span> and
      <span class="red"><b>442</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Constants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  # Numbers --------------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AssumedInsideTemp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    return 73.5 # deg-F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DefaultCoolingSetpoint</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    return 76.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DefaultFramingFactorCeiling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    return 0.11</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DefaultFramingFactorFloor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    return 0.13</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DefaultFramingFactorInterior</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    return 0.16</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DefaultHeatingSetpoint</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    return 71.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DefaultHumiditySetpoint</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    return 0.60</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.g</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    return 32.174 # gravity (ft/s2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MixedUseT</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="37">
          <span class="hits">21</span>
          
          <code class="ruby">    return 110 # F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.NumDaysInMonths(is_leap_year = false)</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="41">
          <span class="hits">176</span>
          
          <code class="ruby">    num_days_in_months = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="42">
          <span class="hits">176</span>
          
          <code class="ruby">    num_days_in_months[1] += 1 if is_leap_year</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="43">
          <span class="hits">176</span>
          
          <code class="ruby">    return num_days_in_months</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.NumDaysInYear(is_leap_year = false)</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="47">
          <span class="hits">176</span>
          
          <code class="ruby">    num_days_in_months = NumDaysInMonths(is_leap_year)</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="48">
          <span class="hits">176</span>
          
          <code class="ruby">    num_days_in_year = num_days_in_months.reduce(:+)</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="49">
          <span class="hits">176</span>
          
          <code class="ruby">    return num_days_in_year.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.NumHoursInYear(is_leap_year = false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    num_days_in_year = NumDaysInYear(is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    num_hours_in_year = num_days_in_year * 24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    return num_hours_in_year.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.NumApplyUpgradeOptions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    return 25</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.NumApplyUpgradesCostsPerOption</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    return 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Patm</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    return 14.696 # standard atmospheric pressure (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.small</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    return 1e-9</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  # Strings --------------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilm</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    return &#39;AirFilm&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Auto</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="81">
          <span class="hits">194</span>
          
          <code class="ruby">    return &#39;auto&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ColorWhite</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    return &#39;white&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ColorLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    return &#39;light&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ColorMedium</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    return &#39;medium&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ColorDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    return &#39;dark&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CoordRelative</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    return &#39;relative&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CoordAbsolute</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    return &#39;absolute&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneCold</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    return &#39;Cold&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneHotDry</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">    return &#39;Hot-Dry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneSubarctic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    return &#39;Subarctic&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneHotHumid</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    return &#39;Hot-Humid&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneMixedHumid</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">    return &#39;Mixed-Humid&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneMixedDry</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    return &#39;Mixed-Dry&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneMarine</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">    return &#39;Marine&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BAZoneVeryCold</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">    return &#39;Very Cold&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoilerTypeCondensing</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    return &#39;hot water, condensing&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoilerTypeNaturalDraft</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    return &#39;hot water, natural draft&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoilerTypeForcedDraft</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">    return &#39;hot water, forced draft&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoilerTypeSteam</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">    return &#39;steam&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigSingle</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">    return &#39;single&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigLine</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">    return &#39;line&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="164">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigOpenRectangle</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">    return &#39;open-rectangle&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigRectangle</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">    return &#39;rectangle&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigLconfig</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">    return &#39;l-config&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigL2config</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">    return &#39;l2-config&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BoreConfigUconfig</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">    return &#39;u-config&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="184">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingAmericaClimateZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">    return &#39;Building America&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="188">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingTypeMultifamily</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    return &#39;multifamily&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingTypeSingleFamilyAttached</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">    return &#39;singlefamilyattached&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingTypeSingleFamilyDetached</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">    return &#39;singlefamilydetached&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="200">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingTypeMixedUseMultifamily</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">    return &#39;mixeduse-multifamily&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingUnitFeatureNumBathrooms</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="205">
          <span class="hits">22</span>
          
          <code class="ruby">    return &#39;NumberOfBathrooms&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingUnitFeatureNumBedrooms</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="209">
          <span class="hits">22</span>
          
          <code class="ruby">    return &#39;NumberOfBedrooms&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.BuildingUnitTypeResidential</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="213">
          <span class="hits">22</span>
          
          <code class="ruby">    return &#39;Residential&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalcTypeERIRatedHome</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">    return &#39;ERI Rated Home&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalcTypeERIReferenceHome</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="221">
          
          
          <code class="ruby">    return &#39;ERI Reference Home&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalcTypeERIIndexAdjustmentDesign</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="225">
          
          
          <code class="ruby">    return &#39;ERI Index Adjustment Design&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalcTypeERIIndexAdjustmentReferenceHome</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="229">
          
          
          <code class="ruby">    return &#39;ERI Index Adjustment Reference Home&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalcTypeStandard</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="233">
          
          
          <code class="ruby">    return &#39;Standard&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CeilingFanControlTypical</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="237">
          
          
          <code class="ruby">    return &#39;typical&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="240">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CeilingFanControlSmart</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">    return &#39;smart&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="244">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesDryerCEF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="248">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesDryerMult</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="252">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesDryerFuelType</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesDryerFuelSplit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesWasherDrumVolume</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesWasherIMEF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="268">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesWasherRatedAnnualEnergy</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="272">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ClothesWasherDayShift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="276">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CondenserTypeWater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">    return &#39;watercooled&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="280">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.DuctedInfoMiniSplitHeatPump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="281">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="284">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FacadeFront</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">    return &#39;front&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="288">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FacadeBack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">    return &#39;back&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="292">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FacadeLeft</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">    return &#39;left&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="296">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FacadeRight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="297">
          
          
          <code class="ruby">    return &#39;right&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="300">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FacadeNone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">    return &#39;none&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="304">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FluidWater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">    return &#39;water&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="308">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FluidPropyleneGlycol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">    return &#39;propylene-glycol&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="312">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FluidEthyleneGlycol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">    return &#39;ethylene-glycol&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="316">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">    return &#39;electric&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="320">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FuelTypeGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">    return &#39;gas&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="324">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FuelTypePropane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">    return &#39;propane&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="328">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">    return &#39;oil&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="332">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FuelTypeWood</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    return &#39;wood&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="336">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.LocationInterior</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">    return &#39;interior&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="340">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.LocationExterior</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">    return &#39;exterior&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="344">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MaterialCopper</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">    return &#39;copper&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="348">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MaterialGypcrete</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">    return &#39;crete&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="352">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MaterialGypsum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    return &#39;gyp&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="356">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MaterialOSB</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="357">
          
          
          <code class="ruby">    return &#39;osb&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="360">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MaterialPEX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="361">
          
          
          <code class="ruby">    return &#39;pex&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="364">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.MonthNames</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">    return [&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;, &#39;May&#39;, &#39;Jun&#39;, &#39;Jul&#39;, &#39;Aug&#39;, &#39;Sep&#39;, &#39;Oct&#39;, &#39;Nov&#39;, &#39;Dec&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="368">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVArrayTypeFixedOpenRack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">    return &#39;FixedOpenRack&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="372">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVArrayTypeFixedRoofMount</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="373">
          
          
          <code class="ruby">    return &#39;FixedRoofMounted&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="376">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVArrayTypeFixed1Axis</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">    return &#39;OneAxis&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="380">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVArrayTypeFixed1AxisBacktracked</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="381">
          
          
          <code class="ruby">    return &#39;OneAxisBacktracking&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="384">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVArrayTypeFixed2Axis</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">    return &#39;TwoAxis&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="388">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVModuleTypeStandard</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">    return &#39;Standard&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="392">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVModuleTypePremium</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">    return &#39;Premium&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="396">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVModuleTypeThinFilm</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="397">
          
          
          <code class="ruby">    return &#39;ThinFilm&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="400">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVNetMeteringExcessRetailElectricityCost</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">    return &#39;retail electricity cost&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="404">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVNetMeteringExcessUserSpecified</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="405">
          
          
          <code class="ruby">    return &#39;user-specified&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="408">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVTypeFeedInTariff</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">    return &#39;Feed-In Tariff&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="412">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PVTypeNetMetering</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">    return &#39;Net Metering&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="416">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameAirflow(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="418">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="421">
          
          
          <code class="ruby">    return &quot;res af#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="424">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameAirSourceHeatPump(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="427">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="429">
          
          
          <code class="ruby">    return &quot;res ashp#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="432">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameBath(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="433">
          <span class="hits">71</span>
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="434">
          <span class="hits">71</span>
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="435">
          <span class="hits">10</span>
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="437">
          <span class="hits">71</span>
          
          <code class="ruby">    return &quot;res bath#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="440">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameBathDist(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="443">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">    return &quot;res bath dist#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="448">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameBoiler(fueltype = &quot;&quot;, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="452">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="453">
          
          
          <code class="ruby">    return &quot;res boiler #{fueltype}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="454">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="455">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="456">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameBuildingUnit(unit_num = 1)</code>
        </li>
      
        <li class="covered" data-hits="467" data-linenumber="457">
          <span class="hits">467</span>
          
          <code class="ruby">    return &quot;unit #{unit_num}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="460">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCeilingFan(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="465">
          
          
          <code class="ruby">    return &quot;res ceil fan#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="468">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCentralAirConditioner(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="469">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="471">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="473">
          
          
          <code class="ruby">    return &quot;res ac#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="475">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="476">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCentralSystemBoilerBaseboards(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="477">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="478">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="479">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="480">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="481">
          
          
          <code class="ruby">    return &quot;res central system boiler baseboards#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="484">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCentralSystemFanCoil(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="485">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="487">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="488">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    return &quot;res central system fan coil#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="492">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCentralSystemPTAC(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="494">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="495">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="496">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="497">
          
          
          <code class="ruby">    return &quot;res central system ptac#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="500">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameClothesWasher(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="501">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="502">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="503">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">    return &quot;res cw#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="508">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameClothesDryer(fueltype, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="509">
          
          
          <code class="ruby">    s_fuel = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">    if not fueltype.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">      s_fuel = &quot; #{fueltype}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="513">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="515">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">    return &quot;res cd#{s_fuel}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="518">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="520">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCookingRange(fueltype, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="521">
          
          
          <code class="ruby">    s_fuel = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="522">
          
          
          <code class="ruby">    if not fueltype.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="523">
          
          
          <code class="ruby">      s_fuel = &quot; #{fueltype}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="525">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="526">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="527">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">    return &quot;res range#{s_fuel}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="530">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="532">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCoolingSeason</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="533">
          
          
          <code class="ruby">    return &#39;res cooling season&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="534">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="536">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameCoolingSetpoint</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="537">
          
          
          <code class="ruby">    return &#39;res cooling setpoint&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="540">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameDehumidifier(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="541">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="543">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    return &quot;res dehumid#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="548">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameDishwasher(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="549">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="550">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="551">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="553">
          
          
          <code class="ruby">    return &quot;res dw#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="556">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameDucts(airloop_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="557">
          
          
          <code class="ruby">    return &quot;res ds #{airloop_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="560">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameEaves(facade = &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="561">
          
          
          <code class="ruby">    if facade != &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="562">
          
          
          <code class="ruby">      facade = &quot; #{facade}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="564">
          
          
          <code class="ruby">    return &quot;res eaves#{facade}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="566">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="567">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameElectricBaseboard(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="568">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">    return &quot;res bb#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="575">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameExtraRefrigerator(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="576">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="577">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="580">
          
          
          <code class="ruby">    return &quot;res extra refrig#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="581">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="583">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameFreezer(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="584">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="585">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="588">
          
          
          <code class="ruby">    return &quot;res freezer#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="589">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="590">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="591">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameFurnace(fueltype = &quot;&quot;, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="592">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="593">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="594">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="595">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="596">
          
          
          <code class="ruby">    return &quot;res fur #{fueltype}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="597">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="598">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="599">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameFurniture</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="600">
          
          
          <code class="ruby">    return &quot;res furniture&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="601">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="603">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameGasFireplace(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="604">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="605">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="606">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="608">
          
          
          <code class="ruby">    return &quot;res gas fireplace#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="609">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="610">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="611">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameGasGrill(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="612">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="613">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="614">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="615">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">    return &quot;res gas grill#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="617">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="618">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="619">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameGasLighting(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="620">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="621">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="622">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="623">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="624">
          
          
          <code class="ruby">    return &quot;res gas lighting#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="625">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="627">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameGroundSourceHeatPumpVerticalBore(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="628">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="629">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="630">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="632">
          
          
          <code class="ruby">    return &quot;res gshp vert bore#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="635">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameHeatingSeason</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="636">
          
          
          <code class="ruby">    return &#39;res heating season&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="637">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="638">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="639">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameHeatingSetpoint</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">    return &#39;res heating setpoint&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="642">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="643">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameHotTubHeater(fueltype, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="644">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="645">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="647">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="648">
          
          
          <code class="ruby">    return &quot;res hot tub heater #{fueltype}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="651">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameHotTubPump(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="652">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="653">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="654">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="655">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="656">
          
          
          <code class="ruby">    return &quot;res hot tub pump#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="657">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="658">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="659">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameHotWaterRecircPump(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="660">
          <span class="hits">21</span>
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="661">
          <span class="hits">21</span>
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="662">
          <span class="hits">10</span>
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="663">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="664">
          <span class="hits">21</span>
          
          <code class="ruby">    return &quot;res hot water recirc pump#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="665">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="666">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="667">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameHotWaterDistribution(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="668">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="669">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="670">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="672">
          
          
          <code class="ruby">    return &quot;res hot water distribution#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="675">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameInfiltration(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="676">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="679">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="680">
          
          
          <code class="ruby">    return &quot;res infil#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="683">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameLightingInterior(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="684">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="685">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="686">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="688">
          
          
          <code class="ruby">    return &quot;res lighting interior#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="691">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameLightingGarage</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="692">
          
          
          <code class="ruby">    return &quot;res lighting garage&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="693">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="694">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="695">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameLightingExterior</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="696">
          
          
          <code class="ruby">    return &quot;res lighting exterior&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="697">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="699">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameLightingExteriorHoliday</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="700">
          
          
          <code class="ruby">    return &quot;res lighting exterior holiday&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="701">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="702">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="703">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameMechanicalVentilation(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="704">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="705">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="706">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="707">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="708">
          
          
          <code class="ruby">    return &quot;res mv#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="709">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="710">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="711">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameMiniSplitHeatPump(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="712">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="713">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="714">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="715">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="716">
          
          
          <code class="ruby">    return &quot;res ms#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="717">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="719">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameMiscPlugLoads(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="720">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="721">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="722">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="723">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">    return &quot;res misc plug loads#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="725">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="726">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="727">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameMiscTelevision(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="728">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="729">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="730">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="731">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">    return &quot;res misc television#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="734">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="735">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameNaturalVentilation(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="736">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="737">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="738">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="739">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="740">
          
          
          <code class="ruby">    return &quot;res nv#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="741">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="743">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameNeighbors(facade = &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="744">
          
          
          <code class="ruby">    if facade != &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="745">
          
          
          <code class="ruby">      facade = &quot; #{facade}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="747">
          
          
          <code class="ruby">    return &quot;res neighbors#{facade}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="748">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="749">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="750">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameOccupants(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="751">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="752">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="753">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="754">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="755">
          
          
          <code class="ruby">    return &quot;res occupants#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="758">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameOverhangs(facade = &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="759">
          
          
          <code class="ruby">    if facade != &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="760">
          
          
          <code class="ruby">      facade = &quot; #{facade}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="761">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="762">
          
          
          <code class="ruby">    return &quot;res overhangs#{facade}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="763">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="764">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="765">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNamePhotovoltaics(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="766">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="767">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="768">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="769">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="770">
          
          
          <code class="ruby">    return &quot;res photovoltaics#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="771">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="773">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNamePoolHeater(fueltype, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="777">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="778">
          
          
          <code class="ruby">    return &quot;res pool heater #{fueltype}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="779">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="781">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNamePoolPump(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="782">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="783">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="784">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="786">
          
          
          <code class="ruby">    return &quot;res pool pump#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="788">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="789">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameRefrigerator(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="790">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="791">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="792">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="793">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="794">
          
          
          <code class="ruby">    return &quot;res refrig#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="796">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="797">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameRelativeHumiditySetpoint(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="798">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="799">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="800">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="802">
          
          
          <code class="ruby">    return &quot;res rh setpoint#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="803">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="804">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="805">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameRoomAirConditioner(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="806">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="807">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="809">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">    return &quot;res room ac#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="811">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="813">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameShower(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="814">
          <span class="hits">85</span>
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="815">
          <span class="hits">85</span>
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="816">
          <span class="hits">10</span>
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="818">
          <span class="hits">85</span>
          
          <code class="ruby">    return &quot;res shower#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="819">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="820">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="821">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameShowerDist(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="823">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="824">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="825">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="826">
          
          
          <code class="ruby">    return &quot;res shower dist#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="827">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="829">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameSink(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="830">
          <span class="hits">71</span>
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="831">
          <span class="hits">71</span>
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="832">
          <span class="hits">10</span>
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="833">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="834">
          <span class="hits">71</span>
          
          <code class="ruby">    return &quot;res sink#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="835">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="837">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameSinkDist(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="838">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="839">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="840">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="841">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="842">
          
          
          <code class="ruby">    return &quot;res sink dist#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="843">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="844">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="845">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameSolarHotWater(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="846">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="847">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="848">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="849">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="850">
          
          
          <code class="ruby">    return &quot;res solar hot water#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="851">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="852">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="853">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameUnitHeater(fueltype = &quot;&quot;, unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="854">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="855">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="856">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="857">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="858">
          
          
          <code class="ruby">    return &quot;res unit heater #{fueltype}#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="859">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="860">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="861">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameWaterHeater(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="862">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="863">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="864">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="865">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="866">
          
          
          <code class="ruby">    return &quot;res wh#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="867">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="868">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="869">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameWellPump(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="870">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="871">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="872">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="873">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="874">
          
          
          <code class="ruby">    return &quot;res well pump#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="876">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="877">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ObjectNameElectricVehicle(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="878">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="879">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="880">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="881">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="882">
          
          
          <code class="ruby">    return &quot;res electric vehicle#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="883">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="884">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="885">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OptionTypeLightingFractions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="886">
          
          
          <code class="ruby">    return &#39;Lamp Fractions&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="887">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="888">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="889">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OptionTypeLightingEnergyUses</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="890">
          
          
          <code class="ruby">    return &#39;Annual Energy Uses&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="891">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="892">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="893">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OptionTypeLightingScheduleCalculated</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="894">
          
          
          <code class="ruby">    return &#39;Calculated Lighting Schedule&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="895">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="896">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="897">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OptionTypeLightingScheduleUserSpecified</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="898">
          
          
          <code class="ruby">    return &#39;User-Specified Lighting Schedule&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="899">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="900">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="901">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OptionTypePlugLoadsMultiplier</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="902">
          
          
          <code class="ruby">    return &#39;Multiplier&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="903">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="904">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="905">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OptionTypePlugLoadsEnergyUse</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="906">
          
          
          <code class="ruby">    return &#39;Annual Energy Use&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="907">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="908">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="909">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PipeTypeTrunkBranch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="910">
          
          
          <code class="ruby">    return &#39;trunk and branch&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="911">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="913">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PipeTypeHomeRun</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="914">
          
          
          <code class="ruby">    return &#39;home run&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="915">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="916">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="917">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PlantLoopDomesticWater(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="918">
          <span class="hits">55</span>
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="919">
          <span class="hits">55</span>
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="920">
          <span class="hits">44</span>
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="922">
          <span class="hits">55</span>
          
          <code class="ruby">    return &quot;Domestic Hot Water Loop#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="923">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="924">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="925">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PlantLoopSolarHotWater(unit_name = self.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="926">
          
          
          <code class="ruby">    s_unit = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="927">
          
          
          <code class="ruby">    if unit_name != self.ObjectNameBuildingUnit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="928">
          
          
          <code class="ruby">      s_unit = &quot;|#{unit_name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="929">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="930">
          
          
          <code class="ruby">    return &quot;Solar Hot Water Loop#{s_unit}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="931">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="932">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="933">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RADuctZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="934">
          
          
          <code class="ruby">    return &#39;RA Duct Zone&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="935">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="936">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="937">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RecircTypeTimer</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="938">
          
          
          <code class="ruby">    return &#39;timer&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="939">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="940">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="941">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RecircTypeDemand</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="942">
          
          
          <code class="ruby">    return &#39;demand&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="943">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="944">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="945">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RecircTypeNone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="946">
          
          
          <code class="ruby">    return &#39;none&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="947">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="948">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="949">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterialAsphaltShingles</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="950">
          
          
          <code class="ruby">    return &#39;asphalt shingles&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="951">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="952">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="953">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterialMembrane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="954">
          
          
          <code class="ruby">    return &#39;membrane&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="955">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="956">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="957">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterialMetal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="958">
          
          
          <code class="ruby">    return &#39;metal&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="959">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="960">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="961">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterialTarGravel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="962">
          
          
          <code class="ruby">    return &#39;tar gravel&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="963">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="964">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="965">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterialTile</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="966">
          
          
          <code class="ruby">    return &#39;tile&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="967">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="968">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="969">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterialWoodShakes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="970">
          
          
          <code class="ruby">    return &#39;wood shakes&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="971">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="972">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="973">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofStructureRafter</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="974">
          
          
          <code class="ruby">    return &#39;rafter&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="975">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="976">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="977">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofStructureTrussCantilever</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="978">
          
          
          <code class="ruby">    return &#39;truss, cantilever&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="979">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="980">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="981">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofTypeFlat</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="982">
          
          
          <code class="ruby">    return &#39;flat&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="983">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="984">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="985">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofTypeGable</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="986">
          
          
          <code class="ruby">    return &#39;gable&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="987">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="988">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="989">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofTypeHip</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="990">
          
          
          <code class="ruby">    return &#39;hip&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="991">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="992">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="993">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ScheduleTypeLimitsFraction</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="994">
          <span class="hits">62</span>
          
          <code class="ruby">    return &#39;Fractional&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="995">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="996">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="997">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ScheduleTypeLimitsOnOff</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="998">
          
          
          <code class="ruby">    return &#39;OnOff&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="999">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1000">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1001">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ScheduleTypeLimitsTemperature</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="1002">
          <span class="hits">55</span>
          
          <code class="ruby">    return &#39;Temperature&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1003">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1004">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1005">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SeasonHeating</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1006">
          
          
          <code class="ruby">    return &#39;Heating&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1007">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1008">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1009">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SeasonCooling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1010">
          
          
          <code class="ruby">    return &#39;Cooling&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1011">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1012">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1013">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SeasonOverlap</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1014">
          
          
          <code class="ruby">    return &#39;Overlap&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1015">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1016">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1017">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SeasonNone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1018">
          
          
          <code class="ruby">    return &#39;None&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1019">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1020">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1021">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingAuto</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1022">
          
          
          <code class="ruby">    return &#39;autosize&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1023">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1024">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1025">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingAutoMaxLoad</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1026">
          
          
          <code class="ruby">    return &#39;autosize for max load&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1027">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1028">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1029">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoCMUWallFurringInsRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1030">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1031">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1032">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1033">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsLocationFrac</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1034">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1035">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1036">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1037">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsLocationZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1038">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1039">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1040">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1041">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsReturnLoss</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1042">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1043">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1044">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1045">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsReturnRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1046">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1047">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1048">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1049">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsReturnSurfaceArea</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1050">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1051">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1052">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1053">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsSupplyLoss</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1054">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1055">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1056">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1057">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsSupplyRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1058">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1059">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1060">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1061">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoDuctsSupplySurfaceArea</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1062">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1063">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1064">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1065">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACFracHeatLoadServed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1066">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1067">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1068">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1069">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACFracCoolLoadServed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1070">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1071">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1072">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1073">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPBoreConfig</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1074">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1075">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1076">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1077">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPBoreDepth</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1078">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1079">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1080">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1081">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPBoreHoles</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1082">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1083">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1084">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1085">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPBoreSpacing</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1086">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1087">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1088">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1089">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPCoil_BF_FT_SPEC</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1090">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1091">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1092">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1093">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPCoilBF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1094">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1095">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1096">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1097">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoGSHPUTubeSpacingType</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1098">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1099">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1101">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHPSizedForMaxLoad</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1102">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1105">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACCapacityDerateFactorCOP</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1106">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1109">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACCapacityDerateFactorEER</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1110">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1113">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACCapacityRatioCooling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1114">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1115">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1117">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACCapacityRatioHeating</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1118">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1121">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACCoolingCFMs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1122">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1123">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1125">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACHeatingCapacityOffset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1126">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1127">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1129">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACHeatingCFMs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1130">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1133">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACRatedCFMperTonHeating</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1134">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1135">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1137">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACRatedCFMperTonCooling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1138">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1139">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1141">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoHVACSHR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1142">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1143">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1145">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoMechVentType</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1146">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1147">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1149">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoMechVentApparentSensibleEffectiveness</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1150">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1151">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1153">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoMechVentLatentEffectiveness</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1154">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1155">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1157">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoMechVentTotalEfficiency</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1158">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1159">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1160">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1161">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoMechVentWholeHouseRate</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1162">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1163">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1165">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoRoofCavityRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1166">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1167">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1169">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoRoofColor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1170">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1171">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1173">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoRoofHasRadiantBarrier</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1174">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1177">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoRoofMaterial</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1178">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1179">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1181">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoRoofRigidInsRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1182">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1183">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1185">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoSIPWallInsThickness</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1186">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1189">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoSlabRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1190">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1191">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1193">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoStudWallCavityRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1194">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1195">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1197">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoWallType</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1198">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1199">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1201">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoWallRigidInsRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1202">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1203">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1205">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoWallRigidInsThickness</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1206">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1207">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1209">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoWindowHasOverhang</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1210">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1211">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1213">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoWindowOverhangDepth</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1214">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1215">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1217">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoWindowOverhangOffset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1218">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1219">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1221">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoZoneInfiltrationCFM</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1222">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1223">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1225">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SizingInfoZoneInfiltrationELA</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1226">
          
          
          <code class="ruby">    return __method__.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1227">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1228">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1229">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeBathroom</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="1230">
          <span class="hits">12</span>
          
          <code class="ruby">    return &#39;bathroom&#39; # only used by multi-zone simulations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1231">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1233">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeBedroom</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1234">
          
          
          <code class="ruby">    return &#39;bedroom&#39; # only used by multi-zone simulations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1235">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1237">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeCorridor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1238">
          
          
          <code class="ruby">    return &#39;corridor&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1239">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1241">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeCrawl</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1242">
          
          
          <code class="ruby">    return &#39;crawlspace&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1243">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1245">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeFinishedBasement</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="1246">
          <span class="hits">12</span>
          
          <code class="ruby">    return &#39;finished basement&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1247">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1248">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1249">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeGarage</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1250">
          
          
          <code class="ruby">    return &#39;garage&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1251">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1253">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeGarageAttic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1254">
          
          
          <code class="ruby">    return &#39;garage attic&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1255">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1257">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeKitchen</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1258">
          
          
          <code class="ruby">    return &#39;kitchen&#39; # only used by multi-zone simulations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1259">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1261">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeLaundryRoom</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1262">
          
          
          <code class="ruby">    return &#39;laundry room&#39; # only used by multi-zone simulations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1263">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1264">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1265">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeLiving</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="1266">
          <span class="hits">12</span>
          
          <code class="ruby">    return &#39;living&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1267">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1268">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1269">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypePierBeam</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1270">
          
          
          <code class="ruby">    return &#39;pier and beam&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1271">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1273">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeUnfinishedAttic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1274">
          
          
          <code class="ruby">    return &#39;unfinished attic&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1275">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1276">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1277">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeUnfinishedBasement</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1278">
          
          
          <code class="ruby">    return &#39;unfinished basement&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1279">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1281">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeOffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1282">
          
          
          <code class="ruby">    return &#39;SmallOffice,WholeBuilding - Sm Office&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1283">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1285">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SpaceTypeRetail</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1286">
          
          
          <code class="ruby">    return &#39;StripMall,Strip mall - type 3&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1287">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1289">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeAdiabatic # adiabatic construction instead of adiabatic outside boundary condition</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1290">
          
          
          <code class="ruby">    return &#39;Adiabatic&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1291">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1293">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFinInsUnfinAttic # unfinished attic floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1294">
          
          
          <code class="ruby">    return &#39;FloorFinInsUnfinAttic&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1295">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1297">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFinInsUnfin # interzonal or cantilevered floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1298">
          
          
          <code class="ruby">    return &#39;FloorFinInsUnfin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1299">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1301">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFinUninsFin # floor between 1st/2nd story living spaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1302">
          
          
          <code class="ruby">    return &#39;FloorFinUninsFin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1303">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1305">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorUnfinUninsUnfin # floor between garage and attic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1306">
          
          
          <code class="ruby">    return &#39;FloorUnfinUninsUnfin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1307">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1309">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFndGrndFinB # finished basement floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1310">
          
          
          <code class="ruby">    return &#39;FloorFndGrndFinB&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1311">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1313">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFndGrndUnfinB # unfinished basement floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1314">
          
          
          <code class="ruby">    return &#39;FloorFndGrndUnfinB&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1315">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1316">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1317">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFndGrndFinSlab # finished slab</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1318">
          
          
          <code class="ruby">    return &#39;FloorFndGrndFinSlab&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1319">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1320">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1321">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFndGrndUnfinSlab # garage slab</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1322">
          
          
          <code class="ruby">    return &#39;FloorFndGrndUnfinSlab&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1323">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1325">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorUnfinBInsFin # unfinished basement ceiling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1326">
          
          
          <code class="ruby">    return &#39;FloorUnfinBInsFin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1327">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1329">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorCSInsFin # crawlspace ceiling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1330">
          
          
          <code class="ruby">    return &#39;FloorCSInsFin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1331">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1333">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorPBInsFin # pier beam ceiling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1334">
          
          
          <code class="ruby">    return &#39;FloorPBInsFin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1335">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1337">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeFloorFndGrndCS # crawlspace floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1338">
          
          
          <code class="ruby">    return &#39;FloorFndGrndCS&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1339">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1340">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1341">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeRoofUnfinUninsExt # garage roof</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1342">
          
          
          <code class="ruby">    return &#39;RoofUnfinUninsExt&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1343">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1344">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1345">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeRoofUnfinInsExt # unfinished attic roof</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1346">
          
          
          <code class="ruby">    return &#39;RoofUnfinInsExt&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1349">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeRoofFinInsExt # finished attic roof</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1350">
          
          
          <code class="ruby">    return &#39;RoofFinInsExt&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1351">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1353">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallExtInsFin # living exterior wall</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1354">
          
          
          <code class="ruby">    return &#39;WallExtInsFin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1355">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1356">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1357">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallExtInsUnfin # attic gable wall under insulated roof</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1358">
          
          
          <code class="ruby">    return &#39;WallExtInsUnfin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1359">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1360">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1361">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallExtUninsUnfin # garage exterior wall or attic gable wall under uninsulated roof</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1362">
          
          
          <code class="ruby">    return &#39;WallExtUninsUnfin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1363">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1365">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallFndGrndFinB # finished basement wall</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1366">
          
          
          <code class="ruby">    return &#39;WallFndGrndFinB&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1367">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1368">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1369">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallFndGrndUnfinB # unfinished basement wall</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1370">
          
          
          <code class="ruby">    return &#39;WallFndGrndUnfinB&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1371">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1373">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallFndGrndCS # crawlspace wall</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1374">
          
          
          <code class="ruby">    return &#39;WallFndGrndCS&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1375">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1376">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1377">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallIntFinInsUnfin # interzonal wall</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1378">
          
          
          <code class="ruby">    return &#39;WallIntFinInsUnfin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1379">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1381">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallIntFinUninsFin # wall between two finished spaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1382">
          
          
          <code class="ruby">    return &#39;WallIntFinUninsFin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1383">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1384">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1385">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SurfaceTypeWallIntUnfinUninsUnfin # wall between two unfinished spaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1386">
          
          
          <code class="ruby">    return &#39;WallIntUnfinUninsUnfin&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1387">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1388">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1389">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TerrainOcean</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1390">
          
          
          <code class="ruby">    return &#39;ocean&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1391">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1392">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1393">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TerrainPlains</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1394">
          
          
          <code class="ruby">    return &#39;plains&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1395">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1396">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1397">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TerrainRural</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1398">
          
          
          <code class="ruby">    return &#39;rural&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1399">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1400">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1401">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TerrainSuburban</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1402">
          
          
          <code class="ruby">    return &#39;suburban&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1403">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1404">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1405">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TerrainCity</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1406">
          
          
          <code class="ruby">    return &#39;city&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1407">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1408">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1409">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TiltPitch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1410">
          
          
          <code class="ruby">    return &#39;pitch&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1411">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1413">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.TiltLatitude</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1414">
          
          
          <code class="ruby">    return &#39;latitude&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1415">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1416">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1417">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.VentTypeExhaust</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1418">
          
          
          <code class="ruby">    return &#39;exhaust&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1419">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1420">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1421">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.VentTypeNone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1422">
          
          
          <code class="ruby">    return &#39;none&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1423">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1424">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1425">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.VentTypeSupply</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1426">
          
          
          <code class="ruby">    return &#39;supply&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1427">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1428">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1429">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.VentTypeBalanced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1430">
          
          
          <code class="ruby">    return &#39;balanced&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1431">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1433">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.VentTypeCFIS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1434">
          
          
          <code class="ruby">    return &#39;central fan integrated supply&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1435">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1436">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1437">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1438">
          
          
          <code class="ruby">    return &#39;tankless&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1439">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1440">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1441">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.WaterHeaterTypeTank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1442">
          
          
          <code class="ruby">    return &#39;tank&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1443">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1444">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1445">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.WaterHeaterTypeHeatPump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1446">
          
          
          <code class="ruby">    return &#39;heatpump&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1447">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1448">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1449">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.WorkflowDescription</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="1450">
          <span class="hits">11</span>
          
          <code class="ruby">    return &#39; See https://github.com/NREL/OpenStudio-BuildStock#workflows for supported workflows using this measure.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1451">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1452">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1453">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExpectedSpaceTypes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1454">
          
          
          <code class="ruby">    return [self.SpaceTypeBathroom,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1455">
          
          
          <code class="ruby">            self.SpaceTypeBedroom,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1456">
          
          
          <code class="ruby">            self.SpaceTypeCorridor,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1457">
          
          
          <code class="ruby">            self.SpaceTypeCrawl,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1458">
          
          
          <code class="ruby">            self.SpaceTypeFinishedBasement,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1459">
          
          
          <code class="ruby">            self.SpaceTypeGarage,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1460">
          
          
          <code class="ruby">            self.SpaceTypeKitchen,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1461">
          
          
          <code class="ruby">            self.SpaceTypeLaundryRoom,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1462">
          
          
          <code class="ruby">            self.SpaceTypeLiving,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1463">
          
          
          <code class="ruby">            self.SpaceTypePierBeam,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1464">
          
          
          <code class="ruby">            self.SpaceTypeUnfinishedAttic,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1465">
          
          
          <code class="ruby">            self.SpaceTypeUnfinishedBasement]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1466">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1467">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1468">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ZoneHVACPriorityList</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1469">
          
          
          <code class="ruby">    return [&quot;ZoneHVACEnergyRecoveryVentilator&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1470">
          
          
          <code class="ruby">            &quot;AirLoopHVACUnitarySystem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1471">
          
          
          <code class="ruby">            &quot;ZoneHVACBaseboardConvectiveElectric&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1472">
          
          
          <code class="ruby">            &quot;ZoneHVACBaseboardConvectiveWater&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1473">
          
          
          <code class="ruby">            &quot;AirTerminalSingleDuctUncontrolled&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1474">
          
          
          <code class="ruby">            &quot;ZoneHVACDehumidifierDX&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1475">
          
          
          <code class="ruby">            &quot;ZoneHVACPackagedTerminalAirConditioner&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1476">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1477">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ab6c9d48711bcc527f75f63ab958a843bacca2c4">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/geometry.rb</h3>
    <h4><span class="red">12.7 %</span> covered</h4>
    <div>
      <b>1220</b> relevant lines. 
      <span class="green"><b>155</b> lines covered</span> and
      <span class="red"><b>1065</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;constants&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;util&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class Geometry</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.has_rear_units(model, runner, units)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    units.each do |unit|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">        facades = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">        space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">          next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">          next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">          facade = Geometry.get_facade_for_surface(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">          unless facades.include? facade</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">            facades &lt;&lt; facade</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">        next if facades.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">        if facades.include? Constants.FacadeFront and facades.include? Constants.FacadeBack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        elsif facades.include? Constants.FacadeLeft and facades.include? Constants.FacadeRight</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">          return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_abs_azimuth(azimuth_type, relative_azimuth, building_orientation, offset = 180.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    azimuth = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    if azimuth_type == Constants.CoordRelative</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      azimuth = relative_azimuth + building_orientation + offset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    elsif azimuth_type == Constants.CoordAbsolute</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      azimuth = relative_azimuth + offset</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    # Ensure azimuth is &gt;=0 and &lt;=360</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    while azimuth &lt; 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      azimuth += 360.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    while azimuth &gt;= 360.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      azimuth -= 360.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    return azimuth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_abs_tilt(tilt_type, relative_tilt, roof_tilt, latitude)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    if tilt_type == Constants.TiltPitch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      return relative_tilt + roof_tilt</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    elsif tilt_type == Constants.TiltLatitude</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      return relative_tilt + latitude</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    elsif tilt_type == Constants.CoordAbsolute</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      return relative_tilt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.initialize_transformation_matrix(m)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    m[0, 0] = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    m[1, 1] = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    m[2, 2] = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    m[3, 3] = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    return m</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_surface_dimensions(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    least_x = 9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    greatest_x = -9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    least_y = 9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    greatest_y = -9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    least_z = 9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    greatest_z = -9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      least_x = [vertex.x, least_x].min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      greatest_x = [vertex.x, greatest_x].max</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      least_y = [vertex.y, least_y].min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      greatest_y = [vertex.y, greatest_y].max</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      least_z = [vertex.z, least_z].min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      greatest_z = [vertex.z, greatest_z].max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    l = greatest_x - least_x</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    w = greatest_y - least_y</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    h = greatest_z - least_z</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    return l, w, h</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_building_stories(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    space_min_zs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      next if not self.space_is_finished(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      surfaces_min_zs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">        zvalues = self.getSurfaceZValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">        surfaces_min_zs &lt;&lt; zvalues.min + UnitConversions.convert(space.zOrigin, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      space_min_zs &lt;&lt; surfaces_min_zs.min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    return space_min_zs.uniq.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_above_grade_building_stories(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">    space_min_zs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">      next if not self.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      next if not self.space_is_above_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">      surfaces_min_zs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">        zvalues = self.getSurfaceZValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">        surfaces_min_zs &lt;&lt; zvalues.min + UnitConversions.convert(space.zOrigin, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      space_min_zs &lt;&lt; surfaces_min_zs.min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">    return space_min_zs.uniq.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.make_one_space_from_multiple_spaces(model, spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    new_space = OpenStudio::Model::Space.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">        if surface.adjacentSurface.is_initialized and surface.surfaceType.downcase == &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">          surface.adjacentSurface.get.remove</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">          surface.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">          surface.setSpace(new_space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">      if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">        space.buildingUnit.get.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">      space.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">    return new_space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.make_polygon(*pts)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    p = OpenStudio::Point3dVector.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">    pts.each do |pt|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      p &lt;&lt; pt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    return p</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_building_units(model, runner = nil)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="149">
          <span class="hits">13</span>
          
          <code class="ruby">    if model.getSpaces.size == 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">      if !runner.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">        runner.registerError(&quot;No building geometry has been defined.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="156">
          <span class="hits">12</span>
          
          <code class="ruby">    return_units = []</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="157">
          <span class="hits">12</span>
          
          <code class="ruby">    model.getBuildingUnits.each do |unit|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">      # Remove any units from list that have no associated spaces or are not residential</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="159">
          <span class="hits">22</span>
          
          <code class="ruby">      next if not (unit.spaces.size &gt; 0 and unit.buildingUnitType == Constants.BuildingUnitTypeResidential)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="161">
          <span class="hits">22</span>
          
          <code class="ruby">      return_units &lt;&lt; unit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="164">
          <span class="hits">12</span>
          
          <code class="ruby">    if return_units.size == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">      # Assume SFD; create single building unit for entire model</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">      if !runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">        runner.registerWarning(&quot;No building units defined; assuming single-family detached building.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">      unit = OpenStudio::Model::BuildingUnit.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">      unit.setBuildingUnitType(Constants.BuildingUnitTypeResidential)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      unit.setName(Constants.ObjectNameBuildingUnit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">      model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">        space.setBuildingUnit(unit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">      model.getBuildingUnits.each do |unit|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">        return_units &lt;&lt; unit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    # Sort the building units</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="181">
          <span class="hits">12</span>
          
          <code class="ruby">    unit_numbers = {}</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="182">
          <span class="hits">12</span>
          
          <code class="ruby">    return_units.each do |unit|</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="183">
          <span class="hits">22</span>
          
          <code class="ruby">      unit_number = Float(unit.name.to_s.split(&quot; &quot;)[-1])</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="184">
          <span class="hits">22</span>
          
          <code class="ruby">      unit_numbers[unit] = unit_number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="187">
          <span class="hits">34</span>
          
          <code class="ruby">    unit_numbers = unit_numbers.sort_by { |k, v| v }</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="188">
          <span class="hits">12</span>
          
          <code class="ruby">    return_units = []</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="189">
          <span class="hits">12</span>
          
          <code class="ruby">    unit_numbers.each do |unit, number|</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="190">
          <span class="hits">22</span>
          
          <code class="ruby">      return_units &lt;&lt; unit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="193">
          <span class="hits">12</span>
          
          <code class="ruby">    return return_units</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_unit_beds_baths(model, unit, runner = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">    # Returns a list with #beds, #baths, a list of spaces, and the unit name</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="198">
          <span class="hits">22</span>
          
          <code class="ruby">    nbeds = unit.additionalProperties.getFeatureAsInteger(Constants.BuildingUnitFeatureNumBedrooms)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="199">
          <span class="hits">22</span>
          
          <code class="ruby">    nbaths = unit.additionalProperties.getFeatureAsDouble(Constants.BuildingUnitFeatureNumBathrooms)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="200">
          <span class="hits">22</span>
          
          <code class="ruby">    if not (nbeds.is_initialized or nbaths.is_initialized)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">      if !runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">        runner.registerError(&quot;Could not determine number of bedrooms or bathrooms.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">      return [nil, nil]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="206">
          <span class="hits">22</span>
          
          <code class="ruby">      nbeds = nbeds.get.to_f</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="207">
          <span class="hits">22</span>
          
          <code class="ruby">      nbaths = nbaths.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="209">
          <span class="hits">22</span>
          
          <code class="ruby">    return [nbeds, nbaths]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_unit_adjacent_common_spaces(unit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">    # Returns a list of spaces adjacent to the unit that are not assigned</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">    # to a building unit.</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="215">
          <span class="hits">22</span>
          
          <code class="ruby">    spaces = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="217">
          <span class="hits">22</span>
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="218">
          <span class="hits">46</span>
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="covered" data-hits="356" data-linenumber="219">
          <span class="hits">356</span>
          
          <code class="ruby">        next if not surface.adjacentSurface.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="126" data-linenumber="221">
          <span class="hits">126</span>
          
          <code class="ruby">        adjacent_surface = surface.adjacentSurface.get</code>
        </li>
      
        <li class="covered" data-hits="126" data-linenumber="222">
          <span class="hits">126</span>
          
          <code class="ruby">        next if not adjacent_surface.space.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="126" data-linenumber="224">
          <span class="hits">126</span>
          
          <code class="ruby">        adjacent_space = adjacent_surface.space.get</code>
        </li>
      
        <li class="covered" data-hits="126" data-linenumber="225">
          <span class="hits">126</span>
          
          <code class="ruby">        next if adjacent_space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="227">
          <span class="hits">54</span>
          
          <code class="ruby">        spaces &lt;&lt; adjacent_space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="231">
          <span class="hits">22</span>
          
          <code class="ruby">    return spaces.uniq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_common_spaces(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">    spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="237">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">      spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">    return spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="244">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_floor_area_from_spaces(spaces, runner = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">    floor_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      floor_area += UnitConversions.convert(space.floorArea, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">    if floor_area == 0 and not runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">      runner.registerError(&quot;Could not find any floor area.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">    return floor_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_zone_volume(zone, runner = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">    if zone.isVolumeAutocalculated or not zone.volume.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">      # Calculate volume from spaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">      volume = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">      zone.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">        volume += UnitConversions.convert(space.volume, &quot;m^3&quot;, &quot;ft^3&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">      volume = UnitConversions.convert(zone.volume.get, &quot;m^3&quot;, &quot;ft^3&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    if volume &lt;= 0 and not runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">      runner.registerError(&quot;Could not find any volume.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">    return volume</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="273">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_finished_floor_area_from_spaces(spaces, runner = nil, apply_mult = false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">    floor_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">      next if not self.space_is_finished(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">      mult = 1.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">      if apply_mult</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">        mult = space.multiplier.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">      floor_area += UnitConversions.convert(space.floorArea * mult, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">    if floor_area == 0 and not runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">      runner.registerError(&quot;Could not find any finished floor area.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">    return floor_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="291">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_above_grade_finished_floor_area_from_spaces(spaces, runner = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="292">
          
          
          <code class="ruby">    floor_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">      next if not (self.space_is_finished(space) and self.space_is_above_grade(space))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">      floor_area += UnitConversions.convert(space.floorArea, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">    if floor_area == 0 and not runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">      runner.registerError(&quot;Could not find any above-grade finished floor area.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="302">
          
          
          <code class="ruby">    return floor_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="305">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_above_grade_finished_volume(model, runner = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">    volume = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">    model.getThermalZones.each do |zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">      next if not (self.zone_is_finished(zone) and self.zone_is_above_grade(zone))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">      volume += self.get_zone_volume(zone, runner)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">    if volume == 0 and not runner.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">      runner.registerError(&quot;Could not find any above-grade finished volume.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">    return volume</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="319">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_window_area_from_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">    window_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">        surface.subSurfaces.each do |subsurface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">          next if subsurface.subSurfaceType.downcase != &quot;fixedwindow&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">          window_area += UnitConversions.convert(subsurface.grossArea, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">    return window_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="333">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_height(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">    return Geometry.get_height_of_spaces([space])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">  # Calculates space heights as the max z coordinate minus the min z coordinate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="338">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_height_of_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">    minzs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">    maxzs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">      zvalues = self.getSurfaceZValues(space.surfaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">      minzs &lt;&lt; zvalues.min + UnitConversions.convert(space.zOrigin, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">      maxzs &lt;&lt; zvalues.max + UnitConversions.convert(space.zOrigin, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    return maxzs.max - minzs.min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">  # Calculates the surface height as the max z coordinate minus the min z coordinate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="350">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.surface_height(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">    zvalues = self.getSurfaceZValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">    minz = zvalues.min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    maxz = zvalues.max</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">    return maxz - minz</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="357">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.zone_is_finished(zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">    zone.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">      unless self.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">  # Returns true if all spaces in zone are fully above grade</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="366">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.zone_is_above_grade(zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">    spaces_are_above_grade = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">    zone.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">      spaces_are_above_grade &lt;&lt; self.space_is_above_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="371">
          
          
          <code class="ruby">    if spaces_are_above_grade.all?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="372">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby">  # Returns true if all spaces in zone are either fully or partially below grade</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="379">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.zone_is_below_grade(zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">    return !self.zone_is_above_grade(zone)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="383">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_finished_above_and_below_grade_zones(thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">    finished_living_zones = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">    finished_basement_zones = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">      next unless self.zone_is_finished(thermal_zone)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="388">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">      if self.zone_is_above_grade(thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="390">
          
          
          <code class="ruby">        finished_living_zones &lt;&lt; thermal_zone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="391">
          
          
          <code class="ruby">      elsif self.zone_is_below_grade(thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">        finished_basement_zones &lt;&lt; thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="395">
          
          
          <code class="ruby">    return finished_living_zones, finished_basement_zones</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="398">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_thermal_zones_from_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">    thermal_zones = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">      next unless space.thermalZone.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">      unless thermal_zones.include? space.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">        thermal_zones &lt;&lt; space.thermalZone.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="407">
          
          
          <code class="ruby">    return thermal_zones</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="410">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_building_type(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="411">
          
          
          <code class="ruby">    building_type = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="412">
          
          
          <code class="ruby">    unless model.getBuilding.standardsBuildingType.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">      building_type = model.getBuilding.standardsBuildingType.get.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="415">
          
          
          <code class="ruby">    return building_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="418">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_is_unfinished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">    return !self.space_is_finished(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="422">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="423">
          
          
          <code class="ruby">    unless space.isPlenum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">      if space.spaceType.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">        if space.spaceType.get.standardsSpaceType.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">          return self.is_living_space_type(space.spaceType.get.standardsSpaceType.get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="433">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_living_space_type(space_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="434">
          
          
          <code class="ruby">    if [Constants.SpaceTypeLiving, Constants.SpaceTypeFinishedBasement, Constants.SpaceTypeKitchen,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="435">
          
          
          <code class="ruby">        Constants.SpaceTypeBedroom, Constants.SpaceTypeBathroom, Constants.SpaceTypeLaundryRoom].include? space_type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="439">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">  # Returns true if space is fully above grade</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="443">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_is_above_grade(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="444">
          
          
          <code class="ruby">    return !self.space_is_below_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby">  # Returns true if space is either fully or partially below grade</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="448">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_is_below_grade(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">      next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">      if surface.outsideBoundaryCondition.downcase == &quot;foundation&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">        return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="454">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="458">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_has_roof(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="459">
          
          
          <code class="ruby">    space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">      next if surface.surfaceType.downcase != &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">      next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">      next if surface.tilt == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="466">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="469">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_below_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">    space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="471">
          
          
          <code class="ruby">      next if surface.surfaceType.downcase != &quot;floor&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="472">
          
          
          <code class="ruby">      next if not surface.adjacentSurface.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="473">
          
          
          <code class="ruby">      next if not surface.adjacentSurface.get.space.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">      adjacent_space = surface.adjacentSurface.get.space.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="476">
          
          
          <code class="ruby">      next if not self.space_is_finished(adjacent_space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="478">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="483">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_model_locations(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="484">
          
          
          <code class="ruby">    locations = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="485">
          
          
          <code class="ruby">    model.getSpaceTypes.each do |spaceType|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">      next if not spaceType.standardsSpaceType.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="488">
          
          
          <code class="ruby">      locations &lt;&lt; spaceType.standardsSpaceType.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="489">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="490">
          
          
          <code class="ruby">    return locations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="493">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_space_from_location(unit, location, location_hierarchy)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="494">
          <span class="hits">22</span>
          
          <code class="ruby">    spaces = unit.spaces + self.get_unit_adjacent_common_spaces(unit)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="495">
          <span class="hits">22</span>
          
          <code class="ruby">    if location == Constants.Auto</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="496">
          <span class="hits">22</span>
          
          <code class="ruby">      location_hierarchy.each do |space_type|</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="497">
          <span class="hits">44</span>
          
          <code class="ruby">        spaces.each do |space|</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="498">
          <span class="hits">96</span>
          
          <code class="ruby">          next if not self.space_is_of_type(space, space_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="500">
          <span class="hits">22</span>
          
          <code class="ruby">          return space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="504">
          
          
          <code class="ruby">      spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">        next if not space.spaceType.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="506">
          
          
          <code class="ruby">        next if not space.spaceType.get.standardsSpaceType.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="507">
          
          
          <code class="ruby">        next if space.spaceType.get.standardsSpaceType.get != location</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="509">
          
          
          <code class="ruby">        return space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="510">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="511">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby">  # Return an array of x values for surfaces passed in. The values will be relative to the parent origin. This was intended for spaces.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="516">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.getSurfaceXValues(surfaceArray)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">    xValueArray = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="518">
          
          
          <code class="ruby">    surfaceArray.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="519">
          
          
          <code class="ruby">      surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="520">
          
          
          <code class="ruby">        xValueArray &lt;&lt; UnitConversions.convert(vertex.x, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="521">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="523">
          
          
          <code class="ruby">    return xValueArray</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="525">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby">  # Return an array of y values for surfaces passed in. The values will be relative to the parent origin. This was intended for spaces.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="527">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.getSurfaceYValues(surfaceArray)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="528">
          
          
          <code class="ruby">    yValueArray = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">    surfaceArray.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="530">
          
          
          <code class="ruby">      surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="531">
          
          
          <code class="ruby">        yValueArray &lt;&lt; UnitConversions.convert(vertex.y, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="532">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="534">
          
          
          <code class="ruby">    return yValueArray</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby">  # Return an array of z values for surfaces passed in. The values will be relative to the parent origin. This was intended for spaces.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="538">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.getSurfaceZValues(surfaceArray)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="539">
          
          
          <code class="ruby">    zValueArray = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="540">
          
          
          <code class="ruby">    surfaceArray.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="541">
          
          
          <code class="ruby">      surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">        zValueArray &lt;&lt; UnitConversions.convert(vertex.z, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    return zValueArray</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="548">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_space_floor_z(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="549">
          
          
          <code class="ruby">    space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="550">
          
          
          <code class="ruby">      next unless surface.surfaceType.downcase == &quot;floor&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="552">
          
          
          <code class="ruby">      return self.getSurfaceZValues([surface])[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="556">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_z_origin_for_zone(zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="557">
          
          
          <code class="ruby">    z_origins = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="558">
          
          
          <code class="ruby">    zone.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="559">
          
          
          <code class="ruby">      z_origins &lt;&lt; UnitConversions.convert(space.zOrigin, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="561">
          
          
          <code class="ruby">    return z_origins.min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby">  # Takes in a list of spaces and returns the average space height</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="565">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.spaces_avg_height(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="566">
          
          
          <code class="ruby">    return nil if spaces.size == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="567">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="568">
          
          
          <code class="ruby">    sum_height = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">      sum_height += self.space_height(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">    return sum_height / spaces.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">  # Takes in a list of surfaces and returns the total gross area</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="576">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calculate_total_area_from_surfaces(surfaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="577">
          
          
          <code class="ruby">    total_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">    surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="579">
          
          
          <code class="ruby">      total_area += UnitConversions.convert(surface.grossArea, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="581">
          
          
          <code class="ruby">    return total_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="584">
          
          
          <code class="ruby">  # Takes in a list of spaces and returns the total above grade wall area</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="585">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calculate_above_grade_wall_area(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">    wall_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="587">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="588">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="589">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="590">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase == &quot;foundation&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="592">
          
          
          <code class="ruby">        wall_area += UnitConversions.convert(surface.grossArea, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="595">
          
          
          <code class="ruby">    return wall_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="597">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="598">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calculate_above_grade_exterior_wall_area(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">    wall_area = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="600">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="601">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="602">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="603">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="604">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase == &quot;foundation&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="605">
          
          
          <code class="ruby">        next unless self.space_is_finished(surface.space.get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="607">
          
          
          <code class="ruby">        wall_area += UnitConversions.convert(surface.grossArea, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="608">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="609">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="610">
          
          
          <code class="ruby">    return wall_area</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="612">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="613">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_roof_pitch(surfaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="614">
          
          
          <code class="ruby">    tilts = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="615">
          
          
          <code class="ruby">    surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">      next if surface.surfaceType.downcase != &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="617">
          
          
          <code class="ruby">      next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot; and surface.outsideBoundaryCondition.downcase != &quot;adiabatic&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="618">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="619">
          
          
          <code class="ruby">      tilts &lt;&lt; surface.tilt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="620">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="621">
          
          
          <code class="ruby">    return UnitConversions.convert(tilts.max, &quot;rad&quot;, &quot;deg&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="623">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="624">
          
          
          <code class="ruby">  # Checks if the surface is between finished space and outside</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="625">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_exterior_surface(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="626">
          
          
          <code class="ruby">    if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot; or not surface.space.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="627">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="629">
          
          
          <code class="ruby">    if not self.space_is_finished(surface.space.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="630">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="633">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="636">
          
          
          <code class="ruby">  # Checks if the surface is between finished and unfinished space</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="637">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_interzonal_surface(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="638">
          
          
          <code class="ruby">    if surface.outsideBoundaryCondition.downcase != &quot;surface&quot; or not surface.space.is_initialized or not surface.adjacentSurface.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="639">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="640">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="642">
          
          
          <code class="ruby">    adjacent_surface = surface.adjacentSurface.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="643">
          
          
          <code class="ruby">    if not adjacent_surface.space.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="644">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">    if self.space_is_finished(surface.space.get) == self.space_is_finished(adjacent_surface.space.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="647">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="650">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="651">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="652">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="653">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_pier_beam_surface(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="654">
          
          
          <code class="ruby">    if not surface.space.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="655">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="657">
          
          
          <code class="ruby">    if not Geometry.is_pier_beam(surface.space.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="658">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="659">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="660">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="661">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="662">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="663">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="664">
          
          
          <code class="ruby">  # Takes in a list of floor surfaces for which to calculate the exposed perimeter.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="665">
          
          
          <code class="ruby">  # Returns the total exposed perimeter.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="666">
          
          
          <code class="ruby">  # NOTE: Does not work for buildings with non-orthogonal walls.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="667">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calculate_exposed_perimeter(model, ground_floor_surfaces, has_foundation_walls = false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="668">
          
          
          <code class="ruby">    perimeter = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="670">
          
          
          <code class="ruby">    # Get ground edges</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="671">
          
          
          <code class="ruby">    if not has_foundation_walls</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="672">
          
          
          <code class="ruby">      # Use edges from floor surface</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="673">
          
          
          <code class="ruby">      ground_edges = self.get_edges_for_surfaces(ground_floor_surfaces, false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="675">
          
          
          <code class="ruby">      # Use top edges from foundation walls instead</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="676">
          
          
          <code class="ruby">      surfaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">      ground_floor_surfaces.each do |ground_floor_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">        next if not ground_floor_surface.space.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="679">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="680">
          
          
          <code class="ruby">        foundation_space = ground_floor_surface.space.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="681">
          
          
          <code class="ruby">        wall_surfaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="682">
          
          
          <code class="ruby">        foundation_space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="683">
          
          
          <code class="ruby">          next if not surface.surfaceType.downcase == &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="684">
          
          
          <code class="ruby">          next if surface.adjacentSurface.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="686">
          
          
          <code class="ruby">          wall_surfaces &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="688">
          
          
          <code class="ruby">        self.get_walls_connected_to_floor(wall_surfaces, ground_floor_surface).each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="689">
          
          
          <code class="ruby">          next if surfaces.include? surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="691">
          
          
          <code class="ruby">          surfaces &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="692">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="693">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="694">
          
          
          <code class="ruby">      ground_edges = self.get_edges_for_surfaces(surfaces, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="695">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="696">
          
          
          <code class="ruby">    # Get bottom edges of exterior walls (building footprint)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="697">
          
          
          <code class="ruby">    surfaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="698">
          
          
          <code class="ruby">    model.getSurfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="699">
          
          
          <code class="ruby">      next if not surface.surfaceType.downcase == &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="700">
          
          
          <code class="ruby">      next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="701">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="702">
          
          
          <code class="ruby">      surfaces &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="703">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="704">
          
          
          <code class="ruby">    model_edges = self.get_edges_for_surfaces(surfaces, false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="705">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="706">
          
          
          <code class="ruby">    # compare edges for overlap</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="707">
          
          
          <code class="ruby">    ground_edges.each do |e1|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="708">
          
          
          <code class="ruby">      model_edges.each do |e2|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="709">
          
          
          <code class="ruby">        next if not self.is_point_between(e2[0], e1[0], e1[1])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="710">
          
          
          <code class="ruby">        next if not self.is_point_between(e2[1], e1[0], e1[1])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="711">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="712">
          
          
          <code class="ruby">        point_one = OpenStudio::Point3d.new(e2[0][0], e2[0][1], e2[0][2])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="713">
          
          
          <code class="ruby">        point_two = OpenStudio::Point3d.new(e2[1][0], e2[1][1], e2[1][2])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="714">
          
          
          <code class="ruby">        length = OpenStudio::Vector3d.new(point_one - point_two).length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">        perimeter += length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="717">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="719">
          
          
          <code class="ruby">    return UnitConversions.convert(perimeter, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="721">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="722">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_point_between(p, v1, v2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="723">
          
          
          <code class="ruby">    # Checks if point p is between points v1 and v2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">    is_between = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="725">
          
          
          <code class="ruby">    tol = 0.001</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">    if (p[2] - v1[2]).abs &lt;= tol and (p[2] - v2[2]).abs &lt;= tol # equal z</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="727">
          
          
          <code class="ruby">      if (p[0] - v1[0]).abs &lt;= tol and (p[0] - v2[0]).abs &lt;= tol # equal x; vertical</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="728">
          
          
          <code class="ruby">        if p[1] &gt;= v1[1] - tol and p[1] &lt;= v2[1] + tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="729">
          
          
          <code class="ruby">          is_between = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="730">
          
          
          <code class="ruby">        elsif p[1] &lt;= v1[1] + tol and p[1] &gt;= v2[1] - tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="731">
          
          
          <code class="ruby">          is_between = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="732">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="733">
          
          
          <code class="ruby">      elsif (p[1] - v1[1]).abs &lt;= tol and (p[1] - v2[1]).abs &lt;= tol # equal y; horizontal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="734">
          
          
          <code class="ruby">        if p[0] &gt;= v1[0] - tol and p[0] &lt;= v2[0] + tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="735">
          
          
          <code class="ruby">          is_between = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="736">
          
          
          <code class="ruby">        elsif p[0] &lt;= v1[0] + tol and p[0] &gt;= v2[0] - tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="737">
          
          
          <code class="ruby">          is_between = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="738">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="739">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="740">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="741">
          
          
          <code class="ruby">    return is_between</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="743">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="744">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_edges_for_surfaces(surfaces, use_top_edge)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="745">
          
          
          <code class="ruby">    top_z = -99999</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="746">
          
          
          <code class="ruby">    bottom_z = 99999</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="747">
          
          
          <code class="ruby">    surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="748">
          
          
          <code class="ruby">      top_z = [self.getSurfaceZValues([surface]).max, top_z].max</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="749">
          
          
          <code class="ruby">      bottom_z = [self.getSurfaceZValues([surface]).min, bottom_z].min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="750">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="751">
          
          
          <code class="ruby">    edges = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="752">
          
          
          <code class="ruby">    edge_counter = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="753">
          
          
          <code class="ruby">    surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="754">
          
          
          <code class="ruby">      if use_top_edge</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="755">
          
          
          <code class="ruby">        matchz = top_z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="757">
          
          
          <code class="ruby">        matchz = bottom_z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="758">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="759">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby">      # get vertices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="761">
          
          
          <code class="ruby">      vertex_hash = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="762">
          
          
          <code class="ruby">      vertex_counter = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="763">
          
          
          <code class="ruby">      surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">        next if (UnitConversions.convert(vertex.z, &quot;m&quot;, &quot;ft&quot;) - matchz).abs &gt; 0.0001 # ensure we only process bottom/top edge of wall surfaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="766">
          
          
          <code class="ruby">        vertex_counter += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="767">
          
          
          <code class="ruby">        vertex_hash[vertex_counter] = [vertex.x + surface.space.get.xOrigin,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="768">
          
          
          <code class="ruby">                                       vertex.y + surface.space.get.yOrigin,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="769">
          
          
          <code class="ruby">                                       vertex.z + surface.space.get.zOrigin]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="770">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="771">
          
          
          <code class="ruby">      # make edges</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="772">
          
          
          <code class="ruby">      counter = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="773">
          
          
          <code class="ruby">      vertex_hash.each do |k, v|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">        edge_counter += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">        counter += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">        if vertex_hash.size != counter</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="777">
          
          
          <code class="ruby">          edges &lt;&lt; [v, vertex_hash[counter + 1], self.get_facade_for_surface(surface)]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="778">
          
          
          <code class="ruby">        elsif vertex_hash.size &gt; 2 # different code for wrap around vertex (if &gt; 2 vertices)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="779">
          
          
          <code class="ruby">          edges &lt;&lt; [v, vertex_hash[1], self.get_facade_for_surface(surface)]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="782">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="783">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="784">
          
          
          <code class="ruby">    return edges</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="787">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.equal_vertices(v1, v2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="788">
          
          
          <code class="ruby">    tol = 0.001</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="789">
          
          
          <code class="ruby">    return false if (v1[0] - v2[0]).abs &gt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="790">
          
          
          <code class="ruby">    return false if (v1[1] - v2[1]).abs &gt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="791">
          
          
          <code class="ruby">    return false if (v1[2] - v2[2]).abs &gt; tol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="792">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="793">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="794">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="796">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_walls_connected_to_floor(wall_surfaces, floor_surface, same_space = true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="797">
          
          
          <code class="ruby">    adjacent_wall_surfaces = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="798">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="799">
          
          
          <code class="ruby">    wall_surfaces.each do |wall_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="800">
          
          
          <code class="ruby">      if same_space</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="801">
          
          
          <code class="ruby">        next if wall_surface.space.get != floor_surface.space.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="802">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="803">
          
          
          <code class="ruby">        next if wall_surface.space.get == floor_surface.space.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="804">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="805">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="806">
          
          
          <code class="ruby">      wall_vertices = wall_surface.vertices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="807">
          
          
          <code class="ruby">      wall_vertices.each_with_index do |wv1, widx|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">        wv2 = wall_vertices[widx - 1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="809">
          
          
          <code class="ruby">        floor_vertices = floor_surface.vertices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">        floor_vertices.each_with_index do |fv1, fidx|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="811">
          
          
          <code class="ruby">          fv2 = floor_vertices[fidx - 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby">          # Wall within floor edge?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="813">
          
          
          <code class="ruby">          if self.is_point_between([wv1.x, wv1.y, wv1.z], [fv1.x, fv1.y, fv1.z], [fv2.x, fv2.y, fv2.z]) and self.is_point_between([wv2.x, wv2.y, wv2.z], [fv1.x, fv1.y, fv1.z], [fv2.x, fv2.y, fv2.z])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="814">
          
          
          <code class="ruby">            if not adjacent_wall_surfaces.include? wall_surface</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="815">
          
          
          <code class="ruby">              adjacent_wall_surfaces &lt;&lt; wall_surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="816">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="819">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="820">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">    return adjacent_wall_surfaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="823">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="825">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_living(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="826">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeLiving)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="827">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="829">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_pier_beam(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="830">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypePierBeam)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="831">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="832">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="833">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_crawl(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="834">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeCrawl)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="835">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="837">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_finished_basement(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="838">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeFinishedBasement)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="839">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="840">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="841">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_unfinished_basement(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="842">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeUnfinishedBasement)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="843">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="844">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="845">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_unfinished_attic(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="846">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeUnfinishedAttic)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="847">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="848">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="849">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_garage(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="850">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeGarage)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="851">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="852">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="853">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_corridor(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="854">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeCorridor)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="855">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="856">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="857">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_bedroom(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="858">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeBedroom)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="859">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="860">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="861">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_office(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="862">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeOffice)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="863">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="864">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="865">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_retail(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="866">
          
          
          <code class="ruby">    return self.space_or_zone_is_of_type(space_or_zone, Constants.SpaceTypeRetail)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="867">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="868">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="869">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_or_zone_is_of_type(space_or_zone, space_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="870">
          
          
          <code class="ruby">    if space_or_zone.is_a? OpenStudio::Model::Space</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="871">
          
          
          <code class="ruby">      return self.space_is_of_type(space_or_zone, space_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="872">
          
          
          <code class="ruby">    elsif space_or_zone.is_a? OpenStudio::Model::ThermalZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="873">
          
          
          <code class="ruby">      return self.zone_is_of_type(space_or_zone, space_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="874">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="876">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="877">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.space_is_of_type(space, space_type)</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="878">
          <span class="hits">96</span>
          
          <code class="ruby">    unless space.isPlenum</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="879">
          <span class="hits">96</span>
          
          <code class="ruby">      if space.spaceType.is_initialized</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="880">
          <span class="hits">96</span>
          
          <code class="ruby">        if space.spaceType.get.standardsSpaceType.is_initialized</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="881">
          <span class="hits">96</span>
          
          <code class="ruby">          return true if space.spaceType.get.standardsSpaceType.get == space_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="882">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="883">
          
          
          <code class="ruby">        # alternate check for commercial space types that use standards building type and space type</code>
        </li>
      
        <li class="covered" data-hits="74" data-linenumber="884">
          <span class="hits">74</span>
          
          <code class="ruby">        if space.spaceType.get.standardsBuildingType.is_initialized &amp;&amp; space.spaceType.get.standardsSpaceType.is_initialized</code>
        </li>
      
        <li class="covered" data-hits="74" data-linenumber="885">
          <span class="hits">74</span>
          
          <code class="ruby">          return true if &quot;#{space.spaceType.get.standardsBuildingType.get},#{space.spaceType.get.standardsSpaceType.get}&quot; == space_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="886">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="887">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="888">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="74" data-linenumber="889">
          <span class="hits">74</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="890">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="891">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="892">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.zone_is_of_type(zone, space_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="893">
          
          
          <code class="ruby">    zone.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="894">
          
          
          <code class="ruby">      return self.space_is_of_type(space, space_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="895">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="896">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="897">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="898">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_basement(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="899">
          
          
          <code class="ruby">    if space_or_zone.is_a? OpenStudio::Model::Space</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="900">
          
          
          <code class="ruby">      return self.space_is_below_grade(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="901">
          
          
          <code class="ruby">    elsif space_or_zone.is_a? OpenStudio::Model::ThermalZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="902">
          
          
          <code class="ruby">      return self.zone_is_below_grade(space_or_zone)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="903">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="904">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="905">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="906">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_attic(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="907">
          
          
          <code class="ruby">    if space_or_zone.is_a? OpenStudio::Model::Space</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="908">
          
          
          <code class="ruby">      space_or_zone.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="909">
          
          
          <code class="ruby">        next unless surface.surfaceType.downcase.to_s == &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="910">
          
          
          <code class="ruby">        unless surface.outsideBoundaryCondition.downcase.to_s == &quot;outdoors&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="911">
          
          
          <code class="ruby">          return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="913">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="914">
          
          
          <code class="ruby">      space_or_zone.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="915">
          
          
          <code class="ruby">        next unless surface.surfaceType.downcase.to_s == &quot;floor&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="916">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="917">
          
          
          <code class="ruby">        surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="918">
          
          
          <code class="ruby">          unless vertex.z + space_or_zone.zOrigin &gt; 0 # not an attic if it isn&#39;t above grade</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="919">
          
          
          <code class="ruby">            return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="920">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="922">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="923">
          
          
          <code class="ruby">    elsif space_or_zone.is_a? OpenStudio::Model::ThermalZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="924">
          
          
          <code class="ruby">      space_or_zone.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="925">
          
          
          <code class="ruby">        space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="926">
          
          
          <code class="ruby">          next unless surface.surfaceType.downcase.to_s == &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="927">
          
          
          <code class="ruby">          if not surface.outsideBoundaryCondition.downcase.to_s == &quot;outdoors&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="928">
          
          
          <code class="ruby">            return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="929">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="930">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="931">
          
          
          <code class="ruby">        space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="932">
          
          
          <code class="ruby">          next unless surface.surfaceType.downcase.to_s == &quot;floor&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="933">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="934">
          
          
          <code class="ruby">          surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="935">
          
          
          <code class="ruby">            unless vertex.z + space.zOrigin &gt; 0 # not an attic if it isn&#39;t above grade</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="936">
          
          
          <code class="ruby">              return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="937">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="938">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="939">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="940">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="941">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="942">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="943">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="944">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_foundation(space_or_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="945">
          
          
          <code class="ruby">    return true if self.is_pier_beam(space_or_zone) or self.is_crawl(space_or_zone) or self.is_finished_basement(space_or_zone) or self.is_unfinished_basement(space_or_zone)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="946">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="947">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="948">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_crawl_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="949">
          
          
          <code class="ruby">    crawl_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="950">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="951">
          
          
          <code class="ruby">      next if not self.is_crawl(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="952">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="953">
          
          
          <code class="ruby">      crawl_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="954">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="955">
          
          
          <code class="ruby">    return crawl_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="956">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="957">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="958">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_pier_beam_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="959">
          
          
          <code class="ruby">    pb_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="960">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="961">
          
          
          <code class="ruby">      next if not self.is_pier_beam(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="962">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="963">
          
          
          <code class="ruby">      pb_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="964">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="965">
          
          
          <code class="ruby">    return pb_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="966">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="967">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="968">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_finished_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="969">
          
          
          <code class="ruby">    finished_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="970">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="971">
          
          
          <code class="ruby">      next if self.space_is_unfinished(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="972">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="973">
          
          
          <code class="ruby">      finished_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="974">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="975">
          
          
          <code class="ruby">    return finished_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="976">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="977">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="978">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_bedroom_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="979">
          
          
          <code class="ruby">    bedroom_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="980">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="981">
          
          
          <code class="ruby">      next if not self.is_bedroom(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="982">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="983">
          
          
          <code class="ruby">    return bedroom_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="984">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="985">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="986">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_finished_basement_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="987">
          
          
          <code class="ruby">    finished_basement_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="988">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="989">
          
          
          <code class="ruby">      next if not self.is_finished_basement(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="990">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="991">
          
          
          <code class="ruby">      finished_basement_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="992">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="993">
          
          
          <code class="ruby">    return finished_basement_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="994">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="995">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="996">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_unfinished_basement_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="997">
          
          
          <code class="ruby">    unfinished_basement_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="998">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="999">
          
          
          <code class="ruby">      next if not self.is_unfinished_basement(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1000">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1001">
          
          
          <code class="ruby">      unfinished_basement_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1002">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1003">
          
          
          <code class="ruby">    return unfinished_basement_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1004">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1005">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1006">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_unfinished_attic_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1007">
          
          
          <code class="ruby">    unfinished_attic_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1008">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1009">
          
          
          <code class="ruby">      next if not self.is_unfinished_attic(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1010">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1011">
          
          
          <code class="ruby">      unfinished_attic_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1012">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1013">
          
          
          <code class="ruby">    return unfinished_attic_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1014">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1015">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1016">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_garage_spaces(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1017">
          
          
          <code class="ruby">    garage_spaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1018">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1019">
          
          
          <code class="ruby">      next if not self.is_garage(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1020">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1021">
          
          
          <code class="ruby">      garage_spaces &lt;&lt; space</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1022">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1023">
          
          
          <code class="ruby">    return garage_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1024">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1025">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1026">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_facade_for_surface(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1027">
          
          
          <code class="ruby">    tol = 0.001</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1028">
          
          
          <code class="ruby">    n = surface.outwardNormal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1029">
          
          
          <code class="ruby">    facade = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1030">
          
          
          <code class="ruby">    if (n.z).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1031">
          
          
          <code class="ruby">      if (n.x).abs &lt; tol and (n.y + 1).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1032">
          
          
          <code class="ruby">        facade = Constants.FacadeFront</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1033">
          
          
          <code class="ruby">      elsif (n.x - 1).abs &lt; tol and (n.y).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1034">
          
          
          <code class="ruby">        facade = Constants.FacadeRight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1035">
          
          
          <code class="ruby">      elsif (n.x).abs &lt; tol and (n.y - 1).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1036">
          
          
          <code class="ruby">        facade = Constants.FacadeBack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1037">
          
          
          <code class="ruby">      elsif (n.x + 1).abs &lt; tol and (n.y).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1038">
          
          
          <code class="ruby">        facade = Constants.FacadeLeft</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1039">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1040">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1041">
          
          
          <code class="ruby">      if (n.x).abs &lt; tol and n.y &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1042">
          
          
          <code class="ruby">        facade = Constants.FacadeFront</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1043">
          
          
          <code class="ruby">      elsif n.x &gt; 0 and (n.y).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1044">
          
          
          <code class="ruby">        facade = Constants.FacadeRight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1045">
          
          
          <code class="ruby">      elsif (n.x).abs &lt; tol and n.y &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1046">
          
          
          <code class="ruby">        facade = Constants.FacadeBack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1047">
          
          
          <code class="ruby">      elsif n.x &lt; 0 and (n.y).abs &lt; tol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1048">
          
          
          <code class="ruby">        facade = Constants.FacadeLeft</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1049">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1050">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1051">
          
          
          <code class="ruby">    return facade</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1052">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1053">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1054">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_surface_length(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1055">
          
          
          <code class="ruby">    xvalues = self.getSurfaceXValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1056">
          
          
          <code class="ruby">    yvalues = self.getSurfaceYValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1057">
          
          
          <code class="ruby">    xrange = xvalues.max - xvalues.min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1058">
          
          
          <code class="ruby">    yrange = yvalues.max - yvalues.min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1059">
          
          
          <code class="ruby">    if xrange &gt; yrange</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1060">
          
          
          <code class="ruby">      return xrange</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1061">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1062">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1063">
          
          
          <code class="ruby">    return yrange</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1064">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1065">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1066">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_surface_height(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1067">
          
          
          <code class="ruby">    zvalues = self.getSurfaceZValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1068">
          
          
          <code class="ruby">    zrange = zvalues.max - zvalues.min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1069">
          
          
          <code class="ruby">    return zrange</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1070">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1071">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1072">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_gable_wall(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1073">
          
          
          <code class="ruby">    if (surface.surfaceType.downcase != &quot;wall&quot; or surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1074">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1075">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1076">
          
          
          <code class="ruby">    if surface.vertices.size != 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1077">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1078">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1079">
          
          
          <code class="ruby">    if not surface.space.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1080">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1081">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1082">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1083">
          
          
          <code class="ruby">    space = surface.space.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1084">
          
          
          <code class="ruby">    if not self.space_has_roof(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1085">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1086">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1087">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1088">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1089">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1090">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1091">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.is_rectangular_wall(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1092">
          
          
          <code class="ruby">    if (surface.surfaceType.downcase != &quot;wall&quot; or surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1093">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1094">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1095">
          
          
          <code class="ruby">    if surface.vertices.size != 4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1096">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1097">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1098">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1099">
          
          
          <code class="ruby">    xvalues = self.getSurfaceXValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1100">
          
          
          <code class="ruby">    yvalues = self.getSurfaceYValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1101">
          
          
          <code class="ruby">    zvalues = self.getSurfaceZValues([surface])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1102">
          
          
          <code class="ruby">    if not ((xvalues.uniq.size == 1 and yvalues.uniq.size == 2) or</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1103">
          
          
          <code class="ruby">            (xvalues.uniq.size == 2 and yvalues.uniq.size == 1))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1104">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1106">
          
          
          <code class="ruby">    if not zvalues.uniq.size == 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1107">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1110">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1113">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_closest_neighbor_distance(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1114">
          
          
          <code class="ruby">    house_points = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1115">
          
          
          <code class="ruby">    neighbor_points = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1116">
          
          
          <code class="ruby">    model.getSurfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1117">
          
          
          <code class="ruby">      next unless surface.surfaceType.downcase == &quot;wall&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1119">
          
          
          <code class="ruby">      surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1120">
          
          
          <code class="ruby">        house_points &lt;&lt; OpenStudio::Point3d.new(vertex)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1121">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1122">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1123">
          
          
          <code class="ruby">    model.getShadingSurfaces.each do |shading_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1124">
          
          
          <code class="ruby">      next unless shading_surface.name.to_s.downcase.include? &quot;neighbor&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1126">
          
          
          <code class="ruby">      shading_surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1127">
          
          
          <code class="ruby">        neighbor_points &lt;&lt; OpenStudio::Point3d.new(vertex)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1128">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1129">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1130">
          
          
          <code class="ruby">    neighbor_offsets = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1131">
          
          
          <code class="ruby">    house_points.each do |house_point|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1132">
          
          
          <code class="ruby">      neighbor_points.each do |neighbor_point|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1133">
          
          
          <code class="ruby">        neighbor_offsets &lt;&lt; OpenStudio::getDistance(house_point, neighbor_point)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1134">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1135">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1136">
          
          
          <code class="ruby">    if neighbor_offsets.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1137">
          
          
          <code class="ruby">      return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1140">
          
          
          <code class="ruby">    return UnitConversions.convert(neighbor_offsets.min, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1143">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_above_grade_exterior_walls(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1144">
          
          
          <code class="ruby">    above_grade_exterior_walls = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1145">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1146">
          
          
          <code class="ruby">      next if not Geometry.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1147">
          
          
          <code class="ruby">      next if not Geometry.space_is_above_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1149">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1150">
          
          
          <code class="ruby">        next if above_grade_exterior_walls.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1151">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1152">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1154">
          
          
          <code class="ruby">        above_grade_exterior_walls &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1155">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1156">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1157">
          
          
          <code class="ruby">    return above_grade_exterior_walls</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1160">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_above_grade_exterior_floors(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1161">
          
          
          <code class="ruby">    above_grade_exterior_floors = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1162">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1163">
          
          
          <code class="ruby">      next if not Geometry.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1164">
          
          
          <code class="ruby">      next if not Geometry.space_is_above_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1166">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1167">
          
          
          <code class="ruby">        next if above_grade_exterior_floors.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1168">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;floor&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1169">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1171">
          
          
          <code class="ruby">        above_grade_exterior_floors &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1172">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1173">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1174">
          
          
          <code class="ruby">    return above_grade_exterior_floors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1177">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_above_grade_ground_floors(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1178">
          
          
          <code class="ruby">    above_grade_ground_floors = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1179">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1180">
          
          
          <code class="ruby">      next if not Geometry.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1181">
          
          
          <code class="ruby">      next if not Geometry.space_is_above_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1183">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1184">
          
          
          <code class="ruby">        next if above_grade_ground_floors.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1185">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;floor&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1186">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;foundation&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1188">
          
          
          <code class="ruby">        above_grade_ground_floors &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1189">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1190">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1191">
          
          
          <code class="ruby">    return above_grade_ground_floors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1192">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1194">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_above_grade_exterior_roofs(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1195">
          
          
          <code class="ruby">    above_grade_exterior_roofs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1196">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1197">
          
          
          <code class="ruby">      next if not Geometry.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1198">
          
          
          <code class="ruby">      next if not Geometry.space_is_above_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1200">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1201">
          
          
          <code class="ruby">        next if above_grade_exterior_roofs.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1202">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1203">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;outdoors&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1205">
          
          
          <code class="ruby">        above_grade_exterior_roofs &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1206">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1207">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1208">
          
          
          <code class="ruby">    return above_grade_exterior_roofs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1209">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1211">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_interzonal_walls(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1212">
          
          
          <code class="ruby">    interzonal_walls = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1213">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1214">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1215">
          
          
          <code class="ruby">        next if interzonal_walls.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1216">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1217">
          
          
          <code class="ruby">        next if not self.is_interzonal_surface(surface)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1219">
          
          
          <code class="ruby">        interzonal_walls &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1220">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1221">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1222">
          
          
          <code class="ruby">    return interzonal_walls</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1223">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1225">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_interzonal_floors_and_ceilings(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1226">
          
          
          <code class="ruby">    interzonal_floors = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1227">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1228">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1229">
          
          
          <code class="ruby">        next if interzonal_floors.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1230">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;floor&quot; and surface.surfaceType.downcase != &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1231">
          
          
          <code class="ruby">        next if not self.is_interzonal_surface(surface)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1233">
          
          
          <code class="ruby">        interzonal_floors &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1234">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1235">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1236">
          
          
          <code class="ruby">    return interzonal_floors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1239">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_below_grade_exterior_walls(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1240">
          
          
          <code class="ruby">    below_grade_exterior_walls = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1241">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1242">
          
          
          <code class="ruby">      next if not Geometry.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1243">
          
          
          <code class="ruby">      next if not Geometry.space_is_below_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1245">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1246">
          
          
          <code class="ruby">        next if below_grade_exterior_walls.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1247">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;wall&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1248">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;foundation&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1249">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1250">
          
          
          <code class="ruby">        below_grade_exterior_walls &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1251">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1252">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1253">
          
          
          <code class="ruby">    return below_grade_exterior_walls</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1254">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1256">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_spaces_below_grade_exterior_floors(spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1257">
          
          
          <code class="ruby">    below_grade_exterior_floors = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1258">
          
          
          <code class="ruby">    spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1259">
          
          
          <code class="ruby">      next if not Geometry.space_is_finished(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1260">
          
          
          <code class="ruby">      next if not Geometry.space_is_below_grade(space)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1262">
          
          
          <code class="ruby">      space.surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1263">
          
          
          <code class="ruby">        next if below_grade_exterior_floors.include?(surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1264">
          
          
          <code class="ruby">        next if surface.surfaceType.downcase != &quot;floor&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1265">
          
          
          <code class="ruby">        next if surface.outsideBoundaryCondition.downcase != &quot;foundation&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1267">
          
          
          <code class="ruby">        below_grade_exterior_floors &lt;&lt; surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1268">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1269">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1270">
          
          
          <code class="ruby">    return below_grade_exterior_floors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1271">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1273">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_overhangs(model, runner, depth, offset, facade_bools_hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1274">
          
          
          <code class="ruby">    # Error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1275">
          
          
          <code class="ruby">    if depth &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1276">
          
          
          <code class="ruby">      runner.registerError(&quot;Overhang depth must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1277">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1278">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1279">
          
          
          <code class="ruby">    if offset &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1280">
          
          
          <code class="ruby">      runner.registerError(&quot;Overhang offset must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1281">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1282">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1283">
          
          
          <code class="ruby">    # if width_extension &lt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1284">
          
          
          <code class="ruby">    # runner.registerError(&quot;Overhang width extension must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1285">
          
          
          <code class="ruby">    # return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1286">
          
          
          <code class="ruby">    # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1287">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1288">
          
          
          <code class="ruby">    sub_surfaces = self.get_window_sub_surfaces(model)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1289">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1290">
          
          
          <code class="ruby">    # Remove existing overhangs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1291">
          
          
          <code class="ruby">    num_removed = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1292">
          
          
          <code class="ruby">    model.getShadingSurfaceGroups.each do |shading_surface_group|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1293">
          
          
          <code class="ruby">      remove_group = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1294">
          
          
          <code class="ruby">      shading_surface_group.shadingSurfaces.each do |shading_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1295">
          
          
          <code class="ruby">        next unless shading_surface.name.to_s.downcase.include? Constants.ObjectNameOverhangs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1297">
          
          
          <code class="ruby">        num_removed += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1298">
          
          
          <code class="ruby">        remove_group = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1299">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1300">
          
          
          <code class="ruby">      if remove_group</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1301">
          
          
          <code class="ruby">        shading_surface_group.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1302">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1303">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1304">
          
          
          <code class="ruby">    if num_removed &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1305">
          
          
          <code class="ruby">      runner.registerInfo(&quot;Removed #{num_removed} #{Constants.ObjectNameOverhangs}.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1306">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1307">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1308">
          
          
          <code class="ruby">    # No overhangs to add? Exit here.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1309">
          
          
          <code class="ruby">    if depth == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1310">
          
          
          <code class="ruby">      runner.registerInfo(&quot;No #{Constants.ObjectNameOverhangs} to be added.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1311">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1312">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1313">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1314">
          
          
          <code class="ruby">    num_added = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1315">
          
          
          <code class="ruby">    sub_surfaces.each do |sub_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1316">
          
          
          <code class="ruby">      facade = self.get_facade_for_surface(sub_surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1317">
          
          
          <code class="ruby">      next if facade.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1318">
          
          
          <code class="ruby">      next if !facade_bools_hash[&quot;#{facade} Facade&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1320">
          
          
          <code class="ruby">      overhang = sub_surface.addOverhang(depth, offset)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1321">
          
          
          <code class="ruby">      overhang.get.setName(&quot;#{sub_surface.name} - #{Constants.ObjectNameOverhangs}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1322">
          
          
          <code class="ruby">      num_added += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1324">
          
          
          <code class="ruby">      sub_surface.additionalProperties.setFeature(Constants.SizingInfoWindowOverhangDepth, depth)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1325">
          
          
          <code class="ruby">      sub_surface.additionalProperties.setFeature(Constants.SizingInfoWindowOverhangOffset, offset)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1326">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1328">
          
          
          <code class="ruby">    unless num_added &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1329">
          
          
          <code class="ruby">      runner.registerInfo(&quot;No windows found for adding #{Constants.ObjectNameOverhangs}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1330">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1331">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1333">
          
          
          <code class="ruby">    runner.registerInfo(&quot;Added #{num_added} #{Constants.ObjectNameOverhangs}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1334">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1335">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1337">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_window_sub_surfaces(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1338">
          
          
          <code class="ruby">    sub_surfaces = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1339">
          
          
          <code class="ruby">    model.getSubSurfaces.each do |sub_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1340">
          
          
          <code class="ruby">      next unless sub_surface.subSurfaceType.downcase.include? &quot;window&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1341">
          
          
          <code class="ruby">      next if (90 - sub_surface.tilt * 180 / Math::PI).abs &gt; 0.01 # not a vertical subsurface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1343">
          
          
          <code class="ruby">      sub_surfaces &lt;&lt; sub_surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1344">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1345">
          
          
          <code class="ruby">    return sub_surfaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1346">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1347">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1348">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_beds_and_baths(model, runner, num_br, num_ba)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1349">
          
          
          <code class="ruby">    # Error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1350">
          
          
          <code class="ruby">    if not num_br.all? { |x| MathTools.valid_float?(x) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1351">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bedrooms must be a numerical value.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1352">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1353">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1354">
          
          
          <code class="ruby">      num_br = num_br.map(&amp;:to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1355">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1356">
          
          
          <code class="ruby">    if not num_ba.all? { |x| MathTools.valid_float?(x) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1357">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bathrooms must be a numerical value.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1358">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1359">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1360">
          
          
          <code class="ruby">      num_ba = num_ba.map(&amp;:to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1361">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1362">
          
          
          <code class="ruby">    if num_br.any? { |x| x &lt; 0 or x % 1 != 0 }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1363">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bedrooms must be a non-negative integer.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1364">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1365">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1366">
          
          
          <code class="ruby">    if num_ba.any? { |x| x &lt;= 0 or x % 0.25 != 0 }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1367">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bathrooms must be a positive multiple of 0.25.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1368">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1369">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1370">
          
          
          <code class="ruby">    if num_br.length &gt; 1 and num_ba.length &gt; 1 and num_br.length != num_ba.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1371">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bedroom elements specified inconsistent with number of bathroom elements specified.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1372">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1373">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1374">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1375">
          
          
          <code class="ruby">    # Get building units</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1376">
          
          
          <code class="ruby">    units = self.get_building_units(model, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1377">
          
          
          <code class="ruby">    if units.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1378">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1379">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1381">
          
          
          <code class="ruby">    # error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1382">
          
          
          <code class="ruby">    if num_br.length &gt; 1 and num_br.length != units.size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1383">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bedroom elements specified inconsistent with number of multifamily units defined in the model.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1384">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1385">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1386">
          
          
          <code class="ruby">    if num_ba.length &gt; 1 and num_ba.length != units.size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1387">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of bathroom elements specified inconsistent with number of multifamily units defined in the model.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1388">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1389">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1390">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1391">
          
          
          <code class="ruby">    if units.size &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1392">
          
          
          <code class="ruby">      if num_br.length == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1393">
          
          
          <code class="ruby">        num_br = Array.new(units.size, num_br[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1394">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1395">
          
          
          <code class="ruby">      if num_ba.length == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1396">
          
          
          <code class="ruby">        num_ba = Array.new(units.size, num_ba[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1397">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1398">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1399">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1400">
          
          
          <code class="ruby">    # Update number of bedrooms/bathrooms</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1401">
          
          
          <code class="ruby">    total_num_br = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1402">
          
          
          <code class="ruby">    total_num_ba = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1403">
          
          
          <code class="ruby">    units.each_with_index do |unit, unit_index|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1404">
          
          
          <code class="ruby">      num_br[unit_index] = num_br[unit_index].to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1405">
          
          
          <code class="ruby">      num_ba[unit_index] = num_ba[unit_index].to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1406">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1407">
          
          
          <code class="ruby">      unit.additionalProperties.setFeature(Constants.BuildingUnitFeatureNumBedrooms, num_br[unit_index])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1408">
          
          
          <code class="ruby">      unit.additionalProperties.setFeature(Constants.BuildingUnitFeatureNumBathrooms, num_ba[unit_index])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1409">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1410">
          
          
          <code class="ruby">      if units.size &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1411">
          
          
          <code class="ruby">        runner.registerInfo(&quot;Unit &#39;#{unit_index}&#39; has been assigned #{num_br[unit_index].to_s} bedroom(s) and #{num_ba[unit_index].round(2).to_s} bathroom(s).&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1412">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1413">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1414">
          
          
          <code class="ruby">      total_num_br += num_br[unit_index]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1415">
          
          
          <code class="ruby">      total_num_ba += num_ba[unit_index]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1416">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1417">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1418">
          
          
          <code class="ruby">    runner.registerInfo(&quot;The building has been assigned #{total_num_br.to_s} bedroom(s) and #{total_num_ba.round(2).to_s} bathroom(s) across #{units.size} unit(s).&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1419">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1420">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1421">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1422">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_occupants(model, runner, num_occ, occ_gain, sens_frac, lat_frac, weekday_sch, weekend_sch, monthly_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1423">
          
          
          <code class="ruby">    num_occ = num_occ.split(&quot;,&quot;).map(&amp;:strip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1424">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1425">
          
          
          <code class="ruby">    # Error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1426">
          
          
          <code class="ruby">    if occ_gain &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1427">
          
          
          <code class="ruby">      runner.registerError(&quot;Internal gains cannot be negative.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1428">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1429">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1430">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1431">
          
          
          <code class="ruby">    if sens_frac &lt; 0 or sens_frac &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1432">
          
          
          <code class="ruby">      runner.registerError(&quot;Sensible fraction must be greater than or equal to 0 and less than or equal to 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1433">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1434">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1435">
          
          
          <code class="ruby">    if lat_frac &lt; 0 or lat_frac &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1436">
          
          
          <code class="ruby">      runner.registerError(&quot;Latent fraction must be greater than or equal to 0 and less than or equal to 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1437">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1438">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1439">
          
          
          <code class="ruby">    if lat_frac + sens_frac &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1440">
          
          
          <code class="ruby">      runner.registerError(&quot;Sum of sensible and latent fractions must be less than or equal to 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1441">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1442">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1443">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1444">
          
          
          <code class="ruby">    # Get building units</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1445">
          
          
          <code class="ruby">    units = self.get_building_units(model, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1446">
          
          
          <code class="ruby">    if units.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1447">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1448">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1449">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1450">
          
          
          <code class="ruby">    # Error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1451">
          
          
          <code class="ruby">    if num_occ.length &gt; 1 and num_occ.length != units.size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1452">
          
          
          <code class="ruby">      runner.registerError(&quot;Number of occupant elements specified inconsistent with number of multifamily units defined in the model.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1453">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1454">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1455">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1456">
          
          
          <code class="ruby">    if units.size &gt; 1 and num_occ.length == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1457">
          
          
          <code class="ruby">      num_occ = Array.new(units.size, num_occ[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1458">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1459">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1460">
          
          
          <code class="ruby">    activity_per_person = UnitConversions.convert(occ_gain, &quot;Btu/hr&quot;, &quot;W&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1461">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1462">
          
          
          <code class="ruby">    # Hard-coded convective, radiative, latent, and lost fractions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1463">
          
          
          <code class="ruby">    occ_lat = lat_frac</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1464">
          
          
          <code class="ruby">    occ_sens = sens_frac</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1465">
          
          
          <code class="ruby">    occ_conv = 0.442 * occ_sens</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1466">
          
          
          <code class="ruby">    occ_rad = 0.558 * occ_sens</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1467">
          
          
          <code class="ruby">    occ_lost = 1 - occ_lat - occ_conv - occ_rad</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1468">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1469">
          
          
          <code class="ruby">    # Update number of occupants</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1470">
          
          
          <code class="ruby">    total_num_occ = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1471">
          
          
          <code class="ruby">    people_sch = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1472">
          
          
          <code class="ruby">    activity_sch = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1473">
          
          
          <code class="ruby">    units.each_with_index do |unit, unit_index|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1474">
          
          
          <code class="ruby">      unit_occ = num_occ[unit_index]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1475">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1476">
          
          
          <code class="ruby">      if unit_occ != Constants.Auto</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1477">
          
          
          <code class="ruby">        if not MathTools.valid_float?(unit_occ)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1478">
          
          
          <code class="ruby">          runner.registerError(&quot;Number of Occupants must be either &#39;#{Constants.Auto}&#39; or a number greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1479">
          
          
          <code class="ruby">          return false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1480">
          
          
          <code class="ruby">        elsif unit_occ.to_f &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1481">
          
          
          <code class="ruby">          runner.registerError(&quot;Number of Occupants must be either &#39;#{Constants.Auto}&#39; or a number greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1482">
          
          
          <code class="ruby">          return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1483">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1484">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1485">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1486">
          
          
          <code class="ruby">      # Get number of beds</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1487">
          
          
          <code class="ruby">      nbeds, nbaths = self.get_unit_beds_baths(model, unit, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1488">
          
          
          <code class="ruby">      if nbeds.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1489">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1490">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1491">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1492">
          
          
          <code class="ruby">      # Calculate number of occupants for this unit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1493">
          
          
          <code class="ruby">      if unit_occ == Constants.Auto</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1494">
          
          
          <code class="ruby">        if units.size &gt; 1 # multifamily equation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1495">
          
          
          <code class="ruby">          unit_occ = 0.63 + 0.92 * nbeds</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1496">
          
          
          <code class="ruby">        else # single-family equation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1497">
          
          
          <code class="ruby">          unit_occ = 0.87 + 0.59 * nbeds</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1498">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1499">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1500">
          
          
          <code class="ruby">        unit_occ = unit_occ.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1501">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1502">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1503">
          
          
          <code class="ruby">      # Get spaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1504">
          
          
          <code class="ruby">      bedroom_ffa_spaces = self.get_bedroom_spaces(unit.spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1505">
          
          
          <code class="ruby">      non_bedroom_ffa_spaces = self.get_finished_spaces(unit.spaces) - bedroom_ffa_spaces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1506">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1507">
          
          
          <code class="ruby">      # Get FFA</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1508">
          
          
          <code class="ruby">      non_bedroom_ffa = self.get_finished_floor_area_from_spaces(non_bedroom_ffa_spaces, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1509">
          
          
          <code class="ruby">      bedroom_ffa = self.get_finished_floor_area_from_spaces(bedroom_ffa_spaces)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1510">
          
          
          <code class="ruby">      bedroom_ffa = 0 if bedroom_ffa.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1511">
          
          
          <code class="ruby">      ffa = non_bedroom_ffa + bedroom_ffa</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1512">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1513">
          
          
          <code class="ruby">      schedules = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1514">
          
          
          <code class="ruby">      if not bedroom_ffa_spaces.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1515">
          
          
          <code class="ruby">        # Split schedules into non-bedroom vs bedroom</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1516">
          
          
          <code class="ruby">        bedroom_ratios = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.75, 0.46, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.33, 1.0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1517">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1518">
          
          
          <code class="ruby">        living_weekday_sch = weekday_sch.split(&quot;,&quot;).map(&amp;:to_f).zip(bedroom_ratios).map { |x, y| x * (1 - y) }.join(&quot;, &quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1519">
          
          
          <code class="ruby">        living_weekend_sch = weekend_sch.split(&quot;,&quot;).map(&amp;:to_f).zip(bedroom_ratios).map { |x, y| x * (1 - y) }.join(&quot;, &quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1520">
          
          
          <code class="ruby">        living_activity_per_person = 420.0 / 384.0 * activity_per_person</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1521">
          
          
          <code class="ruby">        schedules[non_bedroom_ffa_spaces] = [living_weekday_sch, living_weekend_sch, living_activity_per_person]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1522">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1523">
          
          
          <code class="ruby">        bedroom_weekday_sch = weekday_sch.split(&quot;,&quot;).map(&amp;:to_f).zip(bedroom_ratios).map { |x, y| x * y }.join(&quot;, &quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1524">
          
          
          <code class="ruby">        bedroom_weekend_sch = weekend_sch.split(&quot;,&quot;).map(&amp;:to_f).zip(bedroom_ratios).map { |x, y| x * y }.join(&quot;, &quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1525">
          
          
          <code class="ruby">        bedroom_activity_per_person = 350.0 / 384.0 * activity_per_person</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1526">
          
          
          <code class="ruby">        schedules[bedroom_ffa_spaces] = [bedroom_weekday_sch, bedroom_weekend_sch, bedroom_activity_per_person]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1527">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1528">
          
          
          <code class="ruby">        schedules[non_bedroom_ffa_spaces] = [weekday_sch, weekend_sch, activity_per_person]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1529">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1530">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1531">
          
          
          <code class="ruby">      # Design day schedules used when autosizing</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1532">
          
          
          <code class="ruby">      winter_design_day_sch = OpenStudio::Model::ScheduleDay.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1533">
          
          
          <code class="ruby">      winter_design_day_sch.addValue(OpenStudio::Time.new(0, 24, 0, 0), 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1534">
          
          
          <code class="ruby">      summer_design_day_sch = OpenStudio::Model::ScheduleDay.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1535">
          
          
          <code class="ruby">      summer_design_day_sch.addValue(OpenStudio::Time.new(0, 24, 0, 0), 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1536">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1537">
          
          
          <code class="ruby">      # Assign occupants to each space of the unit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1538">
          
          
          <code class="ruby">      schedules.each do |spaces, schedule|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1539">
          
          
          <code class="ruby">        spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1540">
          
          
          <code class="ruby">          space_obj_name = &quot;#{Constants.ObjectNameOccupants(unit.name.to_s)}|#{space.name.to_s}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1541">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1542">
          
          
          <code class="ruby">          # Remove any existing people</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1543">
          
          
          <code class="ruby">          objects_to_remove = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1544">
          
          
          <code class="ruby">          space.people.each do |people|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1545">
          
          
          <code class="ruby">            objects_to_remove &lt;&lt; people</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1546">
          
          
          <code class="ruby">            objects_to_remove &lt;&lt; people.peopleDefinition</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1547">
          
          
          <code class="ruby">            if people.numberofPeopleSchedule.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1548">
          
          
          <code class="ruby">              objects_to_remove &lt;&lt; people.numberofPeopleSchedule.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1549">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1550">
          
          
          <code class="ruby">            if people.activityLevelSchedule.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1551">
          
          
          <code class="ruby">              objects_to_remove &lt;&lt; people.activityLevelSchedule.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1552">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1553">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1554">
          
          
          <code class="ruby">          if objects_to_remove.size &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1555">
          
          
          <code class="ruby">            runner.registerInfo(&quot;Removed existing people from space &#39;#{space.name.to_s}&#39;.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1556">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1557">
          
          
          <code class="ruby">          objects_to_remove.uniq.each do |object|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1558">
          
          
          <code class="ruby">            begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1559">
          
          
          <code class="ruby">              object.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1560">
          
          
          <code class="ruby">            rescue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1561">
          
          
          <code class="ruby">              # no op</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1562">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1563">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1564">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1565">
          
          
          <code class="ruby">          space_num_occ = unit_occ * UnitConversions.convert(space.floorArea, &quot;m^2&quot;, &quot;ft^2&quot;) / ffa</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1566">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1567">
          
          
          <code class="ruby">          if space_num_occ &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1568">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1569">
          
          
          <code class="ruby">            if people_sch.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1570">
          
          
          <code class="ruby">              # Create schedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1571">
          
          
          <code class="ruby">              people_sch = MonthWeekdayWeekendSchedule.new(model, runner, Constants.ObjectNameOccupants + &quot; schedule&quot;, schedule[0], schedule[1], monthly_sch, mult_weekday = 1.0, mult_weekend = 1.0, normalize_values = true, create_sch_object = true, winter_design_day_sch = winter_design_day_sch, summer_design_day_sch = summer_design_day_sch, schedule_type_limits_name = Constants.ScheduleTypeLimitsFraction)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1572">
          
          
          <code class="ruby">              if not people_sch.validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1573">
          
          
          <code class="ruby">                return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1574">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1575">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1576">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1577">
          
          
          <code class="ruby">            if activity_sch.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1578">
          
          
          <code class="ruby">              # Create schedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1579">
          
          
          <code class="ruby">              activity_sch = OpenStudio::Model::ScheduleRuleset.new(model, schedule[2])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1580">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1581">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1582">
          
          
          <code class="ruby">            # Add people definition for the occ</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1583">
          
          
          <code class="ruby">            occ_def = OpenStudio::Model::PeopleDefinition.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1584">
          
          
          <code class="ruby">            occ = OpenStudio::Model::People.new(occ_def)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1585">
          
          
          <code class="ruby">            occ.setName(space_obj_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1586">
          
          
          <code class="ruby">            occ.setSpace(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1587">
          
          
          <code class="ruby">            occ_def.setName(space_obj_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1588">
          
          
          <code class="ruby">            occ_def.setNumberOfPeopleCalculationMethod(&quot;People&quot;, 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1589">
          
          
          <code class="ruby">            occ_def.setNumberofPeople(space_num_occ)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1590">
          
          
          <code class="ruby">            occ_def.setFractionRadiant(occ_rad)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1591">
          
          
          <code class="ruby">            occ_def.setSensibleHeatFraction(occ_sens)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1592">
          
          
          <code class="ruby">            occ_def.setMeanRadiantTemperatureCalculationType(&quot;ZoneAveraged&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1593">
          
          
          <code class="ruby">            occ_def.setCarbonDioxideGenerationRate(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1594">
          
          
          <code class="ruby">            occ_def.setEnableASHRAE55ComfortWarnings(false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1595">
          
          
          <code class="ruby">            occ.setActivityLevelSchedule(activity_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1596">
          
          
          <code class="ruby">            occ.setNumberofPeopleSchedule(people_sch.schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1597">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1598">
          
          
          <code class="ruby">            total_num_occ += space_num_occ</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1599">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1600">
          
          
          <code class="ruby">            runner.registerInfo(&quot;#{unit.name.to_s} has been assigned #{space_num_occ.round(2)} occupant(s) for space &#39;#{space.name}&#39;.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1601">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1602">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1603">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1604">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1605">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1606">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1607">
          
          
          <code class="ruby">    runner.registerInfo(&quot;The building has been assigned #{total_num_occ.round(2)} occupant(s) across #{units.size} unit(s).&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1608">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1609">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1610">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1611">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_occupancy_default_num(nbeds)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1612">
          
          
          <code class="ruby">    return Float(nbeds)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1613">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1614">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1615">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_occupancy_default_values()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1616">
          
          
          <code class="ruby">    # Table 4.2.2(3). Internal Gains for Reference Homes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1617">
          
          
          <code class="ruby">    hrs_per_day = 16.5 # hrs/day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1618">
          
          
          <code class="ruby">    sens_gains = 3716.0 # Btu/person/day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1619">
          
          
          <code class="ruby">    lat_gains = 2884.0 # Btu/person/day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1620">
          
          
          <code class="ruby">    tot_gains = sens_gains + lat_gains</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1621">
          
          
          <code class="ruby">    heat_gain = tot_gains / hrs_per_day # Btu/person/hr</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1622">
          
          
          <code class="ruby">    sens = sens_gains / tot_gains</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1623">
          
          
          <code class="ruby">    lat = lat_gains / tot_gains</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1624">
          
          
          <code class="ruby">    return heat_gain, hrs_per_day, sens, lat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1625">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1626">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1627">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_eaves(model, runner, eaves_depth, roof_structure)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1628">
          
          
          <code class="ruby">    # Error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1629">
          
          
          <code class="ruby">    if eaves_depth &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1630">
          
          
          <code class="ruby">      runner.registerError(&quot;Eaves depth must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1631">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1632">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1633">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1634">
          
          
          <code class="ruby">    # Remove existing eaves</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1635">
          
          
          <code class="ruby">    num_removed = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1636">
          
          
          <code class="ruby">    existing_eaves_depth = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1637">
          
          
          <code class="ruby">    model.getShadingSurfaceGroups.each do |shading_surface_group|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1638">
          
          
          <code class="ruby">      next unless shading_surface_group.name.to_s == Constants.ObjectNameEaves</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1639">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1640">
          
          
          <code class="ruby">      shading_surface_group.shadingSurfaces.each do |shading_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1641">
          
          
          <code class="ruby">        num_removed += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1642">
          
          
          <code class="ruby">        next unless existing_eaves_depth.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1643">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1644">
          
          
          <code class="ruby">        existing_eaves_depth = self.get_existing_eaves_depth(shading_surface)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1645">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1646">
          
          
          <code class="ruby">      shading_surface_group.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1647">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1648">
          
          
          <code class="ruby">    if num_removed &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1649">
          
          
          <code class="ruby">      runner.registerInfo(&quot;#{num_removed} #{Constants.ObjectNameEaves} removed.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1650">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1651">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1652">
          
          
          <code class="ruby">    # No eaves to add? Exit here.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1653">
          
          
          <code class="ruby">    if eaves_depth == 0 and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1654">
          
          
          <code class="ruby">       runner.registerInfo(&quot;No #{Constants.ObjectNameEaves} were added.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1655">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1656">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1657">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1658">
          
          
          <code class="ruby">    if existing_eaves_depth.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1659">
          
          
          <code class="ruby">      existing_eaves_depth = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1660">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1661">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1662">
          
          
          <code class="ruby">    surfaces_modified = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1663">
          
          
          <code class="ruby">    shading_surface_group = OpenStudio::Model::ShadingSurfaceGroup.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1664">
          
          
          <code class="ruby">    shading_surface_group.setName(Constants.ObjectNameEaves)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1665">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1666">
          
          
          <code class="ruby">    model.getSurfaces.each do |roof_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1667">
          
          
          <code class="ruby">      next unless roof_surface.surfaceType.downcase == &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1668">
          
          
          <code class="ruby">      next unless roof_surface.outsideBoundaryCondition.downcase == &quot;outdoors&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1669">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1670">
          
          
          <code class="ruby">      if roof_structure == Constants.RoofStructureTrussCantilever</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1671">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1672">
          
          
          <code class="ruby">        l, w, h = self.get_surface_dimensions(roof_surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1673">
          
          
          <code class="ruby">        lift = (h / [l, w].min) * eaves_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1674">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1675">
          
          
          <code class="ruby">        m = self.initialize_transformation_matrix(OpenStudio::Matrix.new(4, 4, 0))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1676">
          
          
          <code class="ruby">        m[2, 3] = lift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1677">
          
          
          <code class="ruby">        transformation = OpenStudio::Transformation.new(m)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1678">
          
          
          <code class="ruby">        new_vertices = transformation * roof_surface.vertices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1679">
          
          
          <code class="ruby">        roof_surface.setVertices(new_vertices)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1680">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1681">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1682">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1683">
          
          
          <code class="ruby">      surfaces_modified = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1684">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1685">
          
          
          <code class="ruby">      if roof_surface.vertices.length &gt; 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1686">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1687">
          
          
          <code class="ruby">        vertex_dir_backup = roof_surface.vertices[-3]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1688">
          
          
          <code class="ruby">        vertex_dir = roof_surface.vertices[-2]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1689">
          
          
          <code class="ruby">        vertex_1 = roof_surface.vertices[-1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1691">
          
          
          <code class="ruby">        roof_surface.vertices[0..-1].each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1692">
          
          
          <code class="ruby">          vertex_2 = vertex</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1693">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1694">
          
          
          <code class="ruby">          dir_vector = OpenStudio::Vector3d.new(vertex_1.x - vertex_dir.x, vertex_1.y - vertex_dir.y, vertex_1.z - vertex_dir.z) # works if angles are right angles</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1695">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1696">
          
          
          <code class="ruby">          if (dir_vector.dot(OpenStudio::Vector3d.new(vertex_1.x - vertex_2.x, vertex_1.y - vertex_2.y, vertex_1.z - vertex_2.z))).abs &gt; 0.0001 # ensure perpendicular</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1697">
          
          
          <code class="ruby">            dir_vector = OpenStudio::Vector3d.new(0, vertex_1.y - vertex_dir.y, vertex_1.z - vertex_dir.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1698">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1699">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1700">
          
          
          <code class="ruby">          if (dir_vector.dot(OpenStudio::Vector3d.new(vertex_1.x - vertex_2.x, vertex_1.y - vertex_2.y, vertex_1.z - vertex_2.z))).abs &gt; 0.0001 # ensure perpendicular</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1701">
          
          
          <code class="ruby">            dir_vector = OpenStudio::Vector3d.new(vertex_1.x - vertex_dir.x, 0, vertex_1.z - vertex_dir.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1702">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1703">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1704">
          
          
          <code class="ruby">          if (dir_vector.dot(OpenStudio::Vector3d.new(vertex_1.x - vertex_2.x, vertex_1.y - vertex_2.y, vertex_1.z - vertex_2.z))).abs &gt; 0.0001 # ensure perpendicular</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1705">
          
          
          <code class="ruby">            dir_vector = OpenStudio::Vector3d.new(0, vertex_1.y - vertex_dir.y, vertex_1.z - vertex_dir.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1706">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1707">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1708">
          
          
          <code class="ruby">          if (dir_vector.dot(OpenStudio::Vector3d.new(vertex_1.x - vertex_2.x, vertex_1.y - vertex_2.y, vertex_1.z - vertex_2.z))).abs &gt; 0.0001 # ensure perpendicular</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1709">
          
          
          <code class="ruby">            dir_vector = OpenStudio::Vector3d.new(vertex_1.x - vertex_dir_backup.x, vertex_1.y - vertex_dir_backup.y, vertex_1.z - vertex_dir_backup.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1710">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1711">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1712">
          
          
          <code class="ruby">          dir_vector_n = OpenStudio::Vector3d.new(dir_vector.x / dir_vector.length, dir_vector.y / dir_vector.length, dir_vector.z / dir_vector.length) # normalize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1714">
          
          
          <code class="ruby">          l, w, h = self.get_surface_dimensions(roof_surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1715">
          
          
          <code class="ruby">          tilt = Math.atan(h / [l, w].min)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1716">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1717">
          
          
          <code class="ruby">          z = eaves_depth / Math.cos(tilt)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1718">
          
          
          <code class="ruby">          if dir_vector_n.z == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1719">
          
          
          <code class="ruby">            scale = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1720">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1721">
          
          
          <code class="ruby">            scale = z / eaves_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1722">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1723">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1724">
          
          
          <code class="ruby">          m = self.initialize_transformation_matrix(OpenStudio::Matrix.new(4, 4, 0))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1725">
          
          
          <code class="ruby">          m[0, 3] = dir_vector_n.x * eaves_depth * scale</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1726">
          
          
          <code class="ruby">          m[1, 3] = dir_vector_n.y * eaves_depth * scale</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1727">
          
          
          <code class="ruby">          m[2, 3] = dir_vector_n.z * eaves_depth * scale</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1728">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1729">
          
          
          <code class="ruby">          new_vertices = OpenStudio::Point3dVector.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1730">
          
          
          <code class="ruby">          new_vertices &lt;&lt; OpenStudio::Transformation.new(m) * vertex_1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1731">
          
          
          <code class="ruby">          new_vertices &lt;&lt; OpenStudio::Transformation.new(m) * vertex_2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1732">
          
          
          <code class="ruby">          new_vertices &lt;&lt; vertex_2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1733">
          
          
          <code class="ruby">          new_vertices &lt;&lt; vertex_1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1734">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1735">
          
          
          <code class="ruby">          vertex_dir_backup = vertex_dir</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1736">
          
          
          <code class="ruby">          vertex_dir = vertex_1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1737">
          
          
          <code class="ruby">          vertex_1 = vertex_2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1738">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1739">
          
          
          <code class="ruby">          next if dir_vector.length == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1740">
          
          
          <code class="ruby">          next if dir_vector_n.z &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1741">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1742">
          
          
          <code class="ruby">          if OpenStudio::getOutwardNormal(new_vertices).get.z &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1743">
          
          
          <code class="ruby">            transformation = OpenStudio::Transformation.rotation(new_vertices[2], OpenStudio::Vector3d.new(new_vertices[2].x - new_vertices[3].x, new_vertices[2].y - new_vertices[3].y, new_vertices[2].z - new_vertices[3].z), 3.14159)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1744">
          
          
          <code class="ruby">            new_vertices = transformation * new_vertices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1745">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1746">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1747">
          
          
          <code class="ruby">          m = self.initialize_transformation_matrix(OpenStudio::Matrix.new(4, 4, 0))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1748">
          
          
          <code class="ruby">          m[2, 3] = roof_surface.space.get.zOrigin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1749">
          
          
          <code class="ruby">          new_vertices = OpenStudio::Transformation.new(m) * new_vertices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1750">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1751">
          
          
          <code class="ruby">          shading_surface = OpenStudio::Model::ShadingSurface.new(new_vertices, model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1752">
          
          
          <code class="ruby">          shading_surface.setName(&quot;#{roof_surface.name} - #{Constants.ObjectNameEaves}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1753">
          
          
          <code class="ruby">          shading_surface.setShadingSurfaceGroup(shading_surface_group)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1754">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1755">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1756">
          
          
          <code class="ruby">      elsif roof_surface.vertices.length == 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1757">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1758">
          
          
          <code class="ruby">        zmin = 9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1759">
          
          
          <code class="ruby">        roof_surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1760">
          
          
          <code class="ruby">          zmin = [vertex.z, zmin].min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1761">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1762">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1763">
          
          
          <code class="ruby">        vertex_1 = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1764">
          
          
          <code class="ruby">        vertex_2 = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1765">
          
          
          <code class="ruby">        vertex_dir = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1766">
          
          
          <code class="ruby">        roof_surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1767">
          
          
          <code class="ruby">          if vertex.z == zmin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1768">
          
          
          <code class="ruby">            if vertex_1.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1769">
          
          
          <code class="ruby">              vertex_1 = vertex</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1770">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1771">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1772">
          
          
          <code class="ruby">          if vertex.z == zmin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1773">
          
          
          <code class="ruby">            vertex_2 = vertex</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1774">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1775">
          
          
          <code class="ruby">          if vertex.z != zmin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1776">
          
          
          <code class="ruby">            vertex_dir = vertex</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1777">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1778">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1779">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1780">
          
          
          <code class="ruby">        l, w, h = self.get_surface_dimensions(roof_surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1781">
          
          
          <code class="ruby">        tilt = Math.atan(h / [l, w].min)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1782">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1783">
          
          
          <code class="ruby">        z = eaves_depth / Math.cos(tilt)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1784">
          
          
          <code class="ruby">        scale = z / eaves_depth</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1785">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1786">
          
          
          <code class="ruby">        dir_vector = OpenStudio::Vector3d.new(vertex_1.x - vertex_dir.x, vertex_1.y - vertex_dir.y, vertex_1.z - vertex_dir.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1787">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1788">
          
          
          <code class="ruby">        if dir_vector.dot(OpenStudio::Vector3d.new(vertex_1.x - vertex_2.x, vertex_1.y - vertex_2.y, vertex_1.z - vertex_2.z)) != 0 # ensure perpendicular</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1789">
          
          
          <code class="ruby">          dir_vector = OpenStudio::Vector3d.new(vertex_1.x - vertex_dir.x, 0, vertex_1.z - vertex_dir.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1790">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1791">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1792">
          
          
          <code class="ruby">        if dir_vector.dot(OpenStudio::Vector3d.new(vertex_1.x - vertex_2.x, vertex_1.y - vertex_2.y, vertex_1.z - vertex_2.z)) != 0 # ensure perpendicular</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1793">
          
          
          <code class="ruby">          dir_vector = OpenStudio::Vector3d.new(0, vertex_1.y - vertex_dir.y, vertex_1.z - vertex_dir.z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1794">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1795">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1796">
          
          
          <code class="ruby">        dir_vector_n = OpenStudio::Vector3d.new(dir_vector.x / dir_vector.length, dir_vector.y / dir_vector.length, dir_vector.z / dir_vector.length) # normalize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1797">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1798">
          
          
          <code class="ruby">        m = self.initialize_transformation_matrix(OpenStudio::Matrix.new(4, 4, 0))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1799">
          
          
          <code class="ruby">        m[0, 3] = dir_vector_n.x * eaves_depth * scale</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1800">
          
          
          <code class="ruby">        m[1, 3] = dir_vector_n.y * eaves_depth * scale</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1801">
          
          
          <code class="ruby">        m[2, 3] = dir_vector_n.z * eaves_depth * scale</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1802">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1803">
          
          
          <code class="ruby">        new_vertices = OpenStudio::Point3dVector.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1804">
          
          
          <code class="ruby">        new_vertices &lt;&lt; OpenStudio::Transformation.new(m) * vertex_1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1805">
          
          
          <code class="ruby">        new_vertices &lt;&lt; OpenStudio::Transformation.new(m) * vertex_2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1806">
          
          
          <code class="ruby">        new_vertices &lt;&lt; vertex_2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1807">
          
          
          <code class="ruby">        new_vertices &lt;&lt; vertex_1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1808">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1809">
          
          
          <code class="ruby">        next if dir_vector.length == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1810">
          
          
          <code class="ruby">        next if dir_vector_n.z &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1811">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1812">
          
          
          <code class="ruby">        if OpenStudio::getOutwardNormal(new_vertices).get.z &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1813">
          
          
          <code class="ruby">          transformation = OpenStudio::Transformation.rotation(new_vertices[2], OpenStudio::Vector3d.new(new_vertices[2].x - new_vertices[3].x, new_vertices[2].y - new_vertices[3].y, new_vertices[2].z - new_vertices[3].z), 3.14159)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1814">
          
          
          <code class="ruby">          new_vertices = transformation * new_vertices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1815">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1816">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1817">
          
          
          <code class="ruby">        m = self.initialize_transformation_matrix(OpenStudio::Matrix.new(4, 4, 0))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1818">
          
          
          <code class="ruby">        m[2, 3] = roof_surface.space.get.zOrigin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1819">
          
          
          <code class="ruby">        new_vertices = OpenStudio::Transformation.new(m) * new_vertices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1820">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1821">
          
          
          <code class="ruby">        shading_surface = OpenStudio::Model::ShadingSurface.new(new_vertices, model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1822">
          
          
          <code class="ruby">        shading_surface.setName(&quot;#{roof_surface.name} - #{Constants.ObjectNameEaves}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1823">
          
          
          <code class="ruby">        shading_surface.setShadingSurfaceGroup(shading_surface_group)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1824">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1825">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1826">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1827">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1828">
          
          
          <code class="ruby">    # Remove eaves overlapping roofceiling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1829">
          
          
          <code class="ruby">    shading_surfaces_to_remove = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1830">
          
          
          <code class="ruby">    model.getShadingSurfaces.each do |shading_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1831">
          
          
          <code class="ruby">      next unless shading_surface.name.to_s.include? Constants.ObjectNameEaves</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1832">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1833">
          
          
          <code class="ruby">      new_shading_vertices = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1834">
          
          
          <code class="ruby">      shading_surface.vertices.reverse.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1835">
          
          
          <code class="ruby">        new_shading_vertices &lt;&lt; OpenStudio::Point3d.new(vertex.x, vertex.y, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1836">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1837">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1838">
          
          
          <code class="ruby">      model.getSurfaces.each do |roof_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1839">
          
          
          <code class="ruby">        next unless roof_surface.surfaceType.downcase == &quot;roofceiling&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1840">
          
          
          <code class="ruby">        next unless roof_surface.outsideBoundaryCondition.downcase == &quot;outdoors&quot; or roof_surface.outsideBoundaryCondition.downcase == &quot;adiabatic&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1841">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1842">
          
          
          <code class="ruby">        roof_surface_vertices = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1843">
          
          
          <code class="ruby">        roof_surface.vertices.reverse.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1844">
          
          
          <code class="ruby">          roof_surface_vertices &lt;&lt; OpenStudio::Point3d.new(vertex.x, vertex.y, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1845">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1846">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1847">
          
          
          <code class="ruby">        polygon = OpenStudio::subtract(roof_surface_vertices, [new_shading_vertices], 0.001)[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1848">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1849">
          
          
          <code class="ruby">        if OpenStudio::getArea(roof_surface_vertices).get - OpenStudio::getArea(polygon).get &gt; 0.001</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1850">
          
          
          <code class="ruby">          shading_surfaces_to_remove &lt;&lt; shading_surface</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1851">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1852">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1853">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1854">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1855">
          
          
          <code class="ruby">    shading_surfaces_to_remove.uniq.each do |shading_surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1856">
          
          
          <code class="ruby">      shading_surface.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1857">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1858">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1859">
          
          
          <code class="ruby">    unless surfaces_modified</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1860">
          
          
          <code class="ruby">      runner.registerInfo(&quot;No surfaces found for adding #{Constants.ObjectNameEaves}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1861">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1862">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1863">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1864">
          
          
          <code class="ruby">    num_added = shading_surface_group.shadingSurfaces.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1865">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1866">
          
          
          <code class="ruby">    runner.registerInfo(&quot;Added #{num_added} #{Constants.ObjectNameEaves}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1867">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1868">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1869">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1870">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_existing_eaves_depth(shading_surface)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1871">
          
          
          <code class="ruby">    existing_eaves_depth = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1872">
          
          
          <code class="ruby">    min_xs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1873">
          
          
          <code class="ruby">    (0..3).to_a.each do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1874">
          
          
          <code class="ruby">      if (shading_surface.vertices[0].x - shading_surface.vertices[i].x).abs &gt; existing_eaves_depth</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1875">
          
          
          <code class="ruby">        min_xs &lt;&lt; (shading_surface.vertices[0].x - shading_surface.vertices[i].x).abs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1876">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1877">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1878">
          
          
          <code class="ruby">    unless min_xs.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1879">
          
          
          <code class="ruby">      return min_xs.min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1880">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1881">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1882">
          
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1883">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1884">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1885">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_neighbors(model, runner, left_neighbor_offset, right_neighbor_offset, back_neighbor_offset, front_neighbor_offset)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1886">
          
          
          <code class="ruby">    # Error checking</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1887">
          
          
          <code class="ruby">    if left_neighbor_offset &lt; 0 or right_neighbor_offset &lt; 0 or back_neighbor_offset &lt; 0 or front_neighbor_offset &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1888">
          
          
          <code class="ruby">      runner.registerError(&quot;Neighbor offsets must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1889">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1890">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1891">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1892">
          
          
          <code class="ruby">    surfaces = model.getSurfaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1893">
          
          
          <code class="ruby">    if surfaces.size == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1894">
          
          
          <code class="ruby">      runner.registerInfo(&quot;No surfaces found to copy for neighboring buildings.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1895">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1896">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1897">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1898">
          
          
          <code class="ruby">    # Remove existing neighbors</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1899">
          
          
          <code class="ruby">    num_removed = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1900">
          
          
          <code class="ruby">    model.getShadingSurfaceGroups.each do |shading_surface_group|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1901">
          
          
          <code class="ruby">      next unless shading_surface_group.name.to_s == Constants.ObjectNameNeighbors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1902">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1903">
          
          
          <code class="ruby">      shading_surface_group.remove</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1904">
          
          
          <code class="ruby">      num_removed += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1905">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1906">
          
          
          <code class="ruby">    if num_removed &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1907">
          
          
          <code class="ruby">      runner.registerInfo(&quot;Removed #{num_removed} #{Constants.ObjectNameNeighbors} shading surfaces.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1908">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1909">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1910">
          
          
          <code class="ruby">    # No neighbor shading surfaces to add? Exit here.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1911">
          
          
          <code class="ruby">    if [left_neighbor_offset, right_neighbor_offset, back_neighbor_offset, front_neighbor_offset].all? { |offset| offset == 0 }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1912">
          
          
          <code class="ruby">      runner.registerInfo(&quot;No #{Constants.ObjectNameNeighbors} shading surfaces to be added.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1913">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1914">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1915">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1916">
          
          
          <code class="ruby">    # Get x, y, z minima and maxima of wall surfaces</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1917">
          
          
          <code class="ruby">    least_x = 9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1918">
          
          
          <code class="ruby">    greatest_x = -9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1919">
          
          
          <code class="ruby">    least_y = 9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1920">
          
          
          <code class="ruby">    greatest_y = -9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1921">
          
          
          <code class="ruby">    greatest_z = -9e99</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1922">
          
          
          <code class="ruby">    surfaces.each do |surface|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1923">
          
          
          <code class="ruby">      next unless surface.surfaceType.downcase == &quot;wall&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1924">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1925">
          
          
          <code class="ruby">      space = surface.space.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1926">
          
          
          <code class="ruby">      surface.vertices.each do |vertex|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1927">
          
          
          <code class="ruby">        if vertex.x &gt; greatest_x</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1928">
          
          
          <code class="ruby">          greatest_x = vertex.x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1929">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1930">
          
          
          <code class="ruby">        if vertex.x &lt; least_x</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1931">
          
          
          <code class="ruby">          least_x = vertex.x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1932">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1933">
          
          
          <code class="ruby">        if vertex.y &gt; greatest_y</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1934">
          
          
          <code class="ruby">          greatest_y = vertex.y</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1935">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1936">
          
          
          <code class="ruby">        if vertex.y &lt; least_y</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1937">
          
          
          <code class="ruby">          least_y = vertex.y</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1938">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1939">
          
          
          <code class="ruby">        if vertex.z + space.zOrigin &gt; greatest_z</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1940">
          
          
          <code class="ruby">          greatest_z = vertex.z + space.zOrigin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1941">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1942">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1943">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1944">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1945">
          
          
          <code class="ruby">    directions = [[Constants.FacadeLeft, left_neighbor_offset], [Constants.FacadeRight, right_neighbor_offset], [Constants.FacadeBack, back_neighbor_offset], [Constants.FacadeFront, front_neighbor_offset]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1946">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1947">
          
          
          <code class="ruby">    shading_surface_group = OpenStudio::Model::ShadingSurfaceGroup.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1948">
          
          
          <code class="ruby">    shading_surface_group.setName(Constants.ObjectNameNeighbors)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1949">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1950">
          
          
          <code class="ruby">    num_added = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1951">
          
          
          <code class="ruby">    directions.each do |facade, neighbor_offset|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1952">
          
          
          <code class="ruby">      next unless neighbor_offset &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1953">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1954">
          
          
          <code class="ruby">      vertices = OpenStudio::Point3dVector.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1955">
          
          
          <code class="ruby">      m = Geometry.initialize_transformation_matrix(OpenStudio::Matrix.new(4, 4, 0))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1956">
          
          
          <code class="ruby">      transformation = OpenStudio::Transformation.new(m)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1957">
          
          
          <code class="ruby">      if facade == Constants.FacadeLeft</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1958">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x - neighbor_offset, least_y, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1959">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x - neighbor_offset, least_y, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1960">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x - neighbor_offset, greatest_y, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1961">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x - neighbor_offset, greatest_y, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1962">
          
          
          <code class="ruby">      elsif facade == Constants.FacadeRight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1963">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x + neighbor_offset, greatest_y, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1964">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x + neighbor_offset, greatest_y, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1965">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x + neighbor_offset, least_y, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1966">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x + neighbor_offset, least_y, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1967">
          
          
          <code class="ruby">      elsif facade == Constants.FacadeFront</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1968">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x, least_y - neighbor_offset, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1969">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x, least_y - neighbor_offset, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1970">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x, least_y - neighbor_offset, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1971">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x, least_y - neighbor_offset, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1972">
          
          
          <code class="ruby">      elsif facade == Constants.FacadeBack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1973">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x, greatest_y + neighbor_offset, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1974">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(least_x, greatest_y + neighbor_offset, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1975">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x, greatest_y + neighbor_offset, greatest_z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1976">
          
          
          <code class="ruby">        vertices &lt;&lt; OpenStudio::Point3d.new(greatest_x, greatest_y + neighbor_offset, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1977">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1978">
          
          
          <code class="ruby">      vertices = transformation * vertices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1979">
          
          
          <code class="ruby">      shading_surface = OpenStudio::Model::ShadingSurface.new(vertices, model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1980">
          
          
          <code class="ruby">      shading_surface.setName(Constants.ObjectNameNeighbors(facade))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1981">
          
          
          <code class="ruby">      shading_surface.setShadingSurfaceGroup(shading_surface_group)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1982">
          
          
          <code class="ruby">      num_added += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1983">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1984">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1985">
          
          
          <code class="ruby">    runner.registerInfo(&quot;Added #{num_added} #{Constants.ObjectNameNeighbors} shading surfaces.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1986">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1987">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1988">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1989">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_orientation(model, runner, orientation)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1990">
          
          
          <code class="ruby">    if orientation &gt; 360 or orientation &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1991">
          
          
          <code class="ruby">      runner.registerError(&quot;Invalid orientation entered.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1992">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1993">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1994">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1995">
          
          
          <code class="ruby">    building = model.getBuilding</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1996">
          
          
          <code class="ruby">    unless building.northAxis == orientation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1997">
          
          
          <code class="ruby">      runner.registerInfo(&quot;The building&#39;s initial orientation was #{building.northAxis} azimuth.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1998">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1999">
          
          
          <code class="ruby">    building.setNorthAxis(orientation) # the shading surfaces representing neighbors have ShadingSurfaceType=Building, and so are oriented along with the building</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2000">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2001">
          
          
          <code class="ruby">    runner.registerInfo(&quot;The building&#39;s final orientation was #{building.northAxis} azimuth.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2002">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2003">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2004">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="612e7db5149b5b3c1dcde194505c8c6038e5cc49">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/materials.rb</h3>
    <h4><span class="red">40.89 %</span> covered</h4>
    <div>
      <b>269</b> relevant lines. 
      <span class="green"><b>110</b> lines covered</span> and
      <span class="red"><b>159</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;constants&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class Material</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # thick_in - Thickness [in]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # mat_base - Material object that defines k, rho, and cp. Can be overridden with values for those arguments.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # k_in - Conductivity [Btu-in/h-ft^2-F]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # rho - Density [lb/ft^3]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # cp - Specific heat [Btu/lb*F]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # rvalue - R-value [h-ft^2-F/Btu]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name = nil, thick_in = nil, mat_base = nil, k_in = nil, rho = nil, cp = nil, tAbs = nil, sAbs = nil, vAbs = nil, rvalue = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    if not thick_in.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      @thick_in = thick_in # in</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      @thick = UnitConversions.convert(thick_in, &quot;in&quot;, &quot;ft&quot;) # ft</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    if not mat_base.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      @k_in = mat_base.k_in # Btu-in/h-ft^2-F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      if not mat_base.k_in.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        @k = UnitConversions.convert(mat_base.k_in, &quot;in&quot;, &quot;ft&quot;) # Btu/h-ft-F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">        @k = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      @rho = mat_base.rho</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      @cp = mat_base.cp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">      @k_in = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">      @k = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      @rho = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      @cp = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    # Override the base material if both are included</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    if not k_in.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      @k_in = k_in # Btu-in/h-ft^2-F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      @k = UnitConversions.convert(k_in, &quot;in&quot;, &quot;ft&quot;) # Btu/h-ft-F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    if not rho.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      @rho = rho # lb/ft^3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    if not cp.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      @cp = cp # Btu/lb*F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    @tAbs = tAbs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    @sAbs = sAbs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    @vAbs = vAbs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    # Calculate R-value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    if not rvalue.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      @rvalue = rvalue # h-ft^2-F/Btu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    elsif not @thick_in.nil? and not @k_in.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      if @k_in &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">        @rvalue = @thick_in / @k_in # h-ft^2-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">        @rvalue = @thick_in / 10000000.0 # h-ft^2-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :name, :thick, :thick_in, :k, :k_in, :rho, :cp, :rvalue, :tAbs, :sAbs, :vAbs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirCavityClosed(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    rvalue = Gas.AirGapRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    return self.new(name = nil, thick_in = thick_in, mat_base = nil, k_in = thick_in / rvalue, rho = Gas.Air.rho, cp = Gas.Air.cp)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirCavityOpen(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    return self.new(name = nil, thick_in = thick_in, mat_base = nil, k_in = 10000000.0, rho = Gas.Air.rho, cp = Gas.Air.cp)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmOutside</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    rvalue = 0.197 # hr-ft-F/Btu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmVertical</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    rvalue = 0.68 # hr-ft-F/Btu (ASHRAE 2005, F25.2, Table 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmFlatEnhanced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    rvalue = 0.61 # hr-ft-F/Btu (ASHRAE 2005, F25.2, Table 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmFlatReduced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    rvalue = 0.92 # hr-ft-F/Btu (ASHRAE 2005, F25.2, Table 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmFloorAverage</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    # For floors between conditioned spaces where heat does not flow across</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    # the floor; heat transfer is only important with regards to the thermal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    rvalue = (self.AirFilmFlatReduced.rvalue + self.AirFilmFlatEnhanced.rvalue) / 2.0 # hr-ft-F/Btu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmFloorReduced</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    # For floors above unconditioned basement spaces, where heat will</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    # always flow down through the floor.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    rvalue = self.AirFilmFlatReduced.rvalue # hr-ft-F/Btu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmSlopeEnhanced(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for non-reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">    # emissivity = 0.90.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">    rvalue = 0.002 * Math::exp(0.0398 * roof_pitch) + 0.608 # hr-ft-F/Btu (evaluates to film_flat_enhanced at 0 degrees, 0.62 at 45 degrees, and film_vertical at 90 degrees)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmSlopeReduced(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for non-reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    # emissivity = 0.90.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    rvalue = 0.32 * Math::exp(-0.0154 * roof_pitch) + 0.6 # hr-ft-F/Btu (evaluates to film_flat_reduced at 0 degrees, 0.76 at 45 degrees, and film_vertical at 90 degrees)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmSlopeEnhancedReflective(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    # emissivity = 0.05.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">    rvalue = 0.00893 * Math::exp(0.0419 * roof_pitch) + 1.311 # hr-ft-F/Btu (evaluates to 1.32 at 0 degrees, 1.37 at 45 degrees, and 1.70 at 90 degrees)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmSlopeReducedReflective(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">    # emissivity = 0.05.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">    rvalue = 2.999 * Math::exp(-0.0333 * roof_pitch) + 1.551 # hr-ft-F/Btu (evaluates to 4.55 at 0 degrees, 2.22 at 45 degrees, and 1.70 at 90 degrees)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmRoof(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    # Use weighted average between enhanced and reduced convection based on degree days.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">    # hdd_frac = hdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">    # cdd_frac = cdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">    # return self.AirFilmSlopeEnhanced(roof_pitch).rvalue * hdd_frac + self.AirFilmSlopeReduced(roof_pitch).rvalue * cdd_frac # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    # Simplification to not depend on weather</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">    rvalue = (self.AirFilmSlopeEnhanced(roof_pitch).rvalue + self.AirFilmSlopeReduced(roof_pitch).rvalue) / 2.0 # hr-ft-F/Btu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirFilmRoofRadiantBarrier(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">    # Use weighted average between enhanced and reduced convection based on degree days.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">    # hdd_frac = hdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">    # cdd_frac = cdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">    # return self.AirFilmSlopeEnhancedReflective(roof_pitch).rvalue * hdd_frac + self.AirFilmSlopeReducedReflective(roof_pitch).rvalue * cdd_frac # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">    # Simplification to not depend on weather</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">    rvalue = (self.AirFilmSlopeEnhancedReflective(roof_pitch).rvalue + self.AirFilmSlopeReducedReflective(roof_pitch).rvalue) / 2.0 # hr-ft-F/Btu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">    return self.new(name = Constants.AirFilm, thick_in = 1.0, mat_base = nil, k_in = 1.0 / rvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="164">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CoveringBare(floorFraction = 0.8, rvalue = 2.08)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    # Combined layer of, e.g., carpet and bare floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">    thickness = 0.5 # in</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">    return self.new(name = &quot;Floor Covering&quot;, thick_in = thickness, mat_base = nil, k_in = thickness / (rvalue * floorFraction), rho = 3.4, cp = 0.32, tAbs = 0.9, sAbs = 0.9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="170">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Concrete(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">    return self.new(name = &quot;Concrete #{thick_in} in.&quot;, thick_in = thick_in, mat_base = BaseMaterial.Concrete, k_in = nil, rho = nil, cp = nil, tAbs = 0.9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishStuccoMedDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">    return self.new(name = &quot;Stucco, Medium/Dark&quot;, thick_in = 1.0, mat_base = BaseMaterial.Stucco, k_in = nil, rho = nil, cp = nil, tAbs = 0.9, sAbs = 0.75, vAbs = 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishBrickLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">    return self.new(name = &quot;Brick, Light&quot;, thick_in = 4.0, mat_base = BaseMaterial.Brick, k_in = nil, rho = nil, cp = nil, tAbs = 0.93, sAbs = 0.55, vAbs = 0.55)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="182">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishBrickMedDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">    return self.new(name = &quot;Brick, Medium/Dark&quot;, thick_in = 4.0, mat_base = BaseMaterial.Brick, k_in = nil, rho = nil, cp = nil, tAbs = 0.96, sAbs = 0.88, vAbs = 0.88)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="186">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishWoodLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">    return self.new(name = &quot;Wood, Light&quot;, thick_in = 1.0, mat_base = nil, k_in = 0.71, rho = 34.0, cp = 0.28, tAbs = 0.82, sAbs = 0.3, vAbs = 0.3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="190">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishWoodMedDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">    return self.new(name = &quot;Wood, Medium/Dark&quot;, thick_in = 1.0, mat_base = nil, k_in = 0.71, rho = 34.0, cp = 0.28, tAbs = 0.92, sAbs = 0.75, vAbs = 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishAluminumLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">    return self.new(name = &quot;Aluminum, Light&quot;, thick_in = 0.375, mat_base = BaseMaterial.Aluminum, k_in = nil, rho = nil, cp = nil, tAbs = 0.9, sAbs = 0.3, vAbs = 0.3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="198">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishAluminumMedDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">    return self.new(name = &quot;Aluminum, Medium/Dark&quot;, thick_in = 0.375, mat_base = BaseMaterial.Aluminum, k_in = nil, rho = nil, cp = nil, tAbs = 0.94, sAbs = 0.75, vAbs = 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="202">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishVinylLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">    return self.new(name = &quot;Vinyl, Light&quot;, thick_in = 0.375, mat_base = BaseMaterial.Vinyl, k_in = nil, rho = nil, cp = nil, tAbs = 0.9, sAbs = 0.3, vAbs = 0.3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="206">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishVinylMedDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">    return self.new(name = &quot;Vinyl, Medium/Dark&quot;, thick_in = 0.375, mat_base = BaseMaterial.Vinyl, k_in = nil, rho = nil, cp = nil, tAbs = 0.9, sAbs = 0.75, vAbs = 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="210">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishFiberCementLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">    return self.new(name = &quot;Fiber-Cement, Light&quot;, thick_in = 0.375, mat_base = nil, k_in = 1.79, rho = 21.7, cp = 0.24, tAbs = 0.9, sAbs = 0.3, vAbs = 0.3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="214">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ExtFinishFiberCementMedDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">    return self.new(name = &quot;Fiber-Cement, Medium/Dark&quot;, thick_in = 0.375, mat_base = nil, k_in = 1.79, rho = 21.7, cp = 0.24, tAbs = 0.9, sAbs = 0.75, vAbs = 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FloorWood</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">    return Material.new(name = &quot;Wood Floor&quot;, thick_in = 0.625, mat_base = nil, k_in = 0.8004, rho = 34.0, cp = 0.29)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.GypsumWall(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">    return self.new(name = &quot;Drywall #{thick_in.to_s} in.&quot;, thick_in = thick_in, mat_base = BaseMaterial.Gypsum, k_in = nil, rho = nil, cp = nil, tAbs = 0.9, sAbs = 0.5, vAbs = 0.1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.GypsumCeiling(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">    return self.new(name = &quot;Drywall #{thick_in.to_s} in.&quot;, thick_in = thick_in, mat_base = BaseMaterial.Gypsum, k_in = nil, rho = nil, cp = nil, tAbs = 0.9, sAbs = 0.3, vAbs = 0.1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingAsphaltShinglesDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Asphalt Shingles, Dark&quot;, 0.91, 0.92)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingAsphaltShinglesMed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Asphalt Shingles, Medium&quot;, 0.91, 0.85)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingAsphaltShinglesLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Asphalt Shingles, Light&quot;, 0.91, 0.8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingAsphaltShinglesWhiteCool</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Asphalt Shingles, White or Cool Colors&quot;, 0.91, 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="246">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingTileDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Tile, Dark&quot;, 0.94, 0.9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="250">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingTileMed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Tile, Medium&quot;, 0.94, 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="254">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingTileLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Tile, Light&quot;, 0.93, 0.6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="258">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingTileWhite</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Tile, White&quot;, 0.93, 0.3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingMetalDark</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="263">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Metal, Dark&quot;, 0.9, 0.9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="266">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingMetalMed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Metal, Medium&quot;, 0.9, 0.75)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingMetalLight</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Metal, Light&quot;, 0.88, 0.6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingMetalWhite</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Metal, White&quot;, 0.88, 0.3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofingGalvanizedSteel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">    return self.RoofMaterial(&quot;Galvanized Steel&quot;, 0.88, 0.7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Soil(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">    return self.new(name = &quot;Soil #{thick_in} in.&quot;, thick_in = thick_in, mat_base = BaseMaterial.Soil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="286">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Stud2x(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">    return self.new(name = &quot;Stud 2x #{thick_in.to_s} in.&quot;, thick_in = thick_in, mat_base = BaseMaterial.Wood)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="290">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Stud2x4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">    return self.new(name = &quot;Stud 2x4&quot;, thick_in = 3.5, mat_base = BaseMaterial.Wood)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="294">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Stud2x6</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">    return self.new(name = &quot;Stud 2x6&quot;, thick_in = 5.5, mat_base = BaseMaterial.Wood)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="298">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Stud2x8</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">    return self.new(name = &quot;Stud 2x8&quot;, thick_in = 7.25, mat_base = BaseMaterial.Wood)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="302">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Plywood(thick_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">    return self.new(name = &quot;Plywood #{thick_in.to_s} in.&quot;, thick_in = thick_in, mat_base = BaseMaterial.Wood)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="306">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RadiantBarrier</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">    return self.new(name = &quot;Radiant Barrier&quot;, thick_in = 0.0084, mat_base = nil, k_in = 1629.6, rho = 168.6, cp = 0.22, tAbs = 0.05, sAbs = 0.05, vAbs = 0.05)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="310">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofMaterial(name, emissivity, absorptivity)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">    return self.new(name = name, thick_in = 0.375, mat_base = nil, k_in = 1.128, rho = 70, cp = 0.35, tAbs = emissivity, sAbs = absorptivity, vAbs = absorptivity)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="315">
          <span class="hits">1</span>
          
          <code class="ruby">class BaseMaterial</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="316">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(rho, cp, k_in)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">    @rho = rho</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">    @cp = cp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">    @k_in = k_in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="322">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :rho, :cp, :k_in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="324">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Gypsum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">    return self.new(rho = 50.0, cp = 0.2, k_in = 1.1112)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="328">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Wood</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">    return self.new(rho = 32.0, cp = 0.29, k_in = 0.8004)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="332">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Concrete</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    return self.new(rho = 140.0, cp = 0.2, k_in = 12.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="336">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Gypcrete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">    # http://www.maxxon.com/gyp-crete/data</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    return self.new(rho = 100.0, cp = 0.223, k_in = 4.7424)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="341">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationRigid</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    return self.new(rho = 2.0, cp = 0.29, k_in = 0.204)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="345">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationCelluloseDensepack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    return self.new(rho = 3.5, cp = 0.25, k_in = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="349">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationCelluloseLoosefill</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">    return self.new(rho = 1.5, cp = 0.25, k_in = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="353">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationFiberglassDensepack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">    return self.new(rho = 2.2, cp = 0.25, k_in = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="357">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationFiberglassLoosefill</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">    return self.new(rho = 0.5, cp = 0.25, k_in = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="361">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationGenericDensepack</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="362">
          
          
          <code class="ruby">    return self.new(rho = (self.InsulationFiberglassDensepack.rho + self.InsulationCelluloseDensepack.rho) / 2.0, cp = 0.25, k_in = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="365">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.InsulationGenericLoosefill</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">    return self.new(rho = (self.InsulationFiberglassLoosefill.rho + self.InsulationCelluloseLoosefill.rho) / 2.0, cp = 0.25, k_in = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="369">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Soil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="370">
          
          
          <code class="ruby">    return self.new(rho = 115.0, cp = 0.1, k_in = 12.0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="373">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Brick</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="374">
          
          
          <code class="ruby">    return self.new(rho = 110.0, cp = 0.19, k_in = 5.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="377">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Vinyl</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">    return self.new(rho = 11.1, cp = 0.25, k_in = 0.62)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="381">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Aluminum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">    return self.new(rho = 10.9, cp = 0.29, k_in = 0.61)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="385">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Stucco</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">    return self.new(rho = 80.0, cp = 0.21, k_in = 4.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="388">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="389">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Stone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="390">
          
          
          <code class="ruby">    return self.new(rho = 140.0, cp = 0.2, k_in = 12.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="393">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.StrawBale</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">    return self.new(rho = 11.1652, cp = 0.2991, k_in = 0.4164)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="398">
          <span class="hits">1</span>
          
          <code class="ruby">class SimpleMaterial</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="399">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name = nil, rvalue = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">    @rvalue = rvalue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="404">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :name, :rvalue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="406">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Adiabatic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="407">
          
          
          <code class="ruby">    return self.new(name = &quot;Adiabatic&quot;, rvalue = 1000)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="411">
          <span class="hits">1</span>
          
          <code class="ruby">class GlazingMaterial</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="412">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(name = nil, ufactor = nil, shgc = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">    @name = name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="414">
          
          
          <code class="ruby">    @ufactor = ufactor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="415">
          
          
          <code class="ruby">    @shgc = shgc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="418">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :name, :ufactor, :shgc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="421">
          <span class="hits">1</span>
          
          <code class="ruby">class Liquid</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="422">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(rho, cp, k, mu, h_fg, t_frz, t_boil, t_crit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="423">
          
          
          <code class="ruby">    @rho = rho # Density (lb/ft3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">    @cp     = cp        # Specific Heat (Btu/lbm-R)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">    @k      = k         # Thermal Conductivity (Btu/h-ft-R)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">    @mu     = mu        # Dynamic Viscosity (lbm/ft-h)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="427">
          
          
          <code class="ruby">    @h_fg   = h_fg      # Latent Heat of Vaporization (Btu/lbm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="428">
          
          
          <code class="ruby">    @t_frz  = t_frz     # Freezing Temperature (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="429">
          
          
          <code class="ruby">    @t_boil = t_boil    # Boiling Temperature (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    @t_crit = t_crit    # Critical Temperature (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="433">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :rho, :cp, :k, :mu, :h_fg, :t_frz, :t_boil, :t_crit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="435">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.H2O_l</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">    # From EES at STP</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="437">
          
          
          <code class="ruby">    return self.new(62.32, 0.9991, 0.3386, 2.424, 1055, 32.0, 212.0, nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="440">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.R22_l</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">    # Converted from EnthDR22 f77 in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">    return self.new(nil, 0.2732, nil, nil, 100.5, nil, -41.35, 204.9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="446">
          <span class="hits">1</span>
          
          <code class="ruby">class Gas</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="447">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(rho, cp, k, mu, m)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">    @rho = rho # Density (lb/ft3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    @cp     = cp            # Specific Heat (Btu/lbm-R)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">    @k      = k             # Thermal Conductivity (Btu/h-ft-R)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">    @mu     = mu            # Dynamic Viscosity (lbm/ft-h)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">    @m      = m             # Molecular Weight (lbm/lbmol)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="453">
          
          
          <code class="ruby">    if @m</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">      gas_constant = 1.9858 # Gas Constant (Btu/lbmol-R)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">      @r = gas_constant / m # Gas Constant (Btu/lbm-R)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="457">
          
          
          <code class="ruby">      @r = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="460">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="461">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :rho, :cp, :k, :mu, :m, :r</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="463">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Air</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby">    # From EES at STP</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="465">
          
          
          <code class="ruby">    return self.new(0.07518, 0.2399, 0.01452, 0.04415, 28.97)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="468">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.AirGapRvalue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="469">
          
          
          <code class="ruby">    return 1.0 # hr*ft*F/Btu (Assume for all air gap configurations since there is no correction for direction of heat flow in the simulation tools)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="472">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.H2O_v</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="473">
          
          
          <code class="ruby">    # From EES at STP</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="474">
          
          
          <code class="ruby">    return self.new(nil, 0.4495, nil, nil, 18.02)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="475">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="477">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.R22_v</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">    # Converted from EnthDR22 f77 in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="479">
          
          
          <code class="ruby">    return self.new(nil, 0.1697, nil, nil, nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="480">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="482">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.PsychMassRat</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="483">
          
          
          <code class="ruby">    return self.H2O_v.m / self.Air.m</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="487">
          <span class="hits">1</span>
          
          <code class="ruby">class AirFilms</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="488">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.OutsideR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    return 0.197 # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="492">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.VerticalR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">    return 0.68 # hr-ft-F/Btu (ASHRAE 2005, F25.2, Table 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="496">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FlatEnhancedR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="497">
          
          
          <code class="ruby">    return 0.61 # hr-ft-F/Btu (ASHRAE 2005, F25.2, Table 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="500">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FlatReducedR</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="501">
          
          
          <code class="ruby">    return 0.92 # hr-ft-F/Btu (ASHRAE 2005, F25.2, Table 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="504">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FloorAverageR</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="505">
          
          
          <code class="ruby">    # For floors between conditioned spaces where heat does not flow across</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby">    # the floor; heat transfer is only important with regards to the thermal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="507">
          
          
          <code class="ruby">    return (self.FlatReducedR + self.FlatEnhancedR) / 2.0 # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="510">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.FloorReducedR</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="511">
          
          
          <code class="ruby">    # For floors above unconditioned basement spaces, where heat will</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">    # always flow down through the floor.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="513">
          
          
          <code class="ruby">    return self.FlatReducedR # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="516">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SlopeEnhancedR(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="517">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="518">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for non-reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby">    # emissivity = 0.90.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="521">
          
          
          <code class="ruby">    return 0.002 * Math::exp(0.0398 * roof_pitch) + 0.608 # hr-ft-F/Btu (evaluates to film_flat_enhanced at 0 degrees, 0.62 at 45 degrees, and film_vertical at 90 degrees)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="524">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SlopeReducedR(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="525">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for non-reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">    # emissivity = 0.90.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">    return 0.32 * Math::exp(-0.0154 * roof_pitch) + 0.6 # hr-ft-F/Btu (evaluates to film_flat_reduced at 0 degrees, 0.76 at 45 degrees, and film_vertical at 90 degrees)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="530">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="532">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SlopeEnhancedReflectiveR(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="534">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">    # emissivity = 0.05.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="537">
          
          
          <code class="ruby">    return 0.00893 * Math::exp(0.0419 * roof_pitch) + 1.311 # hr-ft-F/Btu (evaluates to 1.32 at 0 degrees, 1.37 at 45 degrees, and 1.70 at 90 degrees)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="540">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.SlopeReducedReflectiveR(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">    # Correlation functions used to interpolate between values provided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="542">
          
          
          <code class="ruby">    # in ASHRAE 2005, F25.2, Table 1 - which only provides values for</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby">    # 0, 45, and 90 degrees. Values are for reflective materials of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby">    # emissivity = 0.05.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    return 2.999 * Math::exp(-0.0333 * roof_pitch) + 1.551 # hr-ft-F/Btu (evaluates to 4.55 at 0 degrees, 2.22 at 45 degrees, and 1.70 at 90 degrees)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="548">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofR(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby">    # Use weighted average between enhanced and reduced convection based on degree days.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby">    # hdd_frac = hdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby">    # cdd_frac = cdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">    # return self.SlopeEnhancedR(roof_pitch) * hdd_frac + self.SlopeReducedR(roof_pitch) * cdd_frac # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">    # Simplification to not depend on weather</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="554">
          
          
          <code class="ruby">    return (self.SlopeEnhancedR(roof_pitch) + self.SlopeReducedR(roof_pitch)) / 2.0 # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="557">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.RoofRadiantBarrierR(roof_pitch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby">    # Use weighted average between enhanced and reduced convection based on degree days.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby">    # hdd_frac = hdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">    # cdd_frac = cdd65f / (hdd65f + cdd65f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">    # return self.SlopeEnhancedReflectiveR(roof_pitch) * hdd_frac + self.SlopeReducedReflectiveR(roof_pitch) * cdd_frac # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">    # Simplification to not depend on weather</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="563">
          
          
          <code class="ruby">    return (self.SlopeEnhancedReflectiveR(roof_pitch) + self.SlopeReducedReflectiveR(roof_pitch)) / 2.0 # hr-ft-F/Btu</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="23e66f8ac7cb169893785d2f9f0b43d4f3ef9d09">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/psychrometrics.rb</h3>
    <h4><span class="red">12.35 %</span> covered</h4>
    <div>
      <b>243</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>213</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;constants&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;materials&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;util&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">class Psychrometrics</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.H_fg_fT(t)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">        Calculate the latent heat of vaporization at a given drybulb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">        temperature.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">        Valid for temperatures between 0 and 200 degC (32 - 392 degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">        Based on correlation from steam tables - &quot;Introduction to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">        Thermodynamics, Classical and Statistical&quot; by Sonntag and Wylen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">        H_fg = 2518600 - 2757.1*T (J/kg with T in degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">             = 2581600 - 2757.1*(T - 32)*5/9 (J/kg with T in degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">             = 2581600 - 1531.72*T + 49015.1 (J/kg with T in degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">             = 1083 - 0.6585*T + 21.07 (Btu/lbm with T in degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">        T       float      temperature         (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">        H_fg    float      latent heat of vaporization (Btu/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    h_fg = 1083 - 0.6585 * t + 21.07</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    return h_fg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Psat_fT(tdb)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">        Calculate the saturation pressure of water vapor at a given temperature</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature      (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">        Psat    float      saturated vapor pressure (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    c1 = -1.0214165e4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    c2 = -4.8932428</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    c3 = -5.3765794e-3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    c4 = 1.9202377e-7</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    c5 = 3.5575832e-10</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    c6 = -9.0344688e-14</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    c7 = 4.1635019</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    c8 = -1.0440397e4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    c9 = -1.1294650e1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    c10 = -2.7022355e-2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    c11 = 1.2890360e-5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    c12 = -2.4780681e-9</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    c13 = 6.5459673</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    t_abs = UnitConversions.convert(tdb, &quot;F&quot;, &quot;R&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    t_frz_abs = UnitConversions.convert(Liquid.H2O_l.t_frz, &quot;F&quot;, &quot;R&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    if t_abs &lt; t_frz_abs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      # If below freezing, calculate saturation pressure over ice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      psat = Math.exp(c1 / t_abs + c2 + t_abs * (c3 + t_abs * (c4 + t_abs * (c5 + c6 * t_abs))) + c7 * Math.log(t_abs))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      # If above freezing, calculate saturation pressure over liquid water</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      psat = Math.exp(c8 / t_abs + c9 + t_abs * (c10 + t_abs * (c11 + c12 * t_abs)) + c13 * Math.log(t_abs))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    return psat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Tsat_fP(p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">        Calculate the saturation temperature of water vapor at a given pressure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">        P       float      pressure                    (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">        Tsat    float      saturated vapor temperature (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    # Initialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    tsat = 212.0 # (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    tsat1 = tsat # (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    tsat2 = tsat # (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    error = p - self.Psat_fT(tsat) # (psia)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    error1 = error # (psia)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    error2 = error # (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    itmax = 50 # maximum iterations</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">    cvg = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">    for i in 1..itmax</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      error = p - self.Psat_fT(tsat) # (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">      tsat, cvg, tsat1, error1, tsat2, error2 = MathTools.Iterate(tsat, error, tsat1, error1, tsat2, error2, i, cvg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">      if cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">    if not cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">      puts &#39;Warning: Tsat_fP failed to converge&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">    return tsat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Tsat_fh_P(h, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">        Calculate the drybulb temperature at saturation a given enthalpy and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">        pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">        Based on TAIRSAT f77 code in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">        h       float      enathalpy           (Btu/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">        P       float      pressure            (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">    # Initialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    tdb = 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    tdb1 = tdb # (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">    tdb2 = tdb # (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">    error = h - self.hsat_fT_P(tdb, p) # (Btu/lbm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">    error1 = error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">    error2 = error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">    itmax = 50 # maximum iterations</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">    cvg = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">    for i in 1..itmax</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      error = h - self.hsat_fT_P(tdb, p) # (Btu/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">      tdb, cvg, tdb1, error1, tdb2, error2 = MathTools.Iterate(tdb, error, tdb1, error1, tdb2, error2, i, cvg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      if cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">    if not cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">      puts &#39;Warning: Tsat_fh_P failed to converge&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">    return tdb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="184">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.rhoD_fT_w_P(tdb, w, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">        Calculate the density of dry air at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">        humidity ratio and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">        rhoD    float      density of dry air    (lbm/ft3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">    pair = Gas.PsychMassRat * p / (Gas.PsychMassRat + w) # (psia)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">    rhoD = UnitConversions.convert(pair, &quot;psi&quot;, &quot;Btu/ft^3&quot;) / Gas.Air.r / (UnitConversions.convert(tdb, &quot;F&quot;, &quot;R&quot;)) # (lbm/ft3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">    return rhoD</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="211">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.h_fT_w_SI(tdb, w)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">        Calculate the enthalpy at a given drybulb temperature</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">        and humidity ratio.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">        w       float      humidity ratio        (kg/kg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">        h       float      enthalpy              (J/kg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">    h = 1000.0 * (1.006 * tdb + w * (2501.0 + 1.86 * tdb))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">    return h</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.w_fT_h_SI(tdb, h)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">        Calculate the humidity ratio at a given drybulb temperature</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">        and enthalpy.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature  (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">        h       float      enthalpy              (J/kg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">        w       float      humidity ratio        (kg/kg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">    w = (h / 1000.0 - 1.006 * tdb) / (2501.0 + 1.86 * tdb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">    return w</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="259">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Pstd_fZ(z)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">        Calculate standard pressure of air at a given altitude</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">        Z        float        altitude     (feet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">        Pstd    float        barometric pressure (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">    pstd = 14.696 * ((1 - 6.8754e-6 * z)**5.2559)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">    return pstd</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Twb_fT_w_P(tdb, w, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">        Calculate the wetbulb temperature at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">        humidity ratio, and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">        Based on WETBULB f77 code in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">        Converted into IP units</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">        w       float      humidity ratio      (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">        P       float      pressure            (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">        Twb     float      wetbulb temperature (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">    # Initialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">    tboil = self.Tsat_fP(p) # (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">    twb = [[tdb, tboil - 0.1].min, 0.0].max # (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">    twb1 = twb # (degF)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">    twb2 = twb # (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">    psat_star = self.Psat_fT(twb) # (psia)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">    w_star = self.w_fP(p, psat_star) # (lbm/lbm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">    w_new = ((Liquid.H2O_l.h_fg - (Liquid.H2O_l.cp - Gas.H2O_v.cp) * twb) * w_star - Gas.Air.cp * (tdb - twb)) / (Liquid.H2O_l.h_fg + Gas.H2O_v.cp * tdb - Liquid.H2O_l.cp * twb) # (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">    error = w - w_new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">    error1 = error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">    error2 = error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">    itmax = 50 # maximum iterations</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">    cvg = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">    for i in 1..itmax</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">      psat_star = self.Psat_fT(twb) # (psia)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">      w_star = self.w_fP(p, psat_star) # (lbm/lbm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">      w_new = ((Liquid.H2O_l.h_fg - (Liquid.H2O_l.cp - Gas.H2O_v.cp) * twb) * w_star - Gas.Air.cp * (tdb - twb)) / (Liquid.H2O_l.h_fg + Gas.H2O_v.cp * tdb - Liquid.H2O_l.cp * twb) # (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">      error = w - w_new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">      twb, cvg, twb1, error1, twb2, error2 = MathTools.Iterate(twb, error, twb1, error1, twb2, error2, i, cvg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">      if cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    if not cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">      puts &#39;Warning: Twb_fT_w_P failed to converge&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    if twb &gt; tdb</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">      twb = tdb # (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    return twb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="349">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.w_fP(p, pw)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">        Calculate the humidity ratio at a given pressure and partial pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">        Based on HUMRATIO f77 code in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">        Pw      float      partial pressure      (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">    w = Gas.PsychMassRat * pw / (p - pw)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">    return w</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="372">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CoilAoFactor(dBin, wBin, p, qdot, cfm, shr)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">        Find the coil Ao factor at the given incoming air state (entering drybubl and wetbulb) and CFM,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby">        total capacity and SHR</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby">        EnergyPlus source code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby">        Tdb    float    Entering Dry Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">        Twb    float    Entering Wet Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="388">
          
          
          <code class="ruby">        P      float    Barometric pressure (psi)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="389">
          
          
          <code class="ruby">        Qdot   float    Total capacity of unit (kBtu/h)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">        cfm    float    Volumetric flow rate of unit (CFM)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">        shr    float    Sensible heat ratio</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">        Ao    float    Coil Ao Factor</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="397">
          
          
          <code class="ruby">    bf = self.CoilBypassFactor(dBin, wBin, p, qdot, cfm, shr)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">    mfr = UnitConversions.convert(self.CalculateMassflowRate(dBin, wBin, p, cfm), &quot;lbm/min&quot;, &quot;kg/s&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">    ntu = -1.0 * Math.log(bf)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">    ao = ntu * mfr</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="402">
          
          
          <code class="ruby">    return ao</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="405">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CoilBypassFactor(dBin, wBin, p, qdot, cfm, shr)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby">        Find the coil bypass factor at the given incoming air state (entering drybubl and wetbulb) and CFM,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby">        total capacity and SHR</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="413">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">        EnergyPlus source code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby">        Tdb    float    Entering Dry Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">        Twb    float    Entering Wet Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby">        P      float    Barometric pressure (psi)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">        Qdot   float    Total capacity of unit (kBtu/h)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby">        cfm    float    Volumetric flow rate of unit (CFM)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="424">
          
          
          <code class="ruby">        shr    float    Sensible heat ratio</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">        CBF    float    Coil Bypass Factor</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    mfr = UnitConversions.convert(self.CalculateMassflowRate(dBin, wBin, p, cfm), &quot;lbm/min&quot;, &quot;kg/s&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">    tin = UnitConversions.convert(dBin, &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">    win = self.w_fT_Twb_P(dBin, wBin, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="434">
          
          
          <code class="ruby">    p = UnitConversions.convert(p, &quot;psi&quot;, &quot;kPa&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="435">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">    dH = UnitConversions.convert(qdot, &quot;kBtu/hr&quot;, &quot;W&quot;) / mfr</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="437">
          
          
          <code class="ruby">    hin = self.h_fT_w_SI(tin, win)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="438">
          
          
          <code class="ruby">    h_Tin_Wout = hin - (1 - shr) * dH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="439">
          
          
          <code class="ruby">    wout = self.w_fT_h_SI(tin, h_Tin_Wout)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="440">
          
          
          <code class="ruby">    dW = win - wout</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">    hout = hin - dH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">    tout = self.T_fw_h_SI(wout, hout)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="443">
          
          
          <code class="ruby">    rH_out = self.R_fT_w_P_SI(tout, wout, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">    if rH_out &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="446">
          
          
          <code class="ruby">      puts &#39;Error: Conditions passed to CoilBypassFactor result in outlet RH &gt; 100%&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="448">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    dT = tin - tout</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">    m_c = dW / dT</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="451">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">    t_ADP = self.Tdp_fP_w_SI(p, wout) # Initial guess for iteration</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">    if shr == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">      w_ADP = self.w_fT_Twb_P_SI(t_ADP, t_ADP, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="456">
          
          
          <code class="ruby">      h_ADP = self.h_fT_w_SI(t_ADP, w_ADP)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="457">
          
          
          <code class="ruby">      bF = (hout - h_ADP) / (hin - h_ADP)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="458">
          
          
          <code class="ruby">      return [bF, 0.01].max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="460">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">    cnt = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">    tol = 1.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">    errorLast = 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">    d_T_ADP = 5.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="466">
          
          
          <code class="ruby">    while cnt &lt; 100 and tol &gt; 0.001</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">      # for i in range(1,itmax+1):</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="469">
          
          
          <code class="ruby">      if cnt &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">        t_ADP = t_ADP + d_T_ADP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="473">
          
          
          <code class="ruby">      w_ADP = self.w_fT_Twb_P_SI(t_ADP, t_ADP, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">      m = (win - w_ADP) / (tin - t_ADP)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="476">
          
          
          <code class="ruby">      error = (m - m_c) / m_c</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="478">
          
          
          <code class="ruby">      if error &gt; 0 and errorLast &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="479">
          
          
          <code class="ruby">        d_T_ADP = -1.0 * d_T_ADP / 2.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="480">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="482">
          
          
          <code class="ruby">      if error &lt; 0 and errorLast &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="483">
          
          
          <code class="ruby">        d_T_ADP = -1.0 * d_T_ADP / 2.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">      errorLast = error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="487">
          
          
          <code class="ruby">      tol = error.abs.to_f</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="488">
          
          
          <code class="ruby">      cnt = cnt + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="489">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="491">
          
          
          <code class="ruby">    h_ADP = self.h_fT_w_SI(t_ADP, w_ADP)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">    bF = (hout - h_ADP) / (hin - h_ADP)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="494">
          
          
          <code class="ruby">    return [bF, 0.01].max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="496">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="497">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalculateMassflowRate(dBin, wBin, p, cfm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="500">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">        Calculate the mass flow rate at the given incoming air state (entering drybubl and wetbulb) and CFM</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="505">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">        Tdb    float    Entering Dry Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="510">
          
          
          <code class="ruby">        Twb    float    Entering Wet Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="511">
          
          
          <code class="ruby">        P      float    Barometric pressure (psi)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">        cfm    float    Volumetric flow rate of unit (CFM)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby">        mfr    float    mass flow rate (lbm/min)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">    win = self.w_fT_Twb_P(dBin, wBin, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="518">
          
          
          <code class="ruby">    rho_in = self.rhoD_fT_w_P(dBin, win, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="519">
          
          
          <code class="ruby">    mfr = cfm * rho_in</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="520">
          
          
          <code class="ruby">    return mfr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="521">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="523">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.T_fw_h_SI(w, h)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="525">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">        Calculate the drybulb temperature at a given humidity ratio</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">        and enthalpy.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="529">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="530">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="532">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="534">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">        w       float      humidity ratio        (kg/kg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby">        h       float      enthalpy              (J/kg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="540">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">        T       float      drybulb temperature  (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="542">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="544">
          
          
          <code class="ruby">    t = (h / 1000 - w * 2501) / (1.006 + w * 1.86)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    return t</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="548">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.R_fT_w_P_SI(tdb, w, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">        Calculate the relative humidity at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">        humidity ratio and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="557">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">        w       float      humidity ratio        (g/g)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby">        P       float      pressure              (kPa)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="566">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="567">
          
          
          <code class="ruby">        R       float      relative humidity     (1/1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="568">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">    return self.R_fT_w_P(UnitConversions.convert(tdb, &quot;C&quot;, &quot;F&quot;), w, UnitConversions.convert(p, &quot;kPa&quot;, &quot;psi&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="570">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="572">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Tdp_fP_w_SI(p, w)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="576">
          
          
          <code class="ruby">        Calculate the dewpoint temperature at a given pressure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="577">
          
          
          <code class="ruby">        and humidity ratio.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="578">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">        There are two available methods:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="581">
          
          
          <code class="ruby">        CalcMethod == 1: Uses the correlation method from ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby">        CalcMethod &lt;&gt; 1: Uses the saturation temperature at the partial</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby">                         pressure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="584">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="585">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="586">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="588">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="589">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="590">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">        P       float      pressure              (kPa)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby">        w       float      humidity ratio        (g/g)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="595">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby">        Tdp     float      dewpoint temperature  (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="597">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="598">
          
          
          <code class="ruby">    return UnitConversions.convert(self.Tdp_fP_w(UnitConversions.convert(p, &quot;kPa&quot;, &quot;psi&quot;), w), &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="599">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="600">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="601">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.w_fT_Twb_P_SI(tdb, twb, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="603">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="604">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby">        Calculate the humidity ratio at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby">        wetbulb temperature and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="608">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="609">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="610">
          
          
          <code class="ruby">        ASHRAE Handbook 2009</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="612">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="613">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="614">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="615">
          
          
          <code class="ruby">        Twb     float      wetbulb temperature   (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="616">
          
          
          <code class="ruby">        P       float      pressure              (kPa)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="617">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="618">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="619">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="620">
          
          
          <code class="ruby">        w       float      humidity ratio        (g/g)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="621">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="623">
          
          
          <code class="ruby">    return self.w_fT_Twb_P(UnitConversions.convert(tdb, &quot;C&quot;, &quot;F&quot;), UnitConversions.convert(twb, &quot;C&quot;, &quot;F&quot;), UnitConversions.convert(p, &quot;kPa&quot;, &quot;psi&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="624">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="625">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="626">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.w_fT_Twb_P(tdb, twb, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="627">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="630">
          
          
          <code class="ruby">        Calculate the humidity ratio at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">        wetbulb temperature and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby">        ASHRAE Handbook 2009</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="636">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="637">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="638">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="639">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="640">
          
          
          <code class="ruby">        Twb     float      wetbulb temperature   (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="642">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="643">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="644">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="646">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="647">
          
          
          <code class="ruby">    w_star = self.w_fP(p, self.Psat_fT(twb))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="649">
          
          
          <code class="ruby">    w = ((Liquid.H2O_l.h_fg - (Liquid.H2O_l.cp - Gas.H2O_v.cp) * twb) * w_star - Gas.Air.cp * (tdb - twb)) / (Liquid.H2O_l.h_fg + Gas.H2O_v.cp * tdb - Liquid.H2O_l.cp * twb) # (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="651">
          
          
          <code class="ruby">    return w</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="652">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="653">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="654">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.R_fT_w_P(tdb, w, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="655">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="657">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="658">
          
          
          <code class="ruby">        Calculate the relative humidity at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="659">
          
          
          <code class="ruby">        humidity ratio and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="660">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="661">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="662">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="663">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="664">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="665">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="666">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="667">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="668">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="670">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="672">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby">        R       float      relative humidity     (1/1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="675">
          
          
          <code class="ruby">    pw = self.Pw_fP_w(p, w)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="676">
          
          
          <code class="ruby">    r = pw / self.Psat_fT(tdb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">    return r</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="678">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="679">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="680">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Pw_fP_w(p, w)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="684">
          
          
          <code class="ruby">        Calculate the partial vapor pressure at a given pressure and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby">        humidity ratio.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="686">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="691">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="692">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="693">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="694">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="695">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="696">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="697">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby">        Pw      float      partial pressure      (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="699">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="700">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="701">
          
          
          <code class="ruby">    pw = p * w / (Gas.PsychMassRat + w)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="702">
          
          
          <code class="ruby">    return pw</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="703">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="704">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="705">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Tdp_fP_w(p, w)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="706">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="707">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="709">
          
          
          <code class="ruby">        Calculate the dewpoint temperature at a given pressure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="710">
          
          
          <code class="ruby">        and humidity ratio.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="711">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby">        There are two available methods:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="714">
          
          
          <code class="ruby">        CalcMethod == 1: Uses the correlation method from ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="715">
          
          
          <code class="ruby">        CalcMethod &lt;&gt; 1: Uses the saturation temperature at the partial</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby">                         pressure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="717">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="719">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="721">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="722">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="723">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="724">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="725">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="726">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="727">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="728">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">        Tdp     float      dewpoint temperature  (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="730">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="731">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">    calcMethod = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="734">
          
          
          <code class="ruby">    if calcMethod == 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="735">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="736">
          
          
          <code class="ruby">      c14 = 100.45</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="737">
          
          
          <code class="ruby">      c15 = 33.193</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="738">
          
          
          <code class="ruby">      c16 = 2.319</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="739">
          
          
          <code class="ruby">      c17 = 0.17074</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="740">
          
          
          <code class="ruby">      c18 = 1.2063</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="741">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="742">
          
          
          <code class="ruby">      pw = self.Pw_fP_w(p, w) # (psia)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="743">
          
          
          <code class="ruby">      alpha = Math.log(pw)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="744">
          
          
          <code class="ruby">      tdp1 = c14 + c15 * alpha + c16 * alpha**2 + c17 * alpha**3 + c18 * pw**0.1984</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="745">
          
          
          <code class="ruby">      tdp2 = 90.12 + 26.142 * alpha + 0.8927 * alpha**2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="746">
          
          
          <code class="ruby">      if tdp1 &gt;= Liquid.H2O_l.t_frz</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="747">
          
          
          <code class="ruby">        tdp = tdp1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="748">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="749">
          
          
          <code class="ruby">        tdp = tdp2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="750">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="751">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="752">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="754">
          
          
          <code class="ruby">      # based on DEWPOINT f77 code in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="755">
          
          
          <code class="ruby">      if w &lt; Constants.small</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="756">
          
          
          <code class="ruby">        tdp = -999.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="758">
          
          
          <code class="ruby">        pw = self.Pw_fP_w(p, w)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="759">
          
          
          <code class="ruby">        tdp = self.Tsat_fP(pw)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="761">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="763">
          
          
          <code class="ruby">    return tdp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="764">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="766">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.CalculateSHR(dBin, wBin, p, q, cfm, ao)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="767">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="768">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="769">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="770">
          
          
          <code class="ruby">        Calculate the coil SHR at the given incoming air state, CFM, total capacity, and coil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="771">
          
          
          <code class="ruby">        Ao factor</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="773">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="774">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="775">
          
          
          <code class="ruby">        EnergyPlus source code</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="776">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="777">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="779">
          
          
          <code class="ruby">        Tdb    float    Entering Dry Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby">        Twb    float    Entering Wet Bulb (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby">        P      float    Barometric pressure (psi)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="782">
          
          
          <code class="ruby">        Q      float    Total capacity of unit (kBtu/h)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="783">
          
          
          <code class="ruby">        cfm    float    Volumetric flow rate of unit (CFM)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="784">
          
          
          <code class="ruby">        Ao     float    Coil Ao factor (=UA/Cp - IN SI UNITS)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby">        SHR    float    Sensible Heat Ratio</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="788">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="789">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="790">
          
          
          <code class="ruby">    mfr = UnitConversions.convert(self.CalculateMassflowRate(dBin, wBin, p, cfm), &quot;lbm/min&quot;, &quot;kg/s&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="791">
          
          
          <code class="ruby">    bf = Math.exp(-1.0 * ao / mfr)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="792">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="793">
          
          
          <code class="ruby">    win = self.w_fT_Twb_P(dBin, wBin, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="794">
          
          
          <code class="ruby">    p = UnitConversions.convert(p, &quot;psi&quot;, &quot;kPa&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="795">
          
          
          <code class="ruby">    tin = UnitConversions.convert(dBin, &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="796">
          
          
          <code class="ruby">    hin = self.h_fT_w_SI(tin, win)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="797">
          
          
          <code class="ruby">    dH = UnitConversions.convert(q, &quot;kBtu/hr&quot;, &quot;W&quot;) / mfr</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="798">
          
          
          <code class="ruby">    h_ADP = hin - dH / (1 - bf)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="799">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="800">
          
          
          <code class="ruby">    # T_ADP = self.Tsat_fh_P_SI(H_ADP, P)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby">    # W_ADP = self.w_fT_h_SI(T_ADP, H_ADP)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="802">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="803">
          
          
          <code class="ruby">    # Initialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="804">
          
          
          <code class="ruby">    t_ADP = self.Tdp_fP_w_SI(p, win)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="805">
          
          
          <code class="ruby">    t_ADP_1 = t_ADP # (degC)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="806">
          
          
          <code class="ruby">    t_ADP_2 = t_ADP # (degC)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="807">
          
          
          <code class="ruby">    w_ADP = self.w_fT_R_P_SI(t_ADP, 1.0, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">    error = h_ADP - self.h_fT_w_SI(t_ADP, w_ADP)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="809">
          
          
          <code class="ruby">    error1 = error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">    error2 = error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="811">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="812">
          
          
          <code class="ruby">    itmax = 50 # maximum iterations</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="813">
          
          
          <code class="ruby">    cvg = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="814">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="815">
          
          
          <code class="ruby">    (1...itmax + 1).each do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="816">
          
          
          <code class="ruby">      w_ADP = self.w_fT_R_P_SI(t_ADP, 1.0, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="817">
          
          
          <code class="ruby">      error = h_ADP - self.h_fT_w_SI(t_ADP, w_ADP)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="819">
          
          
          <code class="ruby">      t_ADP, cvg, t_ADP_1, error1, t_ADP_2, error2 = MathTools.Iterate(t_ADP, error, t_ADP_1, error1, t_ADP_2, error2, i, cvg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="820">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="821">
          
          
          <code class="ruby">      if cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="823">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="825">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="826">
          
          
          <code class="ruby">    if not cvg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="827">
          
          
          <code class="ruby">      puts &#39;Warning: Tsat_fh_P failed to converge&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="830">
          
          
          <code class="ruby">    h_Tin_Wadp = self.h_fT_w_SI(tin, w_ADP)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="831">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="832">
          
          
          <code class="ruby">    if (hin - h_ADP != 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="833">
          
          
          <code class="ruby">      shr = [(h_Tin_Wadp - h_ADP) / (hin - h_ADP), 1.0].min</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="834">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="835">
          
          
          <code class="ruby">      shr = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="837">
          
          
          <code class="ruby">    return shr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="838">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="839">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="840">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.w_fT_R_P(tdb, r, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="841">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="842">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="843">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="844">
          
          
          <code class="ruby">        Calculate the humidity ratio at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="845">
          
          
          <code class="ruby">        relative humidity and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="846">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="847">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="848">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="849">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="850">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="851">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="852">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="853">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby">        R       float      relative humidity     (1/1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="855">
          
          
          <code class="ruby">        P       float      pressure              (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="856">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="857">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="858">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="859">
          
          
          <code class="ruby">        w       float      humidity ratio        (lbm/lbm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="860">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="861">
          
          
          <code class="ruby">    pws = self.Psat_fT(tdb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="862">
          
          
          <code class="ruby">    pw = r * pws</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="863">
          
          
          <code class="ruby">    w = 0.62198 * pw / (p - pw)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="864">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="865">
          
          
          <code class="ruby">    return w</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="866">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="867">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="868">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.w_fT_R_P_SI(tdb, r, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="869">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="870">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="871">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="872">
          
          
          <code class="ruby">        Calculate the humidity ratio at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="873">
          
          
          <code class="ruby">        relative humidity and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="874">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="876">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="877">
          
          
          <code class="ruby">        2009 ASHRAE Handbook</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="878">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="879">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="880">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="881">
          
          
          <code class="ruby">        Tdb     float      drybulb temperature   (degC)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="882">
          
          
          <code class="ruby">        R       float      relative humidity     (1/1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="883">
          
          
          <code class="ruby">        P       float      pressure              (kPa)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="884">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="885">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="886">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="887">
          
          
          <code class="ruby">        w       float      humidity ratio        (g/g)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="888">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="889">
          
          
          <code class="ruby">    pws = UnitConversions.convert(self.Psat_fT(UnitConversions.convert(tdb, &quot;C&quot;, &quot;F&quot;)), &quot;psi&quot;, &quot;kPa&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="890">
          
          
          <code class="ruby">    pw = r * pws</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="891">
          
          
          <code class="ruby">    w = 0.62198 * pw / (p - pw)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="892">
          
          
          <code class="ruby">    return w</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="893">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="894">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="895">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Twb_fT_R_P(tdb, r, p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="896">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="897">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="898">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="899">
          
          
          <code class="ruby">        Calculate the wetbulb temperature at a given drybulb temperature,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="900">
          
          
          <code class="ruby">        relative humidity, and pressure.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="901">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="902">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="903">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="904">
          
          
          <code class="ruby">        None (calls other pyschrometric functions)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="905">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="906">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="907">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="908">
          
          
          <code class="ruby">        Tdb    float    drybulb temperature    (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="909">
          
          
          <code class="ruby">        R      float    relative humidity      (1/1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="910">
          
          
          <code class="ruby">        P      float    pressure               (psia)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="911">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby">    Output:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="913">
          
          
          <code class="ruby">    ------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="914">
          
          
          <code class="ruby">        Twb    float    wetbulb temperautre    (degF)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="915">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="916">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="917">
          
          
          <code class="ruby">    w = self.w_fT_R_P(tdb, r, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="918">
          
          
          <code class="ruby">    twb = self.Twb_fT_w_P(tdb, w, p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="919">
          
          
          <code class="ruby">    return twb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="920">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b938637b8a673ce33a589b0c60b078eeb0653b18">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/schedules.rb</h3>
    <h4><span class="red">36.15 %</span> covered</h4>
    <div>
      <b>650</b> relevant lines. 
      <span class="green"><b>235</b> lines covered</span> and
      <span class="red"><b>415</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># TODO: Need to handle vacations</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># Annual schedule defined by 12 24-hour values for weekdays and weekends.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class HourlyByMonthSchedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # weekday_month_by_hour_values must be a 12-element array of 24-element arrays of numbers.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # weekend_month_by_hour_values must be a 12-element array of 24-element arrays of numbers.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(model, runner, sch_name, weekday_month_by_hour_values, weekend_month_by_hour_values,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">                 normalize_values = true, create_sch_object = true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">                 winter_design_day_sch = nil, summer_design_day_sch = nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">                 schedule_type_limits_name = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    @validated = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    @model = model</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    @runner = runner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    @sch_name = sch_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    @schedule = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    @weekday_month_by_hour_values = validateValues(weekday_month_by_hour_values, 12, 24)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    @weekend_month_by_hour_values = validateValues(weekend_month_by_hour_values, 12, 24)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    @schedule_type_limits_name = schedule_type_limits_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    if not @validated</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    if normalize_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      @maxval = calcMaxval()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      @maxval = 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    @winter_design_day_sch = winter_design_day_sch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    @summer_design_day_sch = summer_design_day_sch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    if create_sch_object</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      @schedule = createSchedule()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    return @validated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcDesignLevel(val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    return val * 1000</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def schedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    return @schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def maxval</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    return @maxval</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def validateValues(vals, num_outter_values, num_inner_values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    err_msg = &quot;A #{num_outter_values.to_s}-element array with #{num_inner_values.to_s}-element arrays of numbers must be entered for the schedule.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    if not vals.is_a?(Array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">      if vals.length != num_outter_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">        @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">        @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      vals.each do |val|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">        if not val.is_a?(Array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">          @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">          @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">          return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">        if val.length != num_inner_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">          @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">          @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">          return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    rescue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    return vals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcMaxval()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    maxval = [@weekday_month_by_hour_values.flatten.max, @weekend_month_by_hour_values.flatten.max].max</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    if maxval == 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">      maxval == 1.0 # Prevent divide by zero</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    return maxval</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def createSchedule()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    wkdy = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    wknd = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    year_description = @model.getYearDescription</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    assumed_year = year_description.assumedYear</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    num_days_in_months = Constants.NumDaysInMonths(year_description.isLeapYear)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    time = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      time[h] = OpenStudio::Time.new(0, h, 0, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    schedule = OpenStudio::Model::ScheduleRuleset.new(@model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    schedule.setName(@sch_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    for m in 1..12</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      date_s = OpenStudio::Date.new(OpenStudio::MonthOfYear.new(m), 1, assumed_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      date_e = OpenStudio::Date.new(OpenStudio::MonthOfYear.new(m), num_days_in_months[m - 1], assumed_year)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">      wkdy_vals = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      wknd_vals = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">        wkdy_vals[h] = (@weekday_month_by_hour_values[m - 1][h - 1]) / @maxval</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">        wknd_vals[h] = (@weekend_month_by_hour_values[m - 1][h - 1]) / @maxval</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">      if wkdy_vals == wknd_vals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">        # Alldays</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">        wkdy_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">        wkdy_rule.setName(@sch_name + &quot; #{Schedule.allday_name} rule#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">        wkdy[m] = wkdy_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">        wkdy[m].setName(@sch_name + &quot; #{Schedule.allday_name}#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">        previous_value = wkdy_vals[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">        for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">          next if h != 24 and wkdy_vals[h + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">          wkdy[m].addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">          previous_value = wkdy_vals[h + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">        Schedule.set_weekday_rule(wkdy_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">        Schedule.set_weekend_rule(wkdy_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">        wkdy_rule.setStartDate(date_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">        wkdy_rule.setEndDate(date_e)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">        # Weekdays</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">        wkdy_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">        wkdy_rule.setName(@sch_name + &quot; #{Schedule.weekday_name} rule#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">        wkdy[m] = wkdy_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">        wkdy[m].setName(@sch_name + &quot; #{Schedule.weekday_name}#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">        previous_value = wkdy_vals[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">        for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">          next if h != 24 and wkdy_vals[h + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">          wkdy[m].addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">          previous_value = wkdy_vals[h + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">        Schedule.set_weekday_rule(wkdy_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">        wkdy_rule.setStartDate(date_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">        wkdy_rule.setEndDate(date_e)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">        # Weekends</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">        wknd_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">        wknd_rule.setName(@sch_name + &quot; #{Schedule.weekend_name} rule#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">        wknd[m] = wknd_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">        wknd[m].setName(@sch_name + &quot; #{Schedule.weekend_name}#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">        previous_value = wknd_vals[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">        for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">          next if h != 24 and wknd_vals[h + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">          wknd[m].addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">          previous_value = wknd_vals[h + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">        Schedule.set_weekend_rule(wknd_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">        wknd_rule.setStartDate(date_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">        wknd_rule.setEndDate(date_e)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">    unless @winter_design_day_sch.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">      schedule.setWinterDesignDaySchedule(@winter_design_day_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">      schedule.winterDesignDaySchedule.setName(&quot;#{@sch_name} winter design&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">    unless @summer_design_day_sch.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">      schedule.setSummerDesignDaySchedule(@summer_design_day_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">      schedule.summerDesignDaySchedule.setName(&quot;#{@sch_name} summer design&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">    Schedule.set_schedule_type_limits(@model, schedule, @schedule_type_limits_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">    return schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"># Annual schedule defined by 24 weekday hourly values, 24 weekend hourly values, and 12 monthly values</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">class MonthWeekdayWeekendSchedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">  # weekday_hourly_values can either be a comma-separated string of 24 numbers or a 24-element array of numbers.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">  # weekend_hourly_values can either be a comma-separated string of 24 numbers or a 24-element array of numbers.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">  # monthly_values can either be a comma-separated string of 12 numbers or a 12-element array of numbers.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(model, runner, sch_name, weekday_hourly_values, weekend_hourly_values, monthly_values,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">                 mult_weekday = 1.0, mult_weekend = 1.0, normalize_values = true, create_sch_object = true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">                 winter_design_day_sch = nil, summer_design_day_sch = nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">                 schedule_type_limits_name = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">    @validated = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">    @model = model</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">    @runner = runner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">    @sch_name = sch_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">    @schedule = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">    @mult_weekday = mult_weekday</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">    @mult_weekend = mult_weekend</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">    @weekday_hourly_values = validateValues(weekday_hourly_values, 24, &quot;weekday&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">    @weekend_hourly_values = validateValues(weekend_hourly_values, 24, &quot;weekend&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">    @monthly_values = validateValues(monthly_values, 12, &quot;monthly&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    @schedule_type_limits_name = schedule_type_limits_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    if not @validated</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">    if normalize_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">      @weekday_hourly_values = normalizeSumToOne(@weekday_hourly_values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">      @weekend_hourly_values = normalizeSumToOne(@weekend_hourly_values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">      @monthly_values = normalizeAvgToOne(@monthly_values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">      @maxval = calcMaxval()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">      @schadjust = calcSchadjust()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="221">
          
          
          <code class="ruby">      @maxval = 1.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="222">
          
          
          <code class="ruby">      @schadjust = 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">    @winter_design_day_sch = winter_design_day_sch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="225">
          
          
          <code class="ruby">    @summer_design_day_sch = summer_design_day_sch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">    if create_sch_object</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">      @schedule = createSchedule()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>
          
          <code class="ruby">  def validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">    return @validated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcDesignLevelFromDailykWh(daily_kwh)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">    return daily_kwh * @maxval * 1000 * @schadjust</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcDesignLevelFromDailyTherm(daily_therm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="240">
          
          
          <code class="ruby">    return calcDesignLevelFromDailykWh(UnitConversions.convert(daily_therm, &quot;therm&quot;, &quot;kWh&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>
          
          <code class="ruby">  def schedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">    return @schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="247">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="249">
          <span class="hits">1</span>
          
          <code class="ruby">  def validateValues(values, num_values, sch_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">    err_msg = &quot;A comma-separated string of #{num_values.to_s} numbers must be entered for the #{sch_name} schedule.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">    if values.is_a?(Array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">      if values.length != num_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">        @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">        @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">      values.each do |val|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">        if not valid_float?(val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">          @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">          @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">          return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">      floats = values.map { |i| i.to_f }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">    elsif values.is_a?(String)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">        vals = values.split(&quot;,&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">        vals.each do |val|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">          if not valid_float?(val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">            @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">            @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">            return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">        floats = vals.map { |i| i.to_f }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">        if floats.length != num_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">          @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">          @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">          return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">      rescue</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">        @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">        @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">      @runner.registerError(err_msg)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">      @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">    return floats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="294">
          <span class="hits">1</span>
          
          <code class="ruby">  def valid_float?(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">    !!Float(str) rescue false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="298">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalizeSumToOne(values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">    sum = values.reduce(:+).to_f</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">    if sum == 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">      return values</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">    return values.map { |val| val / sum }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="307">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalizeAvgToOne(values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">    avg = values.reduce(:+).to_f / values.size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">    if avg == 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">      return values</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">    return values.map { |val| val / avg }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="316">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcMaxval()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">    if @weekday_hourly_values.max &gt; @weekend_hourly_values.max</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">      maxval = @monthly_values.max * @weekday_hourly_values.max * @mult_weekday</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">      maxval = @monthly_values.max * @weekend_hourly_values.max * @mult_weekend</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">    if maxval == 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">      maxval == 1.0 # Prevent divide by zero</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">    return maxval</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="328">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcSchadjust()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">    # if sum != 1, normalize to get correct max val</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">    sum_wkdy = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">    sum_wknd = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">    @weekday_hourly_values.each do |v|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">      sum_wkdy = sum_wkdy + v</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">    @weekend_hourly_values.each do |v|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">      sum_wknd = sum_wknd + v</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    if sum_wkdy &lt; sum_wknd</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">      return 1 / sum_wknd</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    return 1 / sum_wkdy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="345">
          <span class="hits">1</span>
          
          <code class="ruby">  def createSchedule()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    wkdy = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">    wknd = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">    year_description = @model.getYearDescription</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">    assumed_year = year_description.assumedYear</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">    num_days_in_months = Constants.NumDaysInMonths(year_description.isLeapYear)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    time = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">    for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="355">
          
          
          <code class="ruby">      time[h] = OpenStudio::Time.new(0, h, 0, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">    schedule = OpenStudio::Model::ScheduleRuleset.new(@model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">    schedule.setName(@sch_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="361">
          
          
          <code class="ruby">    for m in 1..12</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="362">
          
          
          <code class="ruby">      date_s = OpenStudio::Date.new(OpenStudio::MonthOfYear.new(m), 1, assumed_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="363">
          
          
          <code class="ruby">      date_e = OpenStudio::Date.new(OpenStudio::MonthOfYear.new(m), num_days_in_months[m - 1], assumed_year)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">      wkdy_vals = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">      wknd_vals = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">      for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">        wkdy_vals[h] = (@monthly_values[m - 1] * @weekday_hourly_values[h - 1] * @mult_weekday) / @maxval</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="370">
          
          
          <code class="ruby">        wknd_vals[h] = (@monthly_values[m - 1] * @weekend_hourly_values[h - 1] * @mult_weekend) / @maxval</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="373">
          
          
          <code class="ruby">      if wkdy_vals == wknd_vals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">        # Alldays</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">        wkdy_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">        wkdy_rule.setName(@sch_name + &quot; #{Schedule.allday_name} rule#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">        wkdy[m] = wkdy_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">        wkdy[m].setName(@sch_name + &quot; #{Schedule.allday_name}#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="379">
          
          
          <code class="ruby">        previous_value = wkdy_vals[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">        for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="381">
          
          
          <code class="ruby">          next if h != 24 and wkdy_vals[h + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">          wkdy[m].addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">          previous_value = wkdy_vals[h + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">        Schedule.set_weekday_rule(wkdy_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">        Schedule.set_weekend_rule(wkdy_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">        wkdy_rule.setStartDate(date_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">        wkdy_rule.setEndDate(date_e)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">        # Weekdays</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">        wkdy_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">        wkdy_rule.setName(@sch_name + &quot; #{Schedule.weekday_name} rule#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">        wkdy[m] = wkdy_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="395">
          
          
          <code class="ruby">        wkdy[m].setName(@sch_name + &quot; #{Schedule.weekday_name}#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="396">
          
          
          <code class="ruby">        previous_value = wkdy_vals[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="397">
          
          
          <code class="ruby">        for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">          next if h != 24 and wkdy_vals[h + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">          wkdy[m].addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">          previous_value = wkdy_vals[h + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">        Schedule.set_weekday_rule(wkdy_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">        wkdy_rule.setStartDate(date_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="405">
          
          
          <code class="ruby">        wkdy_rule.setEndDate(date_e)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">        # Weekends</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="408">
          
          
          <code class="ruby">        wknd_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">        wknd_rule.setName(@sch_name + &quot; #{Schedule.weekend_name} rule#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="410">
          
          
          <code class="ruby">        wknd[m] = wknd_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="411">
          
          
          <code class="ruby">        wknd[m].setName(@sch_name + &quot; #{Schedule.weekend_name}#{m}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="412">
          
          
          <code class="ruby">        previous_value = wknd_vals[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">        for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="414">
          
          
          <code class="ruby">          next if h != 24 and wknd_vals[h + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="416">
          
          
          <code class="ruby">          wknd[m].addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">          previous_value = wknd_vals[h + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">        Schedule.set_weekend_rule(wknd_rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="420">
          
          
          <code class="ruby">        wknd_rule.setStartDate(date_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="421">
          
          
          <code class="ruby">        wknd_rule.setEndDate(date_e)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="424">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">    unless @winter_design_day_sch.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="427">
          
          
          <code class="ruby">      schedule.setWinterDesignDaySchedule(@winter_design_day_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="428">
          
          
          <code class="ruby">      schedule.winterDesignDaySchedule.setName(&quot;#{@sch_name} winter design&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    unless @summer_design_day_sch.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="431">
          
          
          <code class="ruby">      schedule.setSummerDesignDaySchedule(@summer_design_day_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">      schedule.summerDesignDaySchedule.setName(&quot;#{@sch_name} summer design&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="435">
          
          
          <code class="ruby">    Schedule.set_schedule_type_limits(@model, schedule, @schedule_type_limits_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="437">
          
          
          <code class="ruby">    return schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby"># Generic class for handling an hourly schedule (saved as a csv) with 8760 values. Currently used by water heater models.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="442">
          <span class="hits">1</span>
          
          <code class="ruby">class HourlySchedule</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="443">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(model, runner, sch_name, file, offset, convert_temp, validation_values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="444">
          
          
          <code class="ruby">    @validated = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">    @model = model</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="446">
          
          
          <code class="ruby">    @runner = runner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="447">
          
          
          <code class="ruby">    @sch_name = sch_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">    @schedule = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    @offset = offset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">    @convert_temp = convert_temp</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">    @validation_values = validation_values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">    @schedule, @schedule_array = createHourlyScheduleFromFile(runner, file, offset, convert_temp, validation_values)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">    if @schedule.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">      @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="456">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="458">
          
          
          <code class="ruby">    schedule = @schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="460">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="461">
          <span class="hits">1</span>
          
          <code class="ruby">  def validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">    return @validated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="465">
          <span class="hits">1</span>
          
          <code class="ruby">  def schedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="466">
          
          
          <code class="ruby">    return @schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="469">
          <span class="hits">1</span>
          
          <code class="ruby">  def schedule_array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">    return @schedule_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="473">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="475">
          <span class="hits">1</span>
          
          <code class="ruby">  def createHourlyScheduleFromFile(runner, file, offset, convert_temp, validation_values)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="476">
          
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">    # Get appropriate file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="479">
          
          
          <code class="ruby">    hourly_schedule = &quot;#{file}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">    if not File.file?(hourly_schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="481">
          
          
          <code class="ruby">      @runner.registerError(&quot;Unable to find file: #{hourly_schedule}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="482">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby">    # Read data into hourly array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">    hour = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="487">
          
          
          <code class="ruby">    data = [] # Generalize for any length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="488">
          
          
          <code class="ruby">    File.open(file).each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">      linedata = line.strip.split(&#39;,&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="490">
          
          
          <code class="ruby">      if validation_values.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="491">
          
          
          <code class="ruby">        if convert_temp == true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="492">
          
          
          <code class="ruby">          value = UnitConversions.convert((linedata[0].to_f + offset), &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="494">
          
          
          <code class="ruby">          value = linedata[0].to_f + offset</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="496">
          
          
          <code class="ruby">        data[hour] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="498">
          
          
          <code class="ruby">        if validation_values.include? linedata[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="499">
          
          
          <code class="ruby">          value = validation_values.find_index(linedata[0]).to_f / (validation_values.length.to_f - 1.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="500">
          
          
          <code class="ruby">          data[hour] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="502">
          
          
          <code class="ruby">          runner.registerError(&quot;Invalid value included in the hourly schedule file. The invalid data occurs at hour #{hour}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">      hour += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="508">
          
          
          <code class="ruby">    year_description = @model.getYearDescription</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="509">
          
          
          <code class="ruby">    start_date = year_description.makeDate(1, 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">    interval = OpenStudio::Time.new(0, 1, 0, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="511">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="512">
          
          
          <code class="ruby">    time_series = OpenStudio::TimeSeries.new(start_date, interval, OpenStudio::createVector(data), &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">    schedule = OpenStudio::Model::ScheduleFixedInterval.fromTimeSeries(time_series, @model).get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="515">
          
          
          <code class="ruby">    schedule.setName(@sch_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">    return schedule, data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="518">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="521">
          <span class="hits">1</span>
          
          <code class="ruby">class HotWaterSchedule</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="522">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(model, runner, sch_name, temperature_sch_name, num_bedrooms, days_shift,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby">                 file_prefix, target_water_temperature, create_sch_object = true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">                 schedule_type_limits_name = nil)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="525">
          <span class="hits">55</span>
          
          <code class="ruby">    @validated = true</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="526">
          <span class="hits">55</span>
          
          <code class="ruby">    @model = model</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="527">
          <span class="hits">55</span>
          
          <code class="ruby">    @runner = runner</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="528">
          <span class="hits">55</span>
          
          <code class="ruby">    @sch_name = sch_name</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="529">
          <span class="hits">55</span>
          
          <code class="ruby">    @schedule = nil</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="530">
          <span class="hits">55</span>
          
          <code class="ruby">    @temperature_sch_name = temperature_sch_name</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="531">
          <span class="hits">55</span>
          
          <code class="ruby">    @nbeds = num_bedrooms.to_i</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="532">
          <span class="hits">55</span>
          
          <code class="ruby">    if @nbeds &gt; 5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="533">
          
          
          <code class="ruby">      @nbeds = 5</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="534">
          <span class="hits">55</span>
          
          <code class="ruby">    elsif @nbeds &lt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="535">
          
          
          <code class="ruby">      @nbeds = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="537">
          <span class="hits">55</span>
          
          <code class="ruby">    @target_water_temperature = UnitConversions.convert(target_water_temperature, &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="538">
          <span class="hits">55</span>
          
          <code class="ruby">    @schedule_type_limits_name = schedule_type_limits_name</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="539">
          <span class="hits">55</span>
          
          <code class="ruby">    if file_prefix == &quot;ClothesDryer&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="540">
          
          
          <code class="ruby">      @file_prefix = &quot;ClothesWasher&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="542">
          <span class="hits">55</span>
          
          <code class="ruby">      @file_prefix = file_prefix</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="545">
          <span class="hits">55</span>
          
          <code class="ruby">    timestep_minutes = (60 / @model.getTimestep.numberOfTimestepsPerHour).to_i</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="546">
          <span class="hits">55</span>
          
          <code class="ruby">    weeks = 1 # use a single week that repeats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="548">
          <span class="hits">55</span>
          
          <code class="ruby">    data = loadMinuteDrawProfileFromFile(timestep_minutes, days_shift, weeks)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="549">
          <span class="hits">55</span>
          
          <code class="ruby">    @totflow, @maxflow, @ontime = loadDrawProfileStatsFromFile()</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="550">
          <span class="hits">55</span>
          
          <code class="ruby">    if data.nil? or @totflow.nil? or @maxflow.nil? or @ontime.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="551">
          
          
          <code class="ruby">      @validated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="552">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="554">
          <span class="hits">55</span>
          
          <code class="ruby">    if create_sch_object</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="555">
          <span class="hits">55</span>
          
          <code class="ruby">      @schedule = createSchedule(data, timestep_minutes, weeks)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="557">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="559">
          <span class="hits">1</span>
          
          <code class="ruby">  def validated?</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="560">
          <span class="hits">55</span>
          
          <code class="ruby">    return @validated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="563">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcDesignLevelFromDailykWh(daily_kWh)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="564">
          <span class="hits">55</span>
          
          <code class="ruby">    return UnitConversions.convert(daily_kWh * Constants.NumDaysInYear(@model.getYearDescription.isLeapYear) * 60 / (Constants.NumDaysInYear(@model.getYearDescription.isLeapYear) * @totflow / @maxflow), &quot;kW&quot;, &quot;W&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="566">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="567">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcPeakFlowFromDailygpm(daily_water)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="568">
          <span class="hits">55</span>
          
          <code class="ruby">    return UnitConversions.convert(@maxflow * daily_water / @totflow, &quot;gal/min&quot;, &quot;m^3/s&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="569">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="570">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="571">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcDailyGpmFromPeakFlow(peak_flow)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">    return UnitConversions.convert(@totflow * peak_flow / @maxflow, &quot;m^3/s&quot;, &quot;gal/min&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="575">
          <span class="hits">1</span>
          
          <code class="ruby">  def calcDesignLevelFromDailyTherm(daily_therm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="576">
          
          
          <code class="ruby">    return calcDesignLevelFromDailykWh(UnitConversions.convert(daily_therm, &quot;therm&quot;, &quot;kWh&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="577">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="578">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="579">
          <span class="hits">1</span>
          
          <code class="ruby">  def schedule</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="580">
          <span class="hits">110</span>
          
          <code class="ruby">    return @schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="581">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="583">
          <span class="hits">1</span>
          
          <code class="ruby">  def temperatureSchedule</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="584">
          <span class="hits">55</span>
          
          <code class="ruby">    temperature_sch = OpenStudio::Model::ScheduleConstant.new(@model)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="585">
          <span class="hits">55</span>
          
          <code class="ruby">    temperature_sch.setValue(@target_water_temperature)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="586">
          <span class="hits">55</span>
          
          <code class="ruby">    temperature_sch.setName(@temperature_sch_name)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="587">
          <span class="hits">55</span>
          
          <code class="ruby">    Schedule.set_schedule_type_limits(@model, temperature_sch, Constants.ScheduleTypeLimitsTemperature)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="588">
          <span class="hits">55</span>
          
          <code class="ruby">    return temperature_sch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="589">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="590">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="591">
          <span class="hits">1</span>
          
          <code class="ruby">  def getOntimeFraction</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="592">
          
          
          <code class="ruby">    return @ontime</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="595">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="597">
          <span class="hits">1</span>
          
          <code class="ruby">  def loadMinuteDrawProfileFromFile(timestep_minutes, days_shift, weeks)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="598">
          <span class="hits">55</span>
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="599">
          <span class="hits">55</span>
          
          <code class="ruby">    if @file_prefix.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="600">
          
          
          <code class="ruby">      return data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="601">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="603">
          
          
          <code class="ruby">    # Get appropriate file</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="604">
          <span class="hits">55</span>
          
          <code class="ruby">    minute_draw_profile = File.join(File.dirname(__FILE__), &quot;HotWater#{@file_prefix}Schedule_#{@nbeds}bed.csv&quot;)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="605">
          <span class="hits">55</span>
          
          <code class="ruby">    if not File.file?(minute_draw_profile)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="606">
          
          
          <code class="ruby">      @runner.registerError(&quot;Unable to find file: #{minute_draw_profile}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="607">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="608">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="609">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="610">
          <span class="hits">55</span>
          
          <code class="ruby">    minutes_in_year = 8760 * 60</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="611">
          <span class="hits">55</span>
          
          <code class="ruby">    weeks_in_minutes = weeks * 7 * 24 * 60</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="612">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="613">
          
          
          <code class="ruby">    # Read data into minute array</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="614">
          <span class="hits">55</span>
          
          <code class="ruby">    skippedheader = false</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="615">
          <span class="hits">55</span>
          
          <code class="ruby">    min_shift = 24 * 60 * (days_shift % 365) # For MF homes, shift each unit by an additional week</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="616">
          <span class="hits">55</span>
          
          <code class="ruby">    items = [0] * minutes_in_year</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="617">
          <span class="hits">55</span>
          
          <code class="ruby">    File.open(minute_draw_profile).each do |line|</code>
        </li>
      
        <li class="covered" data-hits="6465" data-linenumber="618">
          <span class="hits">6465</span>
          
          <code class="ruby">      linedata = line.strip.split(&#39;,&#39;)</code>
        </li>
      
        <li class="covered" data-hits="6465" data-linenumber="619">
          <span class="hits">6465</span>
          
          <code class="ruby">      if not skippedheader</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="620">
          <span class="hits">55</span>
          
          <code class="ruby">        skippedheader = true</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="621">
          <span class="hits">55</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="6410" data-linenumber="623">
          <span class="hits">6410</span>
          
          <code class="ruby">      shifted_minute = linedata[0].to_i - min_shift</code>
        </li>
      
        <li class="covered" data-hits="6410" data-linenumber="624">
          <span class="hits">6410</span>
          
          <code class="ruby">      if shifted_minute &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="625">
          
          
          <code class="ruby">        stored_minute = shifted_minute + minutes_in_year</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="6410" data-linenumber="627">
          <span class="hits">6410</span>
          
          <code class="ruby">        stored_minute = shifted_minute</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="6410" data-linenumber="629">
          <span class="hits">6410</span>
          
          <code class="ruby">      value = linedata[1].to_f</code>
        </li>
      
        <li class="covered" data-hits="6410" data-linenumber="630">
          <span class="hits">6410</span>
          
          <code class="ruby">      items[stored_minute.to_i] = value</code>
        </li>
      
        <li class="covered" data-hits="6410" data-linenumber="631">
          <span class="hits">6410</span>
          
          <code class="ruby">      if shifted_minute &gt;= weeks_in_minutes</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="632">
          <span class="hits">55</span>
          
          <code class="ruby">        break # no need to process more data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="636">
          
          
          <code class="ruby">    # Aggregate minute schedule up to the timestep level to reduce the size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="637">
          
          
          <code class="ruby">    # and speed of processing.</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="638">
          <span class="hits">55</span>
          
          <code class="ruby">    for tstep in 0..(minutes_in_year / timestep_minutes).to_i - 1</code>
        </li>
      
        <li class="covered" data-hits="55495" data-linenumber="639">
          <span class="hits">55495</span>
          
          <code class="ruby">      timestep_items = items[tstep * timestep_minutes, timestep_minutes]</code>
        </li>
      
        <li class="covered" data-hits="55495" data-linenumber="640">
          <span class="hits">55495</span>
          
          <code class="ruby">      avgitem = timestep_items.reduce(:+).to_f / timestep_items.size</code>
        </li>
      
        <li class="covered" data-hits="55495" data-linenumber="641">
          <span class="hits">55495</span>
          
          <code class="ruby">      data.push(avgitem)</code>
        </li>
      
        <li class="covered" data-hits="55495" data-linenumber="642">
          <span class="hits">55495</span>
          
          <code class="ruby">      if (tstep + 1) * timestep_minutes &gt; weeks_in_minutes</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="643">
          <span class="hits">55</span>
          
          <code class="ruby">        break # no need to process more data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="644">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="646">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="647">
          <span class="hits">55</span>
          
          <code class="ruby">    return data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="650">
          <span class="hits">1</span>
          
          <code class="ruby">  def loadDrawProfileStatsFromFile()</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="651">
          <span class="hits">55</span>
          
          <code class="ruby">    totflow = 0 # daily gal/day</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="652">
          <span class="hits">55</span>
          
          <code class="ruby">    maxflow = 0</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="653">
          <span class="hits">55</span>
          
          <code class="ruby">    ontime = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="654">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="655">
          <span class="hits">55</span>
          
          <code class="ruby">    column_header = @file_prefix</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="657">
          <span class="hits">55</span>
          
          <code class="ruby">    totflow_column_header = &quot;#{column_header} Sum&quot;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="658">
          <span class="hits">55</span>
          
          <code class="ruby">    maxflow_column_header = &quot;#{column_header} Max&quot;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="659">
          <span class="hits">55</span>
          
          <code class="ruby">    ontime_column_header = &quot;On-time Fraction&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="660">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="661">
          <span class="hits">55</span>
          
          <code class="ruby">    draw_file = File.join(File.dirname(__FILE__), &quot;HotWaterMinuteDrawProfilesMaxFlows.csv&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="662">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="663">
          <span class="hits">55</span>
          
          <code class="ruby">    datafound = false</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="664">
          <span class="hits">55</span>
          
          <code class="ruby">    skippedheader = false</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="665">
          <span class="hits">55</span>
          
          <code class="ruby">    totflow_col_num = nil</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="666">
          <span class="hits">55</span>
          
          <code class="ruby">    maxflow_col_num = nil</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="667">
          <span class="hits">55</span>
          
          <code class="ruby">    ontime_col_num = nil</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="668">
          <span class="hits">55</span>
          
          <code class="ruby">    File.open(draw_file).each do |line|</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="669">
          <span class="hits">220</span>
          
          <code class="ruby">      linedata = line.strip.split(&#39;,&#39;)</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="670">
          <span class="hits">220</span>
          
          <code class="ruby">      if not skippedheader</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="671">
          <span class="hits">55</span>
          
          <code class="ruby">        skippedheader = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="672">
          
          
          <code class="ruby">        # Which columns to read?</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="673">
          <span class="hits">55</span>
          
          <code class="ruby">        totflow_col_num = linedata.index(totflow_column_header)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="674">
          <span class="hits">55</span>
          
          <code class="ruby">        maxflow_col_num = linedata.index(maxflow_column_header)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="675">
          <span class="hits">55</span>
          
          <code class="ruby">        ontime_col_num = linedata.index(ontime_column_header)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="676">
          <span class="hits">55</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="677">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="678">
          <span class="hits">165</span>
          
          <code class="ruby">      if linedata[0].to_i == @nbeds</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="679">
          <span class="hits">55</span>
          
          <code class="ruby">        datafound = true</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="680">
          <span class="hits">55</span>
          
          <code class="ruby">        if not totflow_col_num.nil?</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="681">
          <span class="hits">55</span>
          
          <code class="ruby">          totflow = linedata[totflow_col_num].to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="683">
          <span class="hits">55</span>
          
          <code class="ruby">        if not maxflow_col_num.nil?</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="684">
          <span class="hits">55</span>
          
          <code class="ruby">          maxflow = linedata[maxflow_col_num].to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="686">
          <span class="hits">55</span>
          
          <code class="ruby">        if not ontime_col_num.nil?</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="687">
          <span class="hits">55</span>
          
          <code class="ruby">          ontime = linedata[ontime_col_num].to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="689">
          <span class="hits">55</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="691">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="692">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="693">
          <span class="hits">55</span>
          
          <code class="ruby">    if not datafound</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="694">
          
          
          <code class="ruby">      @runner.registerError(&quot;Unable to find data for bedrooms = #{@nbeds}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="695">
          
          
          <code class="ruby">      return nil, nil, nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="696">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="697">
          <span class="hits">55</span>
          
          <code class="ruby">    return totflow, maxflow, ontime</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="699">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="700">
          <span class="hits">1</span>
          
          <code class="ruby">  def createSchedule(data, timestep_minutes, weeks)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="701">
          <span class="hits">55</span>
          
          <code class="ruby">    if data.size == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="702">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="703">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="704">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="705">
          <span class="hits">55</span>
          
          <code class="ruby">    year_description = @model.getYearDescription</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="706">
          <span class="hits">55</span>
          
          <code class="ruby">    assumed_year = year_description.assumedYear</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="707">
          <span class="hits">55</span>
          
          <code class="ruby">    num_days_in_year = Constants.NumDaysInYear(year_description.isLeapYear)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="709">
          <span class="hits">55</span>
          
          <code class="ruby">    time = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="710">
          <span class="hits">55</span>
          
          <code class="ruby">    (timestep_minutes..24 * 60).step(timestep_minutes).to_a.each_with_index do |m, i|</code>
        </li>
      
        <li class="covered" data-hits="7920" data-linenumber="711">
          <span class="hits">7920</span>
          
          <code class="ruby">      time[i] = OpenStudio::Time.new(0, 0, m, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="714">
          <span class="hits">55</span>
          
          <code class="ruby">    schedule = OpenStudio::Model::ScheduleRuleset.new(@model)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="715">
          <span class="hits">55</span>
          
          <code class="ruby">    schedule.setName(@sch_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="717">
          <span class="hits">55</span>
          
          <code class="ruby">    schedule_rules = []</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="718">
          <span class="hits">55</span>
          
          <code class="ruby">    for d in 1..7 * weeks # how many unique day schedules</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="719">
          <span class="hits">385</span>
          
          <code class="ruby">      next if d &gt; num_days_in_year</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="721">
          <span class="hits">385</span>
          
          <code class="ruby">      rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="722">
          <span class="hits">385</span>
          
          <code class="ruby">      rule.setName(@sch_name + &quot; #{Schedule.allday_name} ruleset#{d}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="723">
          <span class="hits">385</span>
          
          <code class="ruby">      day_schedule = rule.daySchedule</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="724">
          <span class="hits">385</span>
          
          <code class="ruby">      day_schedule.setName(@sch_name + &quot; #{Schedule.allday_name}#{d}&quot;)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="725">
          <span class="hits">385</span>
          
          <code class="ruby">      previous_value = data[(d - 1) * 24 * 60 / timestep_minutes]</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="726">
          <span class="hits">385</span>
          
          <code class="ruby">      time.each_with_index do |m, i|</code>
        </li>
      
        <li class="covered" data-hits="55440" data-linenumber="727">
          <span class="hits">55440</span>
          
          <code class="ruby">        if i != time.length - 1</code>
        </li>
      
        <li class="covered" data-hits="55055" data-linenumber="728">
          <span class="hits">55055</span>
          
          <code class="ruby">          next if data[i + 1 + (d - 1) * 24 * 60 / timestep_minutes] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="4952" data-linenumber="730">
          <span class="hits">4952</span>
          
          <code class="ruby">        day_schedule.addValue(m, previous_value)</code>
        </li>
      
        <li class="covered" data-hits="4952" data-linenumber="731">
          <span class="hits">4952</span>
          
          <code class="ruby">        previous_value = data[i + 1 + (d - 1) * 24 * 60 / timestep_minutes]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="732">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="733">
          <span class="hits">385</span>
          
          <code class="ruby">      Schedule.set_weekday_rule(rule)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="734">
          <span class="hits">385</span>
          
          <code class="ruby">      Schedule.set_weekend_rule(rule)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="735">
          <span class="hits">385</span>
          
          <code class="ruby">      for w in 0..52 # max num of weeks</code>
        </li>
      
        <li class="covered" data-hits="20405" data-linenumber="736">
          <span class="hits">20405</span>
          
          <code class="ruby">        next if d + (w * 7 * weeks) &gt; num_days_in_year</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="737">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20075" data-linenumber="738">
          <span class="hits">20075</span>
          
          <code class="ruby">        date_s = OpenStudio::Date::fromDayOfYear(d + (w * 7 * weeks), assumed_year)</code>
        </li>
      
        <li class="covered" data-hits="20075" data-linenumber="739">
          <span class="hits">20075</span>
          
          <code class="ruby">        rule.addSpecificDate(date_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="740">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="741">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="743">
          <span class="hits">55</span>
          
          <code class="ruby">    Schedule.set_schedule_type_limits(@model, schedule, @schedule_type_limits_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="744">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="745">
          <span class="hits">55</span>
          
          <code class="ruby">    return schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="747">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="748">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="749">
          <span class="hits">1</span>
          
          <code class="ruby">class Schedule</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="750">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.allday_name</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="751">
          <span class="hits">770</span>
          
          <code class="ruby">    return &#39;allday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="752">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="754">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.weekday_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="755">
          
          
          <code class="ruby">    return &#39;weekday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="758">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.weekend_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="759">
          
          
          <code class="ruby">    return &#39;weekend&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="761">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby">  # find the maximum profile value for a schedule</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="763">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.getMinMaxAnnualProfileValue(model, schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">    if not schedule.to_ScheduleRuleset.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="765">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="766">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="767">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="768">
          
          
          <code class="ruby">    schedule = schedule.to_ScheduleRuleset.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="769">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="770">
          
          
          <code class="ruby">    # gather profiles</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="771">
          
          
          <code class="ruby">    profiles = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="772">
          
          
          <code class="ruby">    defaultProfile = schedule.to_ScheduleRuleset.get.defaultDaySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="773">
          
          
          <code class="ruby">    profiles &lt;&lt; defaultProfile</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">    rules = schedule.scheduleRules</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">    rules.each do |rule|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">      profiles &lt;&lt; rule.daySchedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="777">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="779">
          
          
          <code class="ruby">    # test profiles</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="780">
          
          
          <code class="ruby">    min = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="781">
          
          
          <code class="ruby">    max = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="782">
          
          
          <code class="ruby">    profiles.each do |profile|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="783">
          
          
          <code class="ruby">      profile.values.each do |value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="784">
          
          
          <code class="ruby">        if min.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="785">
          
          
          <code class="ruby">          min = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="787">
          
          
          <code class="ruby">          if min &gt; value then min = value end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="788">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="789">
          
          
          <code class="ruby">        if max.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="790">
          
          
          <code class="ruby">          max = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="791">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="792">
          
          
          <code class="ruby">          if max &lt; value then max = value end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="793">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="794">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="796">
          
          
          <code class="ruby">    return { &#39;min&#39; =&gt; min, &#39;max&#39; =&gt; max } # this doesn&#39;t include summer and winter design day</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="797">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="798">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="799">
          
          
          <code class="ruby">  # return [Double] The total number of full load hours for this schedule.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="800">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.annual_equivalent_full_load_hrs(year_description, schedule)</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="801">
          <span class="hits">110</span>
          
          <code class="ruby">    if schedule.to_ScheduleInterval.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="802">
          
          
          <code class="ruby">      timeSeries = schedule.to_ScheduleInterval.get.timeSeries</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="803">
          
          
          <code class="ruby">      annual_flh = timeSeries.averageValue * Constants.NumHoursInYear(year_description.isLeapYear)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="804">
          
          
          <code class="ruby">      return annual_flh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="805">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="806">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="807">
          <span class="hits">110</span>
          
          <code class="ruby">    if not schedule.to_ScheduleRuleset.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="809">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="810">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="811">
          <span class="hits">110</span>
          
          <code class="ruby">    schedule = schedule.to_ScheduleRuleset.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="813">
          
          
          <code class="ruby">    # Define the start and end date</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="814">
          <span class="hits">110</span>
          
          <code class="ruby">    assumed_year = year_description.assumedYear</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="815">
          <span class="hits">110</span>
          
          <code class="ruby">    year_start_date = OpenStudio::Date.new(OpenStudio::MonthOfYear.new(1), 1, assumed_year)</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="816">
          <span class="hits">110</span>
          
          <code class="ruby">    year_end_date = OpenStudio::Date.new(OpenStudio::MonthOfYear.new(12), 31, assumed_year)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby">    # Get the ordered list of all the day schedules</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="819">
          
          
          <code class="ruby">    # that are used by this schedule ruleset</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="820">
          <span class="hits">110</span>
          
          <code class="ruby">    day_schs = schedule.getDaySchedules(year_start_date, year_end_date)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="822">
          
          
          <code class="ruby">    # Get a 365/366-value array of which schedule is used on each day of the year,</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="823">
          <span class="hits">110</span>
          
          <code class="ruby">    day_schs_used_each_day = schedule.getActiveRuleIndices(year_start_date, year_end_date)</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="824">
          <span class="hits">110</span>
          
          <code class="ruby">    if ![365, 366].include? day_schs_used_each_day.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="825">
          
          
          <code class="ruby">      OpenStudio::logFree(OpenStudio::Error, &quot;openstudio.standards.ScheduleRuleset&quot;, &quot;#{schedule.name} does not have 365/366 daily schedules accounted for, cannot accurately calculate annual EFLH.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="826">
          
          
          <code class="ruby">      return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="827">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby">    # Create a map that shows how many days each schedule is used</code>
        </li>
      
        <li class="covered" data-hits="40260" data-linenumber="830">
          <span class="hits">40260</span>
          
          <code class="ruby">    day_sch_freq = day_schs_used_each_day.group_by { |n| n }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="831">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="832">
          
          
          <code class="ruby">    # Build a hash that maps schedule day index to schedule day</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="833">
          <span class="hits">110</span>
          
          <code class="ruby">    schedule_index_to_day = {}</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="834">
          <span class="hits">110</span>
          
          <code class="ruby">    for i in 0..(day_schs.length - 1)</code>
        </li>
      
        <li class="covered" data-hits="40150" data-linenumber="835">
          <span class="hits">40150</span>
          
          <code class="ruby">      schedule_index_to_day[day_schs_used_each_day[i]] = day_schs[i]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="837">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="838">
          
          
          <code class="ruby">    # Loop through each of the schedules that is used, figure out the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="839">
          
          
          <code class="ruby">    # full load hours for that day, then multiply this by the number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="840">
          
          
          <code class="ruby">    # of days that day schedule applies and add this to the total.</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="841">
          <span class="hits">110</span>
          
          <code class="ruby">    annual_flh = 0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="842">
          <span class="hits">110</span>
          
          <code class="ruby">    max_daily_flh = 0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="843">
          <span class="hits">110</span>
          
          <code class="ruby">    default_day_sch = schedule.defaultDaySchedule</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="844">
          <span class="hits">110</span>
          
          <code class="ruby">    day_sch_freq.each do |freq|</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="845">
          <span class="hits">770</span>
          
          <code class="ruby">      sch_index = freq[0]</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="846">
          <span class="hits">770</span>
          
          <code class="ruby">      number_of_days_sch_used = freq[1].size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="847">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="848">
          
          
          <code class="ruby">      # Get the day schedule at this index</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="849">
          <span class="hits">770</span>
          
          <code class="ruby">      day_sch = nil</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="850">
          <span class="hits">770</span>
          
          <code class="ruby">      if sch_index == -1 # If index = -1, this day uses the default day schedule (not a rule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="851">
          
          
          <code class="ruby">        day_sch = default_day_sch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="852">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="853">
          <span class="hits">770</span>
          
          <code class="ruby">        day_sch = schedule_index_to_day[sch_index]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="855">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="856">
          
          
          <code class="ruby">      # Determine the full load hours for just one day</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="857">
          <span class="hits">770</span>
          
          <code class="ruby">      daily_flh = 0</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="858">
          <span class="hits">770</span>
          
          <code class="ruby">      values = day_sch.values</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="859">
          <span class="hits">770</span>
          
          <code class="ruby">      times = day_sch.times</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="860">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="861">
          <span class="hits">770</span>
          
          <code class="ruby">      previous_time_decimal = 0</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="862">
          <span class="hits">770</span>
          
          <code class="ruby">      for i in 0..(times.length - 1)</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="863">
          <span class="hits">9904</span>
          
          <code class="ruby">        time_days = times[i].days</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="864">
          <span class="hits">9904</span>
          
          <code class="ruby">        time_hours = times[i].hours</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="865">
          <span class="hits">9904</span>
          
          <code class="ruby">        time_minutes = times[i].minutes</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="866">
          <span class="hits">9904</span>
          
          <code class="ruby">        time_seconds = times[i].seconds</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="867">
          <span class="hits">9904</span>
          
          <code class="ruby">        time_decimal = (time_days * 24.0) + time_hours + (time_minutes / 60.0) + (time_seconds / 3600.0)</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="868">
          <span class="hits">9904</span>
          
          <code class="ruby">        duration_of_value = time_decimal - previous_time_decimal</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="869">
          <span class="hits">9904</span>
          
          <code class="ruby">        daily_flh += values[i] * duration_of_value</code>
        </li>
      
        <li class="covered" data-hits="9904" data-linenumber="870">
          <span class="hits">9904</span>
          
          <code class="ruby">        previous_time_decimal = time_decimal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="871">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="872">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="873">
          
          
          <code class="ruby">      # Multiply the daily EFLH by the number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="874">
          
          
          <code class="ruby">      # of days this schedule is used per year</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby">      # and add this to the overall total</code>
        </li>
      
        <li class="covered" data-hits="770" data-linenumber="876">
          <span class="hits">770</span>
          
          <code class="ruby">      annual_flh += daily_flh * number_of_days_sch_used</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="877">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="878">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="879">
          
          
          <code class="ruby">    # Warn if the max daily EFLH is more than 24,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="880">
          
          
          <code class="ruby">    # which would indicate that this isn&#39;t a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="881">
          
          
          <code class="ruby">    # fractional schedule.</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="882">
          <span class="hits">110</span>
          
          <code class="ruby">    if max_daily_flh &gt; 24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="883">
          
          
          <code class="ruby">      OpenStudio::logFree(OpenStudio::Warn, &quot;openstudio.standards.ScheduleRuleset&quot;, &quot;#{schedule.name} has more than 24 EFLH in one day schedule, indicating that it is not a fractional schedule.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="884">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="885">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="886">
          <span class="hits">110</span>
          
          <code class="ruby">    return annual_flh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="887">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="888">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="889">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ruleset_from_fixedinterval(model, hrly_sched, sch_name, winter_design_day_sch, summer_design_day_sch)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="890">
          
          
          <code class="ruby">    # Returns schedule rules from a fixed interval object (60 min interval only)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="891">
          
          
          <code class="ruby">    year_description = model.getYearDescription</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="892">
          
          
          <code class="ruby">    assumed_year = year_description.assumedYear</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="893">
          
          
          <code class="ruby">    run_period = model.getRunPeriod</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="894">
          
          
          <code class="ruby">    run_period_start = Time.new(assumed_year, run_period.getBeginMonth, run_period.getBeginDayOfMonth)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="895">
          
          
          <code class="ruby">    start_day = run_period_start.yday</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="896">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="897">
          
          
          <code class="ruby">    hrly_sched = hrly_sched.timeSeries.values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="898">
          
          
          <code class="ruby">    hrs = hrly_sched.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="899">
          
          
          <code class="ruby">    days = hrs / 24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="900">
          
          
          <code class="ruby">    time = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="901">
          
          
          <code class="ruby">    for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="902">
          
          
          <code class="ruby">      time[h] = OpenStudio::Time.new(0, h, 0, 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="903">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="904">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="905">
          
          
          <code class="ruby">    schedule = OpenStudio::Model::ScheduleRuleset.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="906">
          
          
          <code class="ruby">    schedule.setName(sch_name + &quot; ruleset&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="907">
          
          
          <code class="ruby">    previous_value = hrly_sched[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="908">
          
          
          <code class="ruby">    day_rule_prev = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="909">
          
          
          <code class="ruby">    day_rule_prev.setName(&quot;DUMMY&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="910">
          
          
          <code class="ruby">    day_sched_prev = day_rule_prev.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="911">
          
          
          <code class="ruby">    day_sched_prev.setName(&quot;DUMMY&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="913">
          
          
          <code class="ruby">    for day in start_day..start_day + days - 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="914">
          
          
          <code class="ruby">      day_rule = OpenStudio::Model::ScheduleRule.new(schedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="915">
          
          
          <code class="ruby">      day_rule.setName(&quot;#{sch_name} rule day #{day}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="916">
          
          
          <code class="ruby">      day_sched = day_rule.daySchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="917">
          
          
          <code class="ruby">      day_sched.setName(&quot;#{sch_name} day schedule&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="918">
          
          
          <code class="ruby">      day_ct = day - start_day + 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="919">
          
          
          <code class="ruby">      previous_value = hrly_sched[(day_ct - 1) * 24]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="920">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="921">
          
          
          <code class="ruby">      for h in 1..24</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="922">
          
          
          <code class="ruby">        hr = (day_ct - 1) * 24 + h - 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="923">
          
          
          <code class="ruby">        next if h != 24 and hrly_sched[hr + 1] == previous_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="924">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="925">
          
          
          <code class="ruby">        day_sched.addValue(time[h], previous_value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="926">
          
          
          <code class="ruby">        if hr != hrs - 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="927">
          
          
          <code class="ruby">          previous_value = hrly_sched[hr + 1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="928">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="929">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="930">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="931">
          
          
          <code class="ruby">      if (day_sched_prev.values != day_sched.values) or (day_sched_prev.times != day_sched.times)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="932">
          
          
          <code class="ruby">        sdate = OpenStudio::Date.fromDayOfYear(day, assumed_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="933">
          
          
          <code class="ruby">        edate = OpenStudio::Date.fromDayOfYear(day, assumed_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="934">
          
          
          <code class="ruby">        day_rule.setStartDate(sdate)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="935">
          
          
          <code class="ruby">        day_rule.setEndDate(edate)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="936">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="937">
          
          
          <code class="ruby">        if day_ct == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="938">
          
          
          <code class="ruby">          day_sched_prev.remove</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="939">
          
          
          <code class="ruby">          day_rule_prev.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="940">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="941">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="942">
          
          
          <code class="ruby">        sdate = day_rule_prev.startDate.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="943">
          
          
          <code class="ruby">        edate = OpenStudio::Date.fromDayOfYear(day, assumed_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="944">
          
          
          <code class="ruby">        day_rule.setStartDate(sdate)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="945">
          
          
          <code class="ruby">        day_rule.setEndDate(edate)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="946">
          
          
          <code class="ruby">        day_sched_prev.remove</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="947">
          
          
          <code class="ruby">        day_rule_prev.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="948">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="949">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="950">
          
          
          <code class="ruby">      day_rule.setApplySunday(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="951">
          
          
          <code class="ruby">      day_rule.setApplyMonday(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="952">
          
          
          <code class="ruby">      day_rule.setApplyTuesday(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="953">
          
          
          <code class="ruby">      day_rule.setApplyWednesday(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="954">
          
          
          <code class="ruby">      day_rule.setApplyThursday(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="955">
          
          
          <code class="ruby">      day_rule.setApplyFriday(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="956">
          
          
          <code class="ruby">      day_rule.setApplySaturday(true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="957">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="958">
          
          
          <code class="ruby">      day_sched_prev = day_sched</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="959">
          
          
          <code class="ruby">      day_rule_prev = day_rule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="960">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="961">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="962">
          
          
          <code class="ruby">    unless winter_design_day_sch.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="963">
          
          
          <code class="ruby">      schedule.setWinterDesignDaySchedule(winter_design_day_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="964">
          
          
          <code class="ruby">      schedule.winterDesignDaySchedule.setName(&quot;#{sch_name} winter design EDIT&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="965">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="966">
          
          
          <code class="ruby">    unless summer_design_day_sch.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="967">
          
          
          <code class="ruby">      schedule.setSummerDesignDaySchedule(summer_design_day_sch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="968">
          
          
          <code class="ruby">      schedule.summerDesignDaySchedule.setName(&quot;#{sch_name} summer design EDIT&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="969">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="970">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="971">
          
          
          <code class="ruby">    return schedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="972">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="973">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="974">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.set_schedule_type_limits(model, schedule, schedule_type_limits_name)</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="975">
          <span class="hits">110</span>
          
          <code class="ruby">    return if schedule_type_limits_name.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="976">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="977">
          <span class="hits">110</span>
          
          <code class="ruby">    schedule_type_limits = nil</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="978">
          <span class="hits">110</span>
          
          <code class="ruby">    model.getScheduleTypeLimitss.each do |stl|</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="979">
          <span class="hits">161</span>
          
          <code class="ruby">      next if stl.name.to_s != schedule_type_limits_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="980">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="103" data-linenumber="981">
          <span class="hits">103</span>
          
          <code class="ruby">      schedule_type_limits = stl</code>
        </li>
      
        <li class="covered" data-hits="103" data-linenumber="982">
          <span class="hits">103</span>
          
          <code class="ruby">      break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="983">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="984">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="985">
          <span class="hits">110</span>
          
          <code class="ruby">    if schedule_type_limits.nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="986">
          <span class="hits">7</span>
          
          <code class="ruby">      schedule_type_limits = OpenStudio::Model::ScheduleTypeLimits.new(model)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="987">
          <span class="hits">7</span>
          
          <code class="ruby">      schedule_type_limits.setName(schedule_type_limits_name)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="988">
          <span class="hits">7</span>
          
          <code class="ruby">      if schedule_type_limits_name == Constants.ScheduleTypeLimitsFraction</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="989">
          <span class="hits">7</span>
          
          <code class="ruby">        schedule_type_limits.setLowerLimitValue(0)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="990">
          <span class="hits">7</span>
          
          <code class="ruby">        schedule_type_limits.setUpperLimitValue(1)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="991">
          <span class="hits">7</span>
          
          <code class="ruby">        schedule_type_limits.setNumericType(&quot;Continuous&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="992">
          
          
          <code class="ruby">      elsif schedule_type_limits_name == Constants.ScheduleTypeLimitsOnOff</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="993">
          
          
          <code class="ruby">        schedule_type_limits.setLowerLimitValue(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="994">
          
          
          <code class="ruby">        schedule_type_limits.setUpperLimitValue(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="995">
          
          
          <code class="ruby">        schedule_type_limits.setNumericType(&quot;Discrete&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="996">
          
          
          <code class="ruby">      elsif schedule_type_limits_name == Constants.ScheduleTypeLimitsTemperature</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="997">
          
          
          <code class="ruby">        schedule_type_limits.setNumericType(&quot;Continuous&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="998">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="999">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1000">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="1001">
          <span class="hits">110</span>
          
          <code class="ruby">    schedule.setScheduleTypeLimits(schedule_type_limits)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1002">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1003">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1004">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.set_weekday_rule(rule)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1005">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplyMonday(true)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1006">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplyTuesday(true)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1007">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplyWednesday(true)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1008">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplyThursday(true)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1009">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplyFriday(true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1010">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1011">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1012">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.set_weekend_rule(rule)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1013">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplySaturday(true)</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="1014">
          <span class="hits">385</span>
          
          <code class="ruby">    rule.setApplySunday(true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1015">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1016">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="384c393ea7b735cce18fd405d761af909be7a8f2">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/unit_conversions.rb</h3>
    <h4><span class="red">33.67 %</span> covered</h4>
    <div>
      <b>294</b> relevant lines. 
      <span class="green"><b>99</b> lines covered</span> and
      <span class="red"><b>195</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UnitConversions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">  # As there is a performance penalty to using OpenStudio&#39;s built-in unit convert()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # method, we use, our own methods here.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.convert(x, from, to, fuel_type = nil, is_leap_year = false)</code>
        </li>
      
        <li class="covered" data-hits="338" data-linenumber="6">
          <span class="hits">338</span>
          
          <code class="ruby">    from.downcase!</code>
        </li>
      
        <li class="covered" data-hits="338" data-linenumber="7">
          <span class="hits">338</span>
          
          <code class="ruby">    to.downcase!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="338" data-linenumber="9">
          <span class="hits">338</span>
          
          <code class="ruby">    return x if from == to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    # Energy</code>
        </li>
      
        <li class="covered" data-hits="338" data-linenumber="12">
          <span class="hits">338</span>
          
          <code class="ruby">    if from == &#39;btu&#39; and to == &#39;j&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">      return x * 1055.05585262</code>
        </li>
      
        <li class="covered" data-hits="338" data-linenumber="14">
          <span class="hits">338</span>
          
          <code class="ruby">    elsif from == &#39;btu&#39; and to == &#39;kwh&#39;</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="15">
          <span class="hits">63</span>
          
          <code class="ruby">      return x / 3412.141633127942</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="16">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;btu&#39; and to == &#39;wh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      return x / 3.412141633127942</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="18">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;j&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">      return x * 3412.141633127942 / 1000.0 / 3600.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="20">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;j&#39; and to == &#39;kbtu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      return x * 3412.141633127942 / 1000.0 / 3600.0 / 1000.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="22">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;j&#39; and to == &#39;kwh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      return x / 3600000.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="24">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;kbtu&#39; and to == &#39;therm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      return x / 100.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="26">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;j&#39; and to == &#39;therm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      return x * 3412.141633127942 / 1000.0 / 3600.0 / 1000.0 / 100.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="28">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;kj&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">      return x * 0.9478171203133172</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="30">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;gj&#39; and to == &#39;mbtu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      return x * 0.9478171203133172</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="32">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;gj&#39; and to == &#39;kwh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      return x * 277.778</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="34">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;gj&#39; and to == &#39;therm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      return x * 9.48043</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="36">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;kwh&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      return x * 3412.141633127942</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="38">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;kwh&#39; and to == &#39;j&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      return x * 3600000.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="40">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;wh&#39; and to == &#39;gj&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      return x * 0.0000036</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="42">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;kwh&#39; and to == &#39;therm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      return x / 29.307107017222222</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="44">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;kwh&#39; and to == &#39;wh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      return x * 1000.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="46">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;mbtu&#39; and to == &#39;wh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      return x * 293071.0701722222</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="48">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;therm&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      return x * 100000.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="50">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;therm&#39; and to == &#39;kbtu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      return x * 100.0</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="52">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;therm&#39; and to == &#39;kwh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      return x * 29.307107017222222</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="54">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;therm&#39; and to == &#39;wh&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      return x * 29307.10701722222</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="56">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;wh&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      return x * 3.412141633127942</code>
        </li>
      
        <li class="covered" data-hits="275" data-linenumber="58">
          <span class="hits">275</span>
          
          <code class="ruby">    elsif from == &#39;wh&#39; and to == &#39;kwh&#39;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="59">
          <span class="hits">55</span>
          
          <code class="ruby">      return x / 1000.0</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="60">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;wh&#39; and to == &#39;therm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      return x / 29307.10701722222</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="62">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;wh&#39; and to == &#39;mbtu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">      return x / 293071.0701722222</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="64">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;kbtu&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">      return x * 1000.0</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="66">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;btu&#39; and to == &#39;gal&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      if fuel_type == Constants.FuelTypePropane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">        return x / 91600.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      elsif fuel_type == Constants.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">        return x / 139000.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      fail &quot;Unhandled unit conversion from #{from} to #{to} for #{fuel_type}.&quot;</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="74">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;gal&#39; and to == &#39;btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      if fuel_type == Constants.FuelTypePropane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">        return x * 91600.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      elsif fuel_type == Constants.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">        return x * 139000.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      fail &quot;Unhandled unit conversion from #{from} to #{to} for #{fuel_type}.&quot;</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="82">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;j&#39; and to == &#39;gal&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">      if fuel_type == Constants.FuelTypePropane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">        return x * 3412.141633127942 / 1000.0 / 3600.0 / 91600.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">      elsif fuel_type == Constants.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">        return x * 3412.141633127942 / 1000.0 / 3600.0 / 139000.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">      fail &quot;Unhandled unit conversion from #{from} to #{to} for #{fuel_type}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    # Power</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="92">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;btu/hr&#39; and to == &#39;ton&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      return x / 12000.0</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="94">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;btu/hr&#39; and to == &#39;w&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      return x * 0.2930710701722222</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="96">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;kbtu/hr&#39; and to == &#39;btu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">      return x * 1000.0</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="98">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;btu/hr&#39; and to == &#39;kbtu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">      return x / 1000.0</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="100">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;kbtu/hr&#39; and to == &#39;w&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      return x * 293.0710701722222</code>
        </li>
      
        <li class="covered" data-hits="220" data-linenumber="102">
          <span class="hits">220</span>
          
          <code class="ruby">    elsif from == &#39;kw&#39; and to == &#39;w&#39;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="103">
          <span class="hits">55</span>
          
          <code class="ruby">      return x * 1000.0</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="104">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;ton&#39; and to == &#39;btu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      return x * 12000.0</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="106">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;ton&#39; and to == &#39;kbtu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">      return x * 12.0</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="108">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;ton&#39; and to == &#39;w&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      return x * 3516.85284207</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="110">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;w&#39; and to == &#39;btu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">      return x * 3.412141633127942</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="112">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;w&#39; and to == &#39;kbtu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      return x / 293.0710701722222</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="114">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;w&#39; and to == &#39;kw&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">      return x / 1000.0</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="116">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;w&#39; and to == &#39;ton&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      return x / 3516.85284207</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="118">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;kw&#39; and to == &#39;kbtu/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">      return x / 0.2930710701722222</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="120">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;kbtu/hr&#39; and to == &#39;kw&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">      return x * 0.2930710701722222</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    # Power Flux</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="124">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;w/m^2&#39; and to == &#39;btu/(hr*ft^2)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">      return x * 0.3169983306281505</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    # Temperature</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="128">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;c&#39; and to == &#39;f&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      return 1.8 * x + 32.0</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="130">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;c&#39; and to == &#39;k&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">      return x + 273.15</code>
        </li>
      
        <li class="covered" data-hits="165" data-linenumber="132">
          <span class="hits">165</span>
          
          <code class="ruby">    elsif from == &#39;f&#39; and to == &#39;c&#39;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="133">
          <span class="hits">55</span>
          
          <code class="ruby">      return (x - 32.0) / 1.8</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="134">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;f&#39; and to == &#39;r&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">      return x + 459.67</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="136">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;k&#39; and to == &#39;c&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      return x - 273.15</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="138">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;k&#39; and to == &#39;r&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">      return x * 1.8</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="140">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;r&#39; and to == &#39;f&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">      return x - 459.67</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="142">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;r&#39; and to == &#39;k&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      return x / 1.8</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    # Specific Heat</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="146">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;btu/(lbm*r)&#39; and to == &#39;j/(kg*k)&#39; # by mass</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">      return x * 4187.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="148">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;btu/(ft^3*f)&#39; and to == &#39;j/(m^3*k)&#39; # by volume</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">      return x * 67100.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="150">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;btu/(lbm*r)&#39; and to == &#39;wh/(kg*k)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">      return x * 1.1632</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">    # Length</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="154">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft&#39; and to == &#39;in&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">      return x * 12.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="156">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft&#39; and to == &#39;m&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">      return x * 0.3048</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="158">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;in&#39; and to == &#39;ft&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      return x / 12.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="160">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;in&#39; and to == &#39;m&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">      return x * 0.0254</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="162">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;m&#39; and to == &#39;ft&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">      return x / 0.3048</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="164">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;m&#39; and to == &#39;in&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">      return x / 0.0254</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="166">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;mm&#39; and to == &#39;m&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      return x / 1000.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">    # Area</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="170">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;cm^2&#39; and to == &#39;ft^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      return x / 929.0304</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="172">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^2&#39; and to == &#39;cm^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">      return x * 929.0304</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="174">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^2&#39; and to == &#39;in^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">      return x * 144.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="176">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^2&#39; and to == &#39;m^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">      return x * 0.09290304</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="178">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;m^2&#39; and to == &#39;ft^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">      return x / 0.09290304</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">    # Volume</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="182">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^3&#39; and to == &#39;gal&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">      return x * 7.480519480579059</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="184">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^3&#39; and to == &#39;l&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">      return x * 28.316846591999997</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="186">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^3&#39; and to == &#39;m^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">      return x * 0.028316846592000004</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="188">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;gal&#39; and to == &#39;ft^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      return x / 7.480519480579059</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="190">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;gal&#39; and to == &#39;in^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">      return x * 231.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="192">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;gal&#39; and to == &#39;m^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">      return x * 0.0037854117839698515</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="194">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;in^3&#39; and to == &#39;gal&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">      return x / 231.0</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="196">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;l&#39; and to == &#39;pint&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">      return x * 2.1133764</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="198">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;l&#39; and to == &#39;ft^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">      return x / 28.316846591999997</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="200">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;m^3&#39; and to == &#39;ft^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">      return x / 0.028316846592000004</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="202">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;m^3&#39; and to == &#39;gal&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      return x / 0.0037854117839698515</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="204">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;pint&#39; and to == &#39;l&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">      return x * 0.47317647</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">    # Mass</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="208">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;lbm&#39; and to == &#39;kg&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">      return x * 0.45359237</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="210">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;kg&#39; and to == &#39;lbm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">      return x / 0.45359237</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">    # Volume Flow Rate</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="214">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;cfm&#39; and to == &#39;m^3/s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">      return x / 2118.880003289315</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="216">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;ft^3/min&#39; and to == &#39;m^3/s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">      return x / 2118.880003289315</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="218">
          <span class="hits">110</span>
          
          <code class="ruby">    elsif from == &#39;gal/min&#39; and to == &#39;m^3/s&#39;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="219">
          <span class="hits">55</span>
          
          <code class="ruby">      return x / 15850.323141615143</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="220">
          <span class="hits">55</span>
          
          <code class="ruby">    elsif from == &#39;m^3/s&#39; and to == &#39;gal/min&#39;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="221">
          <span class="hits">55</span>
          
          <code class="ruby">      return x * 15850.323141615143</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="222">
          
          
          <code class="ruby">    elsif from == &#39;m^3/s&#39; and to == &#39;cfm&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">      return x * 2118.880003289315</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">    elsif from == &#39;m^3/s&#39; and to == &#39;ft^3/min&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="225">
          
          
          <code class="ruby">      return x * 2118.880003289315</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    # Mass Flow Rate</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="228">
          
          
          <code class="ruby">    elsif from == &#39;lbm/min&#39; and to == &#39;kg/hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="229">
          
          
          <code class="ruby">      return x * 27.2155422</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="230">
          
          
          <code class="ruby">    elsif from == &#39;lbm/min&#39; and to == &#39;kg/s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">      return x * 27.2155422 / 3600.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    # Time</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">    elsif from == &#39;day&#39; and to == &#39;hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">      return x * 24.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">    elsif from == &#39;day&#39; and to == &#39;yr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="237">
          
          
          <code class="ruby">      return x / Constants.NumDaysInYear(is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="238">
          
          
          <code class="ruby">    elsif from == &#39;hr&#39; and to == &#39;min&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">      return x * 60.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="240">
          
          
          <code class="ruby">    elsif from == &#39;hr&#39; and to == &#39;s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">      return x * 3600.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">    elsif from == &#39;hr&#39; and to == &#39;yr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">      return x / Constants.NumHoursInYear(is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">    elsif from == &#39;min&#39; and to == &#39;hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">      return x / 60.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">    elsif from == &#39;min&#39; and to == &#39;s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      return x * 60.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">    elsif from == &#39;yr&#39; and to == &#39;day&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">      return x * Constants.NumDaysInYear(is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">    elsif from == &#39;yr&#39; and to == &#39;hr&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">      return x * Constants.NumHoursInYear(is_leap_year)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    # Velocity</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">    elsif from == &#39;knots&#39; and to == &#39;m/s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">      return x * 0.51444444</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">    elsif from == &#39;mph&#39; and to == &#39;m/s&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">      return x * 0.44704</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    elsif from == &#39;m/s&#39; and to == &#39;knots&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">      return x * 1.9438445</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">    elsif from == &#39;m/s&#39; and to == &#39;mph&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">      return x * 2.2369363</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">    # Pressure &amp; Density</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">    elsif from == &#39;atm&#39; and to == &#39;btu/ft^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">      return x * 2.719</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    elsif from == &#39;atm&#39; and to == &#39;kpa&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">      return x * 101.325</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">    elsif from == &#39;atm&#39; and to == &#39;psi&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">      return x * 14.692</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">    elsif from == &#39;inh2o&#39; and to == &#39;pa&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">      return x * 249.1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">    elsif from == &#39;kg/m^3&#39; and to == &#39;lbm/ft^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">      return x / 16.02</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">    elsif from == &#39;kpa&#39; and to == &#39;psi&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">      return x / 6.89475729</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">    elsif from == &#39;lbm/(ft*s^2)&#39; and to == &#39;inh2o&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">      return x * 0.005974</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">    elsif from == &#39;lbm/ft^3&#39; and to == &#39;inh2o/mph^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">      return x * 0.01285</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">    elsif from == &#39;lbm/ft^3&#39; and to == &#39;kg/m^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="281">
          
          
          <code class="ruby">      return x * 16.02</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">    elsif from == &#39;psi&#39; and to == &#39;btu/ft^3&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">      return x * 0.185</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">    elsif from == &#39;psi&#39; and to == &#39;kpa&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">      return x * 6.89475729</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">    elsif from == &#39;psi&#39; and to == &#39;pa&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">      return x * 6.89475729 * 1000.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">    elsif from == &#39;pa&#39; and to == &#39;psi&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">      return x / 6895.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">    # Angles</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="292">
          
          
          <code class="ruby">    elsif from == &#39;deg&#39; and to == &#39;rad&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">      return x / 57.29578</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">    elsif from == &#39;rad&#39; and to == &#39;deg&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">      return x * 57.29578</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">    # R-Value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">    elsif from == &#39;hr*ft^2*f/btu&#39; and to == &#39;m^2*k/w&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">      return x * 0.1761</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">    elsif from == &#39;m^2*k/w&#39; and to == &#39;hr*ft^2*f/btu&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">      return x / 0.1761</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">    # U-Factor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">    elsif from == &#39;btu/(hr*ft^2*f)&#39; and to == &#39;w/(m^2*k)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">      return x * 5.678</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">    elsif from == &#39;w/(m^2*k)&#39; and to == &#39;btu/(hr*ft^2*f)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">      return x / 5.678</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">    # UA</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">    elsif from == &#39;btu/(hr*f)&#39; and to == &#39;w/k&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">      return x * 0.5275</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">    elsif from == &#39;w/k&#39; and to == &#39;btu/(hr*f)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">      return x / 0.5275</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">    # Thermal Conductivity</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">    elsif from == &#39;w/(m*k)&#39; and to == &#39;btu/(hr*ft*r)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">      return x / 1.731</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">    elsif from == &#39;btu/(hr*ft*r)&#39; and to == &#39;w/(m*k)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">      return x * 1.731</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">    elsif from == &#39;btu*in/(hr*ft^2*r)&#39; and to == &#39;w/(m*k)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">      return x * 0.14425</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">    # Infiltration</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">    elsif from == &#39;ft^2/(s^2*r)&#39; and to == &#39;l^2/(s^2*cm^4*k)&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">      return x * 0.001672</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">    elsif from == &#39;inh2o/mph^2&#39; and to == &#39;pa*s^2/m^2&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">      return x * 1246.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">    elsif from == &#39;inh2o/r&#39; and to == &#39;pa/k&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">      return x * 448.4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">    # Humidity</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">    elsif from == &#39;lbm/lbm&#39; and to == &#39;grains&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">      return x * 7000.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">    fail &quot;Unhandled unit conversion from #{from} to #{to}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="339">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_scalar_unit_conversion(var_name, old_units, fuel_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">    if old_units == &quot;m3&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">      old_units = &quot;m^3&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">    new_units = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">    if [&quot;J&quot;, &quot;m^3&quot;, &quot;m3&quot;].include? old_units</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">      if var_name.downcase.include? &quot;electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">        new_units = &quot;kWh&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">      elsif var_name.downcase.include? &quot;gas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">        new_units = &quot;therm&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">        new_units = &quot;gal&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">      return new_units, self.convert(1.0, old_units, new_units, fuel_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="355">
          
          
          <code class="ruby">      return nil, nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b4eac09eb29ede414a3f438670ed93c930701d59">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/util.rb</h3>
    <h4><span class="red">8.26 %</span> covered</h4>
    <div>
      <b>835</b> relevant lines. 
      <span class="green"><b>69</b> lines covered</span> and
      <span class="red"><b>766</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Add classes or functions here than can be used across a variety of our python classes and modules.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;constants&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class HelperMethods</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.eplus_fuel_map(fuel)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    if fuel == Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      return &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    elsif fuel == Constants.FuelTypeGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      return &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    elsif fuel == Constants.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">      return &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    elsif fuel == Constants.FuelTypePropane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      return &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    elsif fuel == Constants.FuelTypeWood</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      return &quot;OtherFuel1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reverse_eplus_fuel_map(fuel)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    if fuel == &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">      return Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    elsif fuel == &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      return Constants.FuelTypeGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    elsif fuel == &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      return Constants.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    elsif fuel == &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      return Constants.FuelTypePropane</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    elsif fuel == &quot;OtherFuel1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">      return Constants.FuelTypeWood</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reverse_openstudio_fuel_map(fuel)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    if fuel == &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      return Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    elsif fuel == &quot;Gas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      return Constants.FuelTypeGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    elsif fuel == &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      return Constants.FuelTypeOil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    elsif fuel == &quot;Propane&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">      return Constants.FuelTypePropane</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove_unused_constructions_and_materials(model, runner)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    # Code from https://bcl.nrel.gov/node/82267 (remove_orphan_objects_and_unused_resources measure)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    model.getConstructions.sort.each do |resource|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      if resource.directUseCount == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">        runner.registerInfo(&quot;Removed construction &#39;#{resource.name}&#39; because it was orphaned.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">        resource.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    model.getMaterials.sort.each do |resource|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">      if resource.directUseCount == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">        runner.registerInfo(&quot;Removed material &#39;#{resource.name}&#39; because it was orphaned.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">        resource.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.state_code_map</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    return { &quot;Alabama&quot; =&gt; &quot;AL&quot;, &quot;Alaska&quot; =&gt; &quot;AK&quot;, &quot;Arizona&quot; =&gt; &quot;AZ&quot;, &quot;Arkansas&quot; =&gt; &quot;AR&quot;, &quot;California&quot; =&gt; &quot;CA&quot;, &quot;Colorado&quot; =&gt; &quot;CO&quot;, &quot;Connecticut&quot; =&gt; &quot;CT&quot;, &quot;Delaware&quot; =&gt; &quot;DE&quot;, &quot;District of Columbia&quot; =&gt; &quot;DC&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">             &quot;Florida&quot; =&gt; &quot;FL&quot;, &quot;Georgia&quot; =&gt; &quot;GA&quot;, &quot;Hawaii&quot; =&gt; &quot;HI&quot;, &quot;Idaho&quot; =&gt; &quot;ID&quot;, &quot;Illinois&quot; =&gt; &quot;IL&quot;, &quot;Indiana&quot; =&gt; &quot;IN&quot;, &quot;Iowa&quot; =&gt; &quot;IA&quot;, &quot;Kansas&quot; =&gt; &quot;KS&quot;, &quot;Kentucky&quot; =&gt; &quot;KY&quot;, &quot;Louisiana&quot; =&gt; &quot;LA&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">             &quot;Maine&quot; =&gt; &quot;ME&quot;, &quot;Maryland&quot; =&gt; &quot;MD&quot;, &quot;Massachusetts&quot; =&gt; &quot;MA&quot;, &quot;Michigan&quot; =&gt; &quot;MI&quot;, &quot;Minnesota&quot; =&gt; &quot;MN&quot;, &quot;Mississippi&quot; =&gt; &quot;MS&quot;, &quot;Missouri&quot; =&gt; &quot;MO&quot;, &quot;Montana&quot; =&gt; &quot;MT&quot;, &quot;Nebraska&quot; =&gt; &quot;NE&quot;, &quot;Nevada&quot; =&gt; &quot;NV&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">             &quot;New Hampshire&quot; =&gt; &quot;NH&quot;, &quot;New Jersey&quot; =&gt; &quot;NJ&quot;, &quot;New Mexico&quot; =&gt; &quot;NM&quot;, &quot;New York&quot; =&gt; &quot;NY&quot;, &quot;North Carolina&quot; =&gt; &quot;NC&quot;, &quot;North Dakota&quot; =&gt; &quot;ND&quot;, &quot;Ohio&quot; =&gt; &quot;OH&quot;, &quot;Oklahoma&quot; =&gt; &quot;OK&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">             &quot;Oregon&quot; =&gt; &quot;OR&quot;, &quot;Pennsylvania&quot; =&gt; &quot;PA&quot;, &quot;Puerto Rico&quot; =&gt; &quot;PR&quot;, &quot;Rhode Island&quot; =&gt; &quot;RI&quot;, &quot;South Carolina&quot; =&gt; &quot;SC&quot;, &quot;South Dakota&quot; =&gt; &quot;SD&quot;, &quot;Tennessee&quot; =&gt; &quot;TN&quot;, &quot;Texas&quot; =&gt; &quot;TX&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">             &quot;Utah&quot; =&gt; &quot;UT&quot;, &quot;Vermont&quot; =&gt; &quot;VT&quot;, &quot;Virginia&quot; =&gt; &quot;VA&quot;, &quot;Washington&quot; =&gt; &quot;WA&quot;, &quot;West Virginia&quot; =&gt; &quot;WV&quot;, &quot;Wisconsin&quot; =&gt; &quot;WI&quot;, &quot;Wyoming&quot; =&gt; &quot;WY&quot; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">class MathTools</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.valid_float?(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    !!Float(str) rescue false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.interp2(x, x0, x1, f0, f1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    Returns the linear interpolation between two results.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    return f0 + ((x - x0) / (x1 - x0)) * (f1 - f0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.interp4(x, y, x1, x2, y1, y2, fx1y1, fx1y2, fx2y1, fx2y2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    Returns the bilinear interpolation between four results.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    return (fx1y1 / ((x2 - x1) * (y2 - y1))) * (x2 - x) * (y2 - y) \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">          + (fx2y1 / ((x2 - x1) * (y2 - y1))) * (x - x1) * (y2 - y) \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">          + (fx1y2 / ((x2 - x1) * (y2 - y1))) * (x2 - x) * (y - y1) \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">          + (fx2y2 / ((x2 - x1) * (y2 - y1))) * (x - x1) * (y - y1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.biquadratic(x, y, c)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">        Calculate the result of a biquadratic polynomial with independent variables</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">        x and y, and a list of coefficients, c:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">        z = c[1] + c[2]*x + c[3]*x**2 + c[4]*y + c[5]*y**2 + c[6]*x*y</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">        x       float      independent variable 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">        y       float      independent variable 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">        c       tuple      list of 6 coeffients [floats]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">        z       float      result of biquadratic polynomial</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">    if c.length != 6</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      puts &quot;Error: There must be 6 coefficients in a biquadratic polynomial&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">    z = c[0] + c[1] * x + c[2] * x**2 + c[3] * y + c[4] * y**2 + c[5] * y * x</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    return z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.quadratic(x, c)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">        Calculate the result of a quadratic polynomial with independent variable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">        x and a list of coefficients, c:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">        y = c[1] + c[2]*x + c[3]*x**2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">        x       float      independent variable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">        c       tuple      list of 6 coeffients [floats]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">        y       float      result of biquadratic polynomial</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">    if c.size != 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">      puts &quot;Error: There must be 3 coefficients in a quadratic polynomial&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    y = c[0] + c[1] * x + c[2] * x**2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">    return y</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.bicubic(x, y, c)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">        Calculate the result of a bicubic polynomial with independent variables</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">        x and y, and a list of coefficients, c:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">        z = c[1] + c[2]*x + c[3]*y + c[4]*x**2 + c[5]*x*y + c[6]*y**2 + \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">            c[7]*x**3 + c[8]*y*x**2 + c[9]*x*y**2 + c[10]*y**3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">        x       float      independent variable 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">        y       float      independent variable 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">        c       tuple      list of 10 coeffients [floats]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">        z       float      result of bicubic polynomial</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">    if c.size != 10</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      puts &quot;Error: There must be 10 coefficients in a bicubic polynomial&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">    z = c[0] + c[1] * x + c[2] * y + c[3] * x**2 + c[4] * x * y + c[5] * y**2 + \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">        c[6] * x**3 + c[7] * y * x**2 + c[8] * x * y**2 + c[9] * y**3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">    return z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.Iterate(x0, f0, x1, f1, x2, f2, icount, cvg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    Description:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    ------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">        Determine if a guess is within tolerance for convergence</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">        if not, output a new guess using the Newton-Raphson method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">    Source:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">        Based on XITERATE f77 code in ResAC (Brandemuehl)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">    Inputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    -------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">        x0      float    current guess value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">        f0      float    value of function f(x) at current guess value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">        x1,x2   floats   previous two guess values, used to create quadratic</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">                         (or linear fit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">        f1,f2   floats   previous two values of f(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">        icount  int      iteration count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">        cvg     bool     Has the iteration reached convergence?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">    Outputs:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">        x_new   float    new guess value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">        cvg     bool     Has the iteration reached convergence?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">        x1,x2   floats   updated previous two guess values, used to create quadratic</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">                         (or linear fit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">        f1,f2   floats   updated previous two values of f(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">    Example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">    --------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">        # Find a value of x that makes f(x) equal to some specific value f:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">        # initial guess (all values of x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">        x = 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">        x1 = x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">        x2 = x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">        # initial error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">        error = f - f(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">        error1 = error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">        error2 = error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">        itmax = 50  # maximum iterations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">        cvg = False # initialize convergence to &quot;False&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">        for i in range(1,itmax+1):</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">            error = f - f(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">            x,cvg,x1,error1,x2,error2 = \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">                                     Iterate(x,error,x1,error1,x2,error2,i,cvg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">            if cvg:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">                break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">        if cvg:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">            print &quot;x converged after&quot;, i, :iterations&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">        else:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">            print &quot;x did NOT converge after&quot;, i, &quot;iterations&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">        print &quot;x, when f(x) is&quot;, f,&quot;is&quot;, x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">    &#39;&#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">    tolRel = 1e-5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">    dx = 0.1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    # Test for convergence</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="230">
          
          
          <code class="ruby">    if ((x0 - x1).abs &lt; tolRel * [x0.abs, Constants.small].max and icount != 1) or f0 == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">      x_new = x0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">      cvg = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">      cvg = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">      if icount == 1 # Perturbation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="237">
          
          
          <code class="ruby">        mode = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="238">
          
          
          <code class="ruby">      elsif icount == 2 # Linear fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">        mode = 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">      else # Quadratic fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">        mode = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">      if mode == 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">        # Quadratic fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">        if x0 == x1 # If two xi are equal, use a linear fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">          x1 = x2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">          f1 = f2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">          mode = 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">        elsif x0 == x2 # If two xi are equal, use a linear fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">          mode = 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">          # Set up quadratic coefficients</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">          c = ((f2 - f0) / (x2 - x0) - (f1 - f0) / (x1 - x0)) / (x2 - x1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">          b = (f1 - f0) / (x1 - x0) - (x1 + x0) * c</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">          a = f0 - (b + c * x0) * x0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">          if c.abs &lt; Constants.small # If points are co-linear, use linear fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">            mode = 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">          elsif ((a + (b + c * x1) * x1 - f1) / f1).abs &gt; Constants.small</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">            # If coefficients do not accurately predict data points due to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">            # round-off, use linear fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="263">
          
          
          <code class="ruby">            mode = 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">            d = b**2 - 4.0 * a * c # calculate discriminant to check for real roots</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">            if d &lt; 0.0 # if no real roots, use linear fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">              mode = 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">            else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">              if d &gt; 0.0 # if real unequal roots, use nearest root to recent guess</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">                x_new = (-b + Math.sqrt(d)) / (2 * c)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">                x_other = -x_new - b / c</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">                if (x_new - x0).abs &gt; (x_other - x0).abs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">                  x_new = x_other</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">              else # If real equal roots, use that root</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">                x_new = -b / (2 * c)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">              if f1 * f0 &gt; 0 and f2 * f0 &gt; 0 # If the previous two f(x) were the same sign as the new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">                if f2.abs &gt; f1.abs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="281">
          
          
          <code class="ruby">                  x2 = x1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">                  f2 = f1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">                if f2 * f0 &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">                  x2 = x1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">                  f2 = f1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">              x1 = x0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">              f1 = f0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="297">
          
          
          <code class="ruby">      if mode == 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">        # Linear Fit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">        m = (f1 - f0) / (x1 - x0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">        if m == 0 # If slope is zero, use perturbation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">          mode = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">          x_new = x0 - f0 / m</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">          x2 = x1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">          f2 = f1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">          x1 = x0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">          f1 = f0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">      if mode == 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">        # Perturbation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">        if x0.abs &gt; Constants.small</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">          x_new = x0 * (1 + dx)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">          x_new = dx</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">        x2 = x1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">        f2 = f1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">        x1 = x0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">        f1 = f0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">    return x_new, cvg, x1, f1, x2, f2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="328">
          <span class="hits">1</span>
          
          <code class="ruby">class OutputVariables</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="329">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.zone_indoor_air_wetbulb_temperature(tdb, w, pr)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">    tdb = tdb.collect { |n| UnitConversions.convert(n, &quot;C&quot;, &quot;F&quot;) } # degF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">    pr = pr.collect { |n| UnitConversions.convert(n, &quot;pa&quot;, &quot;psi&quot;) } # psi</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">    twb = [tdb, w, pr].transpose.collect { |x, y, z| Psychrometrics.Twb_fT_w_P(x, y, z) } # degF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    twb = twb.collect { |n| UnitConversions.convert(n, &quot;F&quot;, &quot;C&quot;) } # degC</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">    return twb # degC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="337">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.wetbulb_globe_temperature(twb, mrt)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    twbg = [twb.collect { |n| n * 0.7 }, mrt.collect { |n| n * 0.3 }].transpose.map { |x| x.reduce(:+) } # degC</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">    return twbg # degC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="343">
          <span class="hits">1</span>
          
          <code class="ruby">class OutputMeters</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="344">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_custom_building_unit_meters(model, runner, reporting_frequency, include_enduse_subcategories = false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby">    # Initialize custom meter hash containing meter names and key/var groups</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    custom_meter_infos = {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">    # Get building units</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">    units = Geometry.get_building_units(model, runner)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">    units.each do |unit|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">      # Get all zones in unit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">      thermal_zones = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">      unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="355">
          
          
          <code class="ruby">        thermal_zone = space.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">        unless thermal_zones.include? thermal_zone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="357">
          
          
          <code class="ruby">          thermal_zones &lt;&lt; thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="361">
          
          
          <code class="ruby">      electricity_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="362">
          
          
          <code class="ruby">      electricity_cooling(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="363">
          
          
          <code class="ruby">      electricity_interior_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="364">
          
          
          <code class="ruby">      electricity_exterior_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">      electricity_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">      electricity_fans_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">      electricity_fans_cooling(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">      electricity_pumps_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">      electricity_pumps_cooling(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="370">
          
          
          <code class="ruby">      electricity_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="371">
          
          
          <code class="ruby">      electricity_photovoltaics(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="372">
          
          
          <code class="ruby">      natural_gas_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="373">
          
          
          <code class="ruby">      natural_gas_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="374">
          
          
          <code class="ruby">      natural_gas_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">      fuel_oil_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">      fuel_oil_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">      fuel_oil_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">      propane_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="379">
          
          
          <code class="ruby">      propane_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">      propane_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">      if include_enduse_subcategories</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">        electricity_refrigerator(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">        electricity_clothes_washer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">        electricity_clothes_dryer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">        natural_gas_clothes_dryer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">        propane_clothes_dryer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">        electricity_cooking_range(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">        natural_gas_cooking_range(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="390">
          
          
          <code class="ruby">        propane_cooking_range(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="391">
          
          
          <code class="ruby">        electricity_dishwasher(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">        electricity_plug_loads(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">        electricity_house_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">        electricity_range_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="395">
          
          
          <code class="ruby">        electricity_bath_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="396">
          
          
          <code class="ruby">        electricity_ceiling_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="397">
          
          
          <code class="ruby">        electricity_extra_refrigerator(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">        electricity_freezer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">        electricity_pool_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">        natural_gas_pool_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">        electricity_pool_pump(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="402">
          
          
          <code class="ruby">        electricity_hot_tub_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">        natural_gas_hot_tub_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">        electricity_hot_tub_pump(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="405">
          
          
          <code class="ruby">        natural_gas_grill(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="406">
          
          
          <code class="ruby">        natural_gas_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="407">
          
          
          <code class="ruby">        natural_gas_fireplace(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="408">
          
          
          <code class="ruby">        electricity_well_pump(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">        electricity_garage_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">    results = OpenStudio::IdfObjectVector.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="414">
          
          
          <code class="ruby">    custom_meter_infos.each do |meter_name, custom_meter_info|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="415">
          
          
          <code class="ruby">      next if custom_meter_info[&quot;key_var_groups&quot;].empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">      custom_meter = create_custom_meter(meter_name: meter_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby">                                         fuel_type: custom_meter_info[&quot;fuel_type&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby">                                         key_var_groups: custom_meter_info[&quot;key_var_groups&quot;])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="420">
          
          
          <code class="ruby">      results &lt;&lt; OpenStudio::IdfObject.load(custom_meter).get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="421">
          
          
          <code class="ruby">      results &lt;&lt; OpenStudio::IdfObject.load(&quot;Output:Meter,#{meter_name},#{reporting_frequency};&quot;).get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">    return results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="427">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_custom_meter(meter_name:,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">                               fuel_type:,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">                               key_var_groups:)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    custom_meter = &quot;Meter:Custom,#{meter_name},#{fuel_type}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="431">
          
          
          <code class="ruby">    key_var_groups.each do |key_var_group|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">      key, var = key_var_group</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">      custom_meter += &quot;,#{key},#{var}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="435">
          
          
          <code class="ruby">    custom_meter += &quot;;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">    return custom_meter</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="439">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="440">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="443">
          
          
          <code class="ruby">      heating_equipment = HVAC.existing_heating_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="444">
          
          
          <code class="ruby">      heating_equipment.each do |htg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(htg_equip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="447">
          
          
          <code class="ruby">        if htg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_equip.name}&quot;, &quot;Unitary System Heating Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">          unless htg_coil.is_a? OpenStudio::Model::CoilCoolingWaterToAirHeatPumpEquationFit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">            custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Defrost Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">            custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Crankcase Heater Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">          unless supp_htg_coil.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">            custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supp_htg_coil.name}&quot;, &quot;Heating Coil Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="457">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACBaseboardConvectiveWater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="459">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWaterBaseboard.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="465">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWaterBaseboard.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="466">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="467">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="468">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="469">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="471">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="473">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="477">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="479">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="482">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="483">
          
          
          <code class="ruby">                if supply_component.to_BoilerHotWater.get.fuelType == &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="484">
          
          
          <code class="ruby">                  custom_meter_infos[&quot;Central:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="488">
          
          
          <code class="ruby">                if supply_component.to_BoilerHotWater.get.fuelType == &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">                  custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="491">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="496">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACBaseboardConvectiveElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="497">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_equip.name}&quot;, &quot;Baseboard Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="499">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACFourPipeFanCoil or htg_equip.is_a? OpenStudio::Model::ZoneHVACPackagedTerminalAirConditioner</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="500">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="501">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="502">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="503">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="504">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="507">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWater.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="508">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="509">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="513">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="515">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="518">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="519">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="521">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="522">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="524">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="525">
          
          
          <code class="ruby">                if supply_component.to_BoilerHotWater.get.fuelType == &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="526">
          
          
          <code class="ruby">                  custom_meter_infos[&quot;Central:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="528">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="529">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="530">
          
          
          <code class="ruby">                if supply_component.to_BoilerHotWater.get.fuelType == &quot;Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="531">
          
          
          <code class="ruby">                  custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="532">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="533">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:ElectricityHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="534">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="540">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="542">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="543">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_cooling(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="544">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityCooling&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="546">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="547">
          
          
          <code class="ruby">      cooling_equipment = HVAC.existing_cooling_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="548">
          
          
          <code class="ruby">      cooling_equipment.each do |clg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="549">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(clg_equip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="551">
          
          
          <code class="ruby">        if clg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="552">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{clg_coil.name}&quot;, &quot;Cooling Coil Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="553">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{clg_equip.name}&quot;, &quot;Unitary System Cooling Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="554">
          
          
          <code class="ruby">          unless clg_coil.is_a? OpenStudio::Model::CoilCoolingWaterToAirHeatPumpEquationFit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="555">
          
          
          <code class="ruby">            custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{clg_coil.name}&quot;, &quot;Cooling Coil Crankcase Heater Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="557">
          
          
          <code class="ruby">        elsif clg_equip.is_a? OpenStudio::Model::ZoneHVACPackagedTerminalAirConditioner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="558">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{clg_coil.name}&quot;, &quot;Cooling Coil Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="559">
          
          
          <code class="ruby">        elsif clg_equip.is_a? OpenStudio::Model::ZoneHVACFourPipeFanCoil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="560">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="561">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="562">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="563">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="564">
          
          
          <code class="ruby">              next unless demand_component.to_CoilCoolingWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="566">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilCoolingWater.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="567">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="568">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="574">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="576">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="577">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="580">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="581">
          
          
          <code class="ruby">              next unless supply_component.to_ChillerElectricEIR.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="583">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="584">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Chiller Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="585">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Chiller Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="588">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="589">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="590">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="593">
          
          
          <code class="ruby">      dehumidifiers = HVAC.get_dehumidifiers(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="594">
          
          
          <code class="ruby">      dehumidifiers.each do |dehumidifier|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="595">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{dehumidifier.name}&quot;, &quot;Zone Dehumidifier Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="597">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="598">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="599">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="600">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_interior_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="601">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityInteriorLighting&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="602">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="603">
          
          
          <code class="ruby">      custom_meter_infos[&quot;#{unit.name}:ElectricityInteriorLighting&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;&quot;, &quot;InteriorLights:Electricity:Zone:#{thermal_zone.name}&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="604">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="607">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_exterior_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="608">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityExteriorLighting&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="609">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityExteriorHolidayLighting&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="610">
          
          
          <code class="ruby">    model.getExteriorLightss.each do |exterior_lights|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="611">
          
          
          <code class="ruby">      if exterior_lights.endUseSubcategory.include? Constants.ObjectNameLightingExteriorHoliday</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="612">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityExteriorHolidayLighting&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{exterior_lights.name}&quot;, &quot;Exterior Lights Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="613">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="614">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityExteriorLighting&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{exterior_lights.name}&quot;, &quot;Exterior Lights Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="615">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="616">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="617">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="618">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="619">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="620">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="621">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="622">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="623">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="624">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="625">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="626">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="627">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="628">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="630">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="631">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="636">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_fans_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="637">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityFansHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="638">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="639">
          
          
          <code class="ruby">      heating_equipment = HVAC.existing_heating_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">      heating_equipment.each do |htg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="641">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(htg_equip)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="642">
          
          
          <code class="ruby">        if htg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="643">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityFansHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_equip.supplyFan.get.name}&quot;, &quot;Fan Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="644">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="646">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="647">
          
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="648">
          
          
          <code class="ruby">      if plant_loop.name.to_s == Constants.PlantLoopDomesticWater(unit.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="649">
          
          
          <code class="ruby">        water_heater = Waterheater.get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="650">
          
          
          <code class="ruby">        if water_heater.is_a? OpenStudio::Model::WaterHeaterHeatPumpWrappedCondenser</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="651">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityFansHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.fan.name}&quot;, &quot;Fan Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="652">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="653">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="654">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="655">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="657">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_fans_cooling(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="658">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityFansCooling&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="659">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="660">
          
          
          <code class="ruby">      cooling_equipment = HVAC.existing_cooling_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="661">
          
          
          <code class="ruby">      cooling_equipment.each do |clg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="662">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(clg_equip)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="663">
          
          
          <code class="ruby">        if clg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="664">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityFansCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{clg_equip.supplyFan.get.name}&quot;, &quot;Fan Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="665">
          
          
          <code class="ruby">        elsif clg_equip.is_a? OpenStudio::Model::ZoneHVACPackagedTerminalAirConditioner or clg_equip.is_a? OpenStudio::Model::ZoneHVACFourPipeFanCoil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="666">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityFansCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{clg_equip.supplyAirFan.name}&quot;, &quot;Fan Electric Energy&quot;] # FIXME: all fan coil fan energy is assigned to fan cooling</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="667">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="668">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="670">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="672">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_pumps_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="673">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityPumpsHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="674">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityPumpsHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="675">
          
          
          <code class="ruby">    model.getEnergyManagementSystemOutputVariables.each do |ems_output_var|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="676">
          
          
          <code class="ruby">      if ems_output_var.name.to_s.include? &quot;Central htg pump:Pumps:Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityPumpsHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;&quot;, &quot;#{ems_output_var.name}&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">      elsif ems_output_var.name.to_s.include? &quot;htg pump:Pumps:Electricity&quot; and ems_output_var.emsVariableName.to_s == &quot;#{unit.name}_pumps_h&quot;.gsub(&quot; &quot;, &quot;_&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="679">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityPumpsHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;&quot;, &quot;#{ems_output_var.name}&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="680">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="682">
          
          
          <code class="ruby">    model.getPumpConstantSpeeds.each do |pump| # shw pump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="683">
          
          
          <code class="ruby">      next unless pump.name.to_s.include? Constants.ObjectNameSolarHotWater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="684">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="685">
          
          
          <code class="ruby">      if (unit.name.to_s == &quot;unit 1&quot; and not pump.name.to_s.include? &quot;unit&quot;) or pump.name.to_s.end_with? &quot;#{unit.name.to_s} pump&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="686">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityPumpsHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{pump.name}&quot;, &quot;Pump Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="691">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_pumps_cooling(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="692">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityPumpsCooling&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="693">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityPumpsCooling&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="694">
          
          
          <code class="ruby">    model.getEnergyManagementSystemOutputVariables.each do |ems_output_var|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="695">
          
          
          <code class="ruby">      if ems_output_var.name.to_s.include? &quot;Central clg pump:Pumps:Electricity&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="696">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityPumpsCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;&quot;, &quot;#{ems_output_var.name}&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="697">
          
          
          <code class="ruby">      elsif ems_output_var.name.to_s.include? &quot;clg pump:Pumps:Electricity&quot; and ems_output_var.emsVariableName.to_s == &quot;#{unit.name}_pumps_c&quot;.gsub(&quot; &quot;, &quot;_&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="698">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityPumpsCooling&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;&quot;, &quot;#{ems_output_var.name}&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="699">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="700">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="701">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="702">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="703">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="704">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="705">
          
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="706">
          
          
          <code class="ruby">      if plant_loop.name.to_s == Constants.PlantLoopDomesticWater(unit.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="707">
          
          
          <code class="ruby">        water_heater = Waterheater.get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="709">
          
          
          <code class="ruby">        if water_heater.is_a? OpenStudio::Model::WaterHeaterMixed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="710">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater Off Cycle Parasitic Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="711">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater On Cycle Parasitic Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="712">
          
          
          <code class="ruby">          next if water_heater.heaterFuelType != &quot;Electricity&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="714">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">        elsif water_heater.is_a? OpenStudio::Model::WaterHeaterHeatPumpWrappedCondenser</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="716">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater Off Cycle Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="717">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater On Cycle Ancillary Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="719">
          
          
          <code class="ruby">          tank = water_heater.tank.to_WaterHeaterStratified.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="720">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{tank.name}&quot;, &quot;Water Heater Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="721">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{tank.name}&quot;, &quot;Water Heater Off Cycle Parasitic Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="722">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{tank.name}&quot;, &quot;Water Heater On Cycle Parasitic Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="723">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">          coil = water_heater.dXCoil.to_CoilWaterHeatingAirToWaterHeatPumpWrapped.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="725">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{coil.name}&quot;, &quot;Cooling Coil Crankcase Heater Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{coil.name}&quot;, &quot;Cooling Coil Water Heating Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="727">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="728">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="730">
          
          
          <code class="ruby">    shw_tank = Waterheater.get_shw_storage_tank(model, unit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="731">
          
          
          <code class="ruby">    unless shw_tank.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">      custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{shw_tank.name}&quot;, &quot;Water Heater Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="733">
          
          
          <code class="ruby">      custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{shw_tank.name}&quot;, &quot;Water Heater Off Cycle Parasitic Electric Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="734">
          
          
          <code class="ruby">      custom_meter_infos[&quot;#{unit.name}:ElectricityWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{shw_tank.name}&quot;, &quot;Water Heater On Cycle Parasitic Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="735">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="736">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="737">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="738">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_photovoltaics(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="739">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityPhotovoltaics&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="740">
          
          
          <code class="ruby">    model.getGeneratorPVWattss.each do |generator_pvwatts|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="741">
          
          
          <code class="ruby">      custom_meter_infos[&quot;Central:ElectricityPhotovoltaics&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{generator_pvwatts.name}&quot;, &quot;Generator Produced DC Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="743">
          
          
          <code class="ruby">    model.getElectricLoadCenterInverterPVWattss.each do |electric_load_center_inverter_pvwatts|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="744">
          
          
          <code class="ruby">      custom_meter_infos[&quot;Central:ElectricityPhotovoltaics&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{electric_load_center_inverter_pvwatts.name}&quot;, &quot;Inverter Conversion Loss Decrement Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="745">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="747">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="748">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="749">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="750">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:NaturalGasHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="751">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="752">
          
          
          <code class="ruby">      heating_equipment = HVAC.existing_heating_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="753">
          
          
          <code class="ruby">      heating_equipment.each do |htg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="754">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(htg_equip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="755">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="756">
          
          
          <code class="ruby">        if htg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="757">
          
          
          <code class="ruby">          next if htg_coil.is_a? OpenStudio::Model::CoilHeatingElectric or htg_coil.is_a? OpenStudio::Model::CoilHeatingDXSingleSpeed or htg_coil.is_a? OpenStudio::Model::CoilHeatingDXMultiSpeed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="758">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="759">
          
          
          <code class="ruby">          if htg_coil.is_a? OpenStudio::Model::CoilHeatingGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="760">
          
          
          <code class="ruby">            next if htg_coil.fuelType != &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="761">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="763">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:NaturalGasHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Gas Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:NaturalGasHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Ancillary Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="766">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACBaseboardConvectiveWater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="767">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="768">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="769">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="770">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="771">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWaterBaseboard.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="773">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWaterBaseboard.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="777">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="779">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="781">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="782">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="783">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="784">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="785">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="787">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="788">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="789">
          
          
          <code class="ruby">              next if supply_component.to_BoilerHotWater.get.fuelType != &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="790">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="791">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="792">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:NaturalGasHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="793">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="794">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:NaturalGasHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="796">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="797">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="798">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="799">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACFourPipeFanCoil or htg_equip.is_a? OpenStudio::Model::ZoneHVACPackagedTerminalAirConditioner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="800">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="801">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="802">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="803">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="804">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="805">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="806">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWater.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="807">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="809">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="811">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="812">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="813">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="814">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="815">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="816">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="818">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="819">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="820">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="821">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">              next if supply_component.to_BoilerHotWater.get.fuelType != &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="823">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="824">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="825">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:NaturalGasHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="826">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="827">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:NaturalGasHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="830">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="831">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="832">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="833">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="834">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="835">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="836">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="837">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="838">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="839">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="840">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="841">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="842">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="843">
          
          
          <code class="ruby">        next if equip.fuelType != &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="844">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="845">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="846">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="847">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="848">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:NaturalGasInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="849">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="850">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="851">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="852">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="853">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:NaturalGasInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="855">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="856">
          
          
          <code class="ruby">        next if equip.fuelType != &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="857">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="858">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:NaturalGasInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="859">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="860">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="861">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="862">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="863">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="864">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasWaterSystems&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="865">
          
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="866">
          
          
          <code class="ruby">      if plant_loop.name.to_s == Constants.PlantLoopDomesticWater(unit.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="867">
          
          
          <code class="ruby">        water_heater = Waterheater.get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="868">
          
          
          <code class="ruby">        next unless water_heater.is_a? OpenStudio::Model::WaterHeaterMixed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="869">
          
          
          <code class="ruby">        next if water_heater.heaterFuelType != &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="870">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="871">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="872">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="873">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="874">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="875">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="876">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fuel_oil_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="877">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:FuelOilHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;FuelOil#1&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="878">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:FuelOilHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;FuelOil#1&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="879">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="880">
          
          
          <code class="ruby">      heating_equipment = HVAC.existing_heating_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="881">
          
          
          <code class="ruby">      heating_equipment.each do |htg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="882">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(htg_equip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="883">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="884">
          
          
          <code class="ruby">        if htg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="885">
          
          
          <code class="ruby">          next if htg_coil.is_a? OpenStudio::Model::CoilHeatingElectric or htg_coil.is_a? OpenStudio::Model::CoilHeatingDXSingleSpeed or htg_coil.is_a? OpenStudio::Model::CoilHeatingDXMultiSpeed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="886">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="887">
          
          
          <code class="ruby">          if htg_coil.is_a? OpenStudio::Model::CoilHeatingGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="888">
          
          
          <code class="ruby">            next if htg_coil.fuelType != &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="889">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="890">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="891">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:FuelOilHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="892">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:FuelOilHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Ancillary FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="893">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="894">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACBaseboardConvectiveWater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="895">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="896">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="897">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="898">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="899">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWaterBaseboard.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="900">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="901">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWaterBaseboard.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="902">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="903">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="904">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="905">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="906">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="907">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="908">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="909">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="910">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="911">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="913">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="914">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="915">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="916">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="917">
          
          
          <code class="ruby">              next if supply_component.to_BoilerHotWater.get.fuelType != &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="918">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="919">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="920">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:FuelOilHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="922">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:FuelOilHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="923">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="924">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="925">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="926">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="927">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACFourPipeFanCoil or htg_equip.is_a? OpenStudio::Model::ZoneHVACPackagedTerminalAirConditioner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="928">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="929">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="930">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="931">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="932">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="933">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="934">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWater.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="935">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="936">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="937">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="938">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="939">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="940">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="941">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="942">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="943">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="944">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="945">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="946">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="947">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="948">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="949">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="950">
          
          
          <code class="ruby">              next if supply_component.to_BoilerHotWater.get.fuelType != &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="951">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="952">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="953">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:FuelOilHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="954">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="955">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:FuelOilHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="956">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="957">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="958">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="959">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="960">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="961">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="962">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="963">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="964">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="965">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fuel_oil_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="966">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:FuelOilInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;FuelOil#1&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="967">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="968">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="969">
          
          
          <code class="ruby">        next if equip.fuelType != &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="970">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="971">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:FuelOilInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="972">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="973">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="974">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:FuelOilInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;FuelOil#1&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="975">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="976">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="977">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="978">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="979">
          
          
          <code class="ruby">        next if equip.fuelType != &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="980">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="981">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:FuelOilInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="982">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="983">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="984">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="985">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="986">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fuel_oil_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="987">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:FuelOilWaterSystems&quot;] = { &quot;fuel_type&quot; =&gt; &quot;FuelOil#1&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="988">
          
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="989">
          
          
          <code class="ruby">      if plant_loop.name.to_s == Constants.PlantLoopDomesticWater(unit.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="990">
          
          
          <code class="ruby">        water_heater = Waterheater.get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="991">
          
          
          <code class="ruby">        next unless water_heater.is_a? OpenStudio::Model::WaterHeaterMixed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="992">
          
          
          <code class="ruby">        next if water_heater.heaterFuelType != &quot;FuelOil#1&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="993">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="994">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:FuelOilWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater FuelOil#1 Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="995">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="996">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="997">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="998">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="999">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.propane_heating(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1000">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:PropaneHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1001">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:PropaneHeating&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1002">
          
          
          <code class="ruby">    thermal_zones.each do |thermal_zone|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1003">
          
          
          <code class="ruby">      heating_equipment = HVAC.existing_heating_equipment(model, runner, thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1004">
          
          
          <code class="ruby">      heating_equipment.each do |htg_equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1005">
          
          
          <code class="ruby">        clg_coil, htg_coil, supp_htg_coil = HVAC.get_coils_from_hvac_equip(htg_equip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1006">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1007">
          
          
          <code class="ruby">        if htg_equip.is_a? OpenStudio::Model::AirLoopHVACUnitarySystem</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1008">
          
          
          <code class="ruby">          next if htg_coil.is_a? OpenStudio::Model::CoilHeatingElectric or htg_coil.is_a? OpenStudio::Model::CoilHeatingDXSingleSpeed or htg_coil.is_a? OpenStudio::Model::CoilHeatingDXMultiSpeed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1009">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1010">
          
          
          <code class="ruby">          if htg_coil.is_a? OpenStudio::Model::CoilHeatingGas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1011">
          
          
          <code class="ruby">            next if htg_coil.fuelType != &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1012">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1013">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1014">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:PropaneHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Propane Energy&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1015">
          
          
          <code class="ruby">          custom_meter_infos[&quot;#{unit.name}:PropaneHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{htg_coil.name}&quot;, &quot;Heating Coil Ancillary Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1016">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1017">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACBaseboardConvectiveWater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1018">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1019">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1020">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1021">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1022">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWaterBaseboard.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1023">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1024">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWaterBaseboard.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1025">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1026">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1027">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1028">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1029">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1030">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1031">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1032">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1033">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1034">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1035">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1036">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1037">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1038">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1039">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1040">
          
          
          <code class="ruby">              next if supply_component.to_BoilerHotWater.get.fuelType != &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1041">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1042">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1043">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:PropaneHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1044">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1045">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:PropaneHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1046">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1047">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1048">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1049">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1050">
          
          
          <code class="ruby">        elsif htg_equip.is_a? OpenStudio::Model::ZoneHVACFourPipeFanCoil or htg_equip.is_a? OpenStudio::Model::ZoneHVACPackagedTerminalAirConditioner</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1051">
          
          
          <code class="ruby">          model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1052">
          
          
          <code class="ruby">            is_specified_zone = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1053">
          
          
          <code class="ruby">            units_served = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1054">
          
          
          <code class="ruby">            plant_loop.demandComponents.each do |demand_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1055">
          
          
          <code class="ruby">              next unless demand_component.to_CoilHeatingWater.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1056">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1057">
          
          
          <code class="ruby">              demand_coil = demand_component.to_CoilHeatingWater.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1058">
          
          
          <code class="ruby">              thermal_zone_served = demand_coil.containingZoneHVACComponent.get.thermalZone.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1059">
          
          
          <code class="ruby">              thermal_zone_served.spaces.each do |space_served|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1060">
          
          
          <code class="ruby">                unit_served = space_served.buildingUnit.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1061">
          
          
          <code class="ruby">                next if units_served.include? unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1062">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1063">
          
          
          <code class="ruby">                units_served &lt;&lt; unit_served</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1064">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1065">
          
          
          <code class="ruby">              next if thermal_zone_served != thermal_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1066">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1067">
          
          
          <code class="ruby">              is_specified_zone = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1068">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1069">
          
          
          <code class="ruby">            next unless is_specified_zone</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1070">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1071">
          
          
          <code class="ruby">            plant_loop.supplyComponents.each do |supply_component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1072">
          
          
          <code class="ruby">              next unless supply_component.to_BoilerHotWater.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1073">
          
          
          <code class="ruby">              next if supply_component.to_BoilerHotWater.get.fuelType != &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1074">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1075">
          
          
          <code class="ruby">              if units_served.length != 1 # this is a central system</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1076">
          
          
          <code class="ruby">                custom_meter_infos[&quot;Central:PropaneHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1077">
          
          
          <code class="ruby">              else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1078">
          
          
          <code class="ruby">                custom_meter_infos[&quot;#{unit.name}:PropaneHeating&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{supply_component.name}&quot;, &quot;Boiler Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1079">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1080">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1081">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1082">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1083">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1084">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1085">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1086">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1087">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.propane_interior_equipment(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1088">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:PropaneInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1089">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1090">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1091">
          
          
          <code class="ruby">        next if equip.fuelType != &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1092">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1093">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:PropaneInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1094">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1095">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1096">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:PropaneInteriorEquipment&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1097">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1098">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1099">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1100">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1101">
          
          
          <code class="ruby">        next if equip.fuelType != &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1103">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:PropaneInteriorEquipment&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1104">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1108">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.propane_water_systems(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1109">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:PropaneWaterSystems&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1110">
          
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1111">
          
          
          <code class="ruby">      if plant_loop.name.to_s == Constants.PlantLoopDomesticWater(unit.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1112">
          
          
          <code class="ruby">        water_heater = Waterheater.get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1113">
          
          
          <code class="ruby">        next unless water_heater.is_a? OpenStudio::Model::WaterHeaterMixed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1114">
          
          
          <code class="ruby">        next if water_heater.heaterFuelType != &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1116">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:PropaneWaterSystems&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{water_heater.name}&quot;, &quot;Water Heater Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1117">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1121">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_refrigerator(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1122">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityRefrigerator&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1123">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1124">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1125">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameRefrigerator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1127">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityRefrigerator&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1128">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1129">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1132">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_clothes_washer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1133">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityClothesWasher&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1134">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1135">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1136">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameClothesWasher</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1138">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityClothesWasher&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1139">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1140">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1143">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_clothes_dryer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1144">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityClothesDryer&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1145">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1146">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1147">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameClothesDryer(nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1149">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityClothesDryer&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1150">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1151">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1154">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_clothes_dryer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1155">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasClothesDryer&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1156">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1157">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1158">
          
          
          <code class="ruby">        next unless equip.fuelType == &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1159">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameClothesDryer(nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1160">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1161">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasClothesDryer&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1162">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1163">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1164">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1166">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.propane_clothes_dryer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1167">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:PropaneClothesDryer&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1168">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1169">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1170">
          
          
          <code class="ruby">        next unless equip.fuelType == &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1171">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameClothesDryer(nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1173">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:PropaneClothesDryer&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1174">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1178">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_cooking_range(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1179">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityCookingRange&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1180">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1181">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1182">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameCookingRange(nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1184">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityCookingRange&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1185">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1186">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1187">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1189">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_cooking_range(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1190">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasCookingRange&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1191">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1192">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1193">
          
          
          <code class="ruby">        next unless equip.fuelType == &quot;NaturalGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1194">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameCookingRange(nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1196">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasCookingRange&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1197">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1198">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1199">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1201">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.propane_cooking_range(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1202">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:PropaneCookingRange&quot;] = { &quot;fuel_type&quot; =&gt; &quot;PropaneGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1203">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1204">
          
          
          <code class="ruby">      space.otherEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1205">
          
          
          <code class="ruby">        next unless equip.fuelType == &quot;PropaneGas&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1206">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameCookingRange(nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1208">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:PropaneCookingRange&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Other Equipment Propane Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1209">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1210">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1211">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1213">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_dishwasher(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1214">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityDishwasher&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1215">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1216">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1217">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameDishwasher</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1219">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityDishwasher&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1220">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1221">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1222">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1224">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_plug_loads(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1225">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityPlugLoads&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1226">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1227">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1228">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameMiscPlugLoads</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1230">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityPlugLoads&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1231">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1232">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1233">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1235">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_house_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1236">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityHouseFan&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1237">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1238">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1239">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? &quot;house fan&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1241">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityHouseFan&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1242">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1243">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1244">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1245">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1246">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_range_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1247">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityRangeFan&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1248">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1249">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1250">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? &quot;range fan&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1251">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1252">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityRangeFan&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1253">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1254">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1255">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1257">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_bath_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1258">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityBathFan&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1259">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1260">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1261">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? &quot;bath fan&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1263">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityBathFan&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1264">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1265">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1266">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1268">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_ceiling_fan(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1269">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityCeilingFan&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1270">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1271">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1272">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameCeilingFan</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1273">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1274">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityCeilingFan&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1275">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1276">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1277">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1279">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_extra_refrigerator(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1280">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityExtraRefrigerator&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1281">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1282">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1283">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameExtraRefrigerator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1285">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityExtraRefrigerator&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1286">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1287">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1289">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityExtraRefrigerator&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1290">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1291">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1293">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1294">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameExtraRefrigerator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1296">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityExtraRefrigerator&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1297">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1298">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1299">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1301">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_freezer(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1302">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityFreezer&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1303">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1304">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1305">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameFreezer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1306">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1307">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityFreezer&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1308">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1309">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1311">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityFreezer&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1312">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1313">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1315">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1316">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameFreezer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1318">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:ElectricityFreezer&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1319">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1320">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1321">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1323">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_pool_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1324">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityPoolHeater&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1325">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1326">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1327">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNamePoolHeater(Constants.FuelTypeElectric)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1329">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityPoolHeater&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1330">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1331">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1332">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1333">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1334">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_pool_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1335">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasPoolHeater&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1336">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1337">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1338">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNamePoolHeater(Constants.FuelTypeGas)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1340">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasPoolHeater&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1341">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1342">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1343">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1344">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1345">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_pool_pump(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1346">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityPoolPump&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1347">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1348">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1349">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNamePoolPump</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1350">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1351">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityPoolPump&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1352">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1353">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1354">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1356">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_hot_tub_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1357">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityHotTubHeater&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1358">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1359">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1360">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameHotTubHeater(Constants.FuelTypeElectric)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1361">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1362">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityHotTubHeater&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1363">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1364">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1365">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1366">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1367">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_hot_tub_heater(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1368">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasHotTubHeater&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1369">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1370">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1371">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameHotTubHeater(Constants.FuelTypeGas)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1373">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasHotTubHeater&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1374">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1375">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1376">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1377">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1378">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_hot_tub_pump(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1379">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityHotTubPump&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1380">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1381">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1382">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameHotTubPump</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1383">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1384">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityHotTubPump&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1385">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1386">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1387">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1388">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1389">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_grill(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1390">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasGrill&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1391">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1392">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1393">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameGasGrill</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1394">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1395">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasGrill&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1396">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1397">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1399">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:NaturalGasGrill&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1400">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1401">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1402">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1403">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1404">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameGasGrill</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1406">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:NaturalGasGrill&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1407">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1408">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1409">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1410">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1411">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1412">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasLighting&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1413">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1414">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1415">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameGasLighting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1416">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1417">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasLighting&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1418">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1419">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1420">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1421">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:NaturalGasLighting&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1422">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1423">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1424">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1425">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1426">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameGasLighting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1427">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1428">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:NaturalGasLighting&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1429">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1430">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1431">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1433">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.natural_gas_fireplace(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1434">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:NaturalGasFireplace&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1435">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1436">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1437">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameGasFireplace</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1438">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1439">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:NaturalGasFireplace&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1440">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1441">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1442">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1443">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:NaturalGasFireplace&quot;] = { &quot;fuel_type&quot; =&gt; &quot;NaturalGas&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1444">
          
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1445">
          
          
          <code class="ruby">      next if space.buildingUnit.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1446">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1447">
          
          
          <code class="ruby">      space.gasEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1448">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameGasFireplace</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1449">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1450">
          
          
          <code class="ruby">        custom_meter_infos[&quot;Central:NaturalGasFireplace&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Gas Equipment Gas Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1451">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1452">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1453">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1454">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1455">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_well_pump(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1456">
          
          
          <code class="ruby">    custom_meter_infos[&quot;#{unit.name}:ElectricityWellPump&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1457">
          
          
          <code class="ruby">    unit.spaces.each do |space|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1458">
          
          
          <code class="ruby">      space.electricEquipment.each do |equip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1459">
          
          
          <code class="ruby">        next unless equip.endUseSubcategory.include? Constants.ObjectNameWellPump</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1460">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1461">
          
          
          <code class="ruby">        custom_meter_infos[&quot;#{unit.name}:ElectricityWellPump&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{equip.name}&quot;, &quot;Electric Equipment Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1462">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1463">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1464">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1465">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1466">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.electricity_garage_lighting(custom_meter_infos, model, runner, unit, thermal_zones)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1467">
          
          
          <code class="ruby">    custom_meter_infos[&quot;Central:ElectricityGarageLighting&quot;] = { &quot;fuel_type&quot; =&gt; &quot;Electricity&quot;, &quot;key_var_groups&quot; =&gt; [] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1468">
          
          
          <code class="ruby">    model.getLightss.each do |lights|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1469">
          
          
          <code class="ruby">      next unless lights.endUseSubcategory.include? Constants.ObjectNameLightingGarage</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1470">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1471">
          
          
          <code class="ruby">      custom_meter_infos[&quot;Central:ElectricityGarageLighting&quot;][&quot;key_var_groups&quot;] &lt;&lt; [&quot;#{lights.name}&quot;, &quot;Lights Electric Energy&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1472">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1473">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1474">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6a7596d8745120e6b52f7f21cdccff6dcf15dcdc">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/waterheater.rb</h3>
    <h4><span class="red">4.51 %</span> covered</h4>
    <div>
      <b>843</b> relevant lines. 
      <span class="green"><b>38</b> lines covered</span> and
      <span class="red"><b>805</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># Add classes or functions here than can be used across a variety of our python classes and modules.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;constants&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;util&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;weather&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;geometry&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;schedules&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;psychrometrics&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">class Waterheater</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.apply_tank(model, unit, runner, loop, space, fuel_type, cap, vol, ef,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">                      re, t_set, oncycle_p, offcycle_p, ec_adj)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    # Validate inputs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    if vol &lt;= 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      runner.registerError(&quot;Storage tank volume must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    if ef &gt;= 1 or ef &lt;= 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      runner.registerError(&quot;Rated energy factor must be greater than 0 and less than 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    if t_set &lt;= 0 or t_set &gt;= 212</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      runner.registerError(&quot;Hot water temperature must be greater than 0 and less than 212.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    if cap &lt;= 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      runner.registerError(&quot;Nominal capacity must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    if fuel_type == Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      re = 0.98 # recovery efficiency set by fiat</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      oncycle_p = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      offcycle_p = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      if re &lt; 0 or re &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">        runner.registerError(&quot;Recovery efficiency must be at least 0 and at most 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      if oncycle_p &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">        runner.registerError(&quot;Forced draft fan power must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      if offcycle_p &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">        runner.registerError(&quot;Parasitic electricity power must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    # Get unit beds/baths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    nbeds, nbaths = Geometry.get_unit_beds_baths(model, unit, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    if nbeds.nil? or nbaths.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    if loop.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      runner.registerInfo(&quot;A new plant loop for DHW will be added to the model&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      runner.registerInitialCondition(&quot;No water heater model currently exists&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      loop = create_new_loop(model, Constants.PlantLoopDomesticWater(unit.name.to_s), t_set, Constants.WaterHeaterTypeTank)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    if loop.components(OpenStudio::Model::PumpVariableSpeed::iddObjectType).empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">      new_pump = create_new_pump(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      new_pump.addToNode(loop.supplyInletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    if loop.supplyOutletNode.setpointManagers.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      new_manager = create_new_schedule_manager(t_set, model, Constants.WaterHeaterTypeTank)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      new_manager.addToNode(loop.supplyOutletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    new_heater = create_new_heater(Constants.ObjectNameWaterHeater(unit.name.to_s), cap, fuel_type, vol, ef, re, t_set, space.thermalZone.get, oncycle_p, offcycle_p, ec_adj, Constants.WaterHeaterTypeTank, 0, nbeds, model, runner)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    storage_tank = get_shw_storage_tank(model, unit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    if storage_tank.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      loop.addSupplyBranchForComponent(new_heater)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      storage_tank.setHeater1SetpointTemperatureSchedule(new_heater.setpointTemperatureSchedule.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      storage_tank.setHeater2SetpointTemperatureSchedule(new_heater.setpointTemperatureSchedule.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      new_heater.addToNode(storage_tank.supplyOutletModelObject.get.to_Node.get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.apply_tankless(model, unit, runner, loop, space, fuel_type, cap, ef,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">                          cd, t_set, oncycle_p, offcycle_p, ec_adj)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">    # Validate inputs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    if ef &gt; 1 or ef &lt;= 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      runner.registerError(&quot;Rated energy factor must be greater than 0 and less than or equal to 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    if t_set &lt;= 0 or t_set &gt;= 212</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      runner.registerError(&quot;Hot water temperature must be greater than 0 and less than 212.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    if cap &lt;= 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      runner.registerError(&quot;Nominal capacity must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    if cd &lt; 0 or cd &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">      runner.registerError(&quot;Cycling derate must be at least 0 and at most 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    if fuel_type == Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">      oncycle_p = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      offcycle_p = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">      if oncycle_p &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">        runner.registerError(&quot;Forced draft fan power must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">      if offcycle_p &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">        runner.registerError(&quot;Parasitic electricity power must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    # Get unit beds/baths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    nbeds, nbaths = Geometry.get_unit_beds_baths(model, unit, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    if nbeds.nil? or nbaths.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    if loop.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      runner.registerInfo(&quot;A new plant loop for DHW will be added to the model&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      runner.registerInitialCondition(&quot;No water heater model currently exists&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">      loop = Waterheater.create_new_loop(model, Constants.PlantLoopDomesticWater(unit.name.to_s), t_set, Constants.WaterHeaterTypeTankless)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">    if loop.components(OpenStudio::Model::PumpVariableSpeed::iddObjectType).empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">      new_pump = Waterheater.create_new_pump(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">      new_pump.addToNode(loop.supplyInletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">    if loop.supplyOutletNode.setpointManagers.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">      new_manager = Waterheater.create_new_schedule_manager(t_set, model, Constants.WaterHeaterTypeTankless)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">      new_manager.addToNode(loop.supplyOutletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">    new_heater = Waterheater.create_new_heater(Constants.ObjectNameWaterHeater(unit.name.to_s), cap, fuel_type, 1, ef, 0, t_set, space.thermalZone.get, oncycle_p, offcycle_p, ec_adj, Constants.WaterHeaterTypeTankless, cd, nbeds, model, runner)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    storage_tank = Waterheater.get_shw_storage_tank(model, unit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">    if storage_tank.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">      loop.addSupplyBranchForComponent(new_heater)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">      storage_tank.setHeater1SetpointTemperatureSchedule(new_heater.setpointTemperatureSchedule.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">      storage_tank.setHeater2SetpointTemperatureSchedule(new_heater.setpointTemperatureSchedule.get)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">      new_heater.addToNode(storage_tank.supplyOutletModelObject.get.to_Node.get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.apply_heatpump(model, unit, runner, loop, space, weather,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">                          e_cap, vol, t_set, min_temp, max_temp,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">                          cap, cop, shr, airflow_rate, fan_power,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">                          parasitics, tank_ua, int_factor, temp_depress,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">                          ducting = &quot;none&quot;, unit_index = 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">    # Validate inputs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">    if vol &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">      runner.registerError(&quot;Storage tank volume must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">    if t_set &lt;= 0.0 or t_set &gt;= 212.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">      runner.registerError(&quot;Hot water temperature must be greater than 0 and less than 212.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">    if e_cap &lt; 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">      runner.registerError(&quot;Element capacity must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">    if min_temp &gt;= 80.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">      runner.registerError(&quot;Minimum temperature will prevent HPWH from running, double check inputs.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">    if max_temp &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">      runner.registerError(&quot;Maximum temperature will prevent HPWH from running, double check inputs.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">    if cap &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">      runner.registerError(&quot;Rated capacity must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    if cop &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">      runner.registerError(&quot;Rated COP must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">    if shr &lt; 0.0 or shr &gt; 1.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">      runner.registerError(&quot;Rated sensible heat ratio must be between 0 and 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">    if airflow_rate &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">      runner.registerError(&quot;Airflow rate must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">    if fan_power &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">      runner.registerError(&quot;Fan power must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">    if parasitics &lt; 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">      runner.registerError(&quot;Parasitics must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    if tank_ua &lt;= 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">      runner.registerError(&quot;Tank UA must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">    if int_factor &lt; 0.0 or int_factor &gt; 1.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">      runner.registerError(&quot;Interaction factor must be between 0 and 1.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">    if temp_depress &lt; 0.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">      runner.registerError(&quot;Temperature depression must be greater than 0.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    # Get unit beds/baths</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">    nbeds, nbaths = Geometry.get_unit_beds_baths(model, unit, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">    if nbeds.nil? or nbaths.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="225">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="228">
          
          
          <code class="ruby">    obj_name_hpwh = Constants.ObjectNameWaterHeater(unit.name.to_s.gsub(&quot;unit &quot;, &quot;&quot;)).gsub(&quot;|&quot;, &quot;_&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="230">
          
          
          <code class="ruby">    alt = weather.header.Altitude</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">    water_heater_tz = space.thermalZone.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="233">
          
          
          <code class="ruby">    if loop.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">      runner.registerInfo(&quot;A new plant loop for DHW will be added to the model&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">      runner.registerInitialCondition(&quot;There is no existing water heater&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">      loop = Waterheater.create_new_loop(model, Constants.PlantLoopDomesticWater(unit.name.to_s), t_set, Constants.WaterHeaterTypeHeatPump)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="238">
          
          
          <code class="ruby">      runner.registerInitialCondition(&quot;An existing water heater was found in the model. This water heater will be removed and replace with a heat pump water heater&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">    if loop.components(OpenStudio::Model::PumpVariableSpeed::iddObjectType).empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">      new_pump = Waterheater.create_new_pump(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">      new_pump.addToNode(loop.supplyInletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">    if loop.supplyOutletNode.setpointManagers.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      new_manager = Waterheater.create_new_schedule_manager(t_set, model, Constants.WaterHeaterTypeHeatPump)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">      new_manager.addToNode(loop.supplyOutletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    # Only ever going to make HPWHs in this measure, so don&#39;t split this code out to waterheater.rb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">    # Calculate some geometry parameters for UA, the location of sensors and heat sources in the tank</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">    if vol &gt; 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">      hpwh_param = 80</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">      hpwh_param = 50</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">    h_tank = 0.0188 * vol + 0.0935 # Linear relationship that gets GE height at 50 gal and AO Smith height at 80 gal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">    v_actual = 0.9 * vol</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="262">
          
          
          <code class="ruby">    pi = Math::PI</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="263">
          
          
          <code class="ruby">    r_tank = (UnitConversions.convert(v_actual, &quot;gal&quot;, &quot;m^3&quot;) / (pi * h_tank))**0.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">    a_tank = 2 * pi * r_tank * (r_tank + h_tank)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">    u_tank = (5.678 * tank_ua) / UnitConversions.convert(a_tank, &quot;m^2&quot;, &quot;ft^2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      h_UE = (1 - (3.5 / 12)) * h_tank # in the 4th node of the tank (counting from top)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">      h_LE = (1 - (10.5 / 12)) * h_tank # in the 11th node of the tank (counting from top)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">      h_condtop = (1 - (5.5 / 12)) * h_tank # in the 6th node of the tank (counting from top)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">      h_condbot = (1 - (10.99 / 12)) * h_tank # in the 11th node of the tank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">      h_hpctrl = (1 - (2.5 / 12)) * h_tank # in the 3rd node of the tank</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">      h_UE = (1 - (3.5 / 12)) * h_tank # in the 3rd node of the tank (counting from top)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">      h_LE = (1 - (9.5 / 12)) * h_tank # in the 10th node of the tank (counting from top)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">      h_condtop = (1 - (5.5 / 12)) * h_tank # in the 6th node of the tank (counting from top)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">      h_condbot = 0.01 # bottom node</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">      h_hpctrl_up = (1 - (2.5 / 12)) * h_tank # in the 3rd node of the tank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">      h_hpctrl_low = (1 - (8.5 / 12)) * h_tank # in the 9th node of the tank</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">    # Calculate an altitude adjusted rated evaporator wetbulb temperature</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">    rated_ewb_F = 56.4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">    rated_edb_F = 67.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">    rated_ewb = UnitConversions.convert(rated_ewb_F, &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">    rated_edb = UnitConversions.convert(rated_edb_F, &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">    w_rated = Psychrometrics.w_fT_Twb_P(rated_edb_F, rated_ewb_F, 14.7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">    dp_rated = Psychrometrics.Tdp_fP_w(14.7, w_rated)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">    p_atm = Psychrometrics.Pstd_fZ(alt)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">    w_adj = Psychrometrics.w_fT_Twb_P(dp_rated, dp_rated, p_atm)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">    twb_adj = Psychrometrics.Twb_fT_w_P(rated_edb_F, w_adj, p_atm)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">    # Add in schedules for Tamb, RHamb, and the compressor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">    hpwh_tamb = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">    hpwh_tamb.setName(&quot;#{obj_name_hpwh} Tamb act&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">    hpwh_tamb.setValue(23)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">    hpwh_rhamb = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">    hpwh_rhamb.setName(&quot;#{obj_name_hpwh} RHamb act&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">    hpwh_rhamb.setValue(0.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="302">
          
          
          <code class="ruby">    if ducting == Constants.VentTypeSupply or ducting == Constants.VentTypeBalanced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">      hpwh_tamb2 = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">      hpwh_tamb2.setName(&quot;#{obj_name_hpwh} Tamb act2&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">      hpwh_tamb2.setValue(23)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">    tset_C = UnitConversions.convert(t_set, &quot;F&quot;, &quot;C&quot;).to_f.round(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">    hp_setpoint = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">    hp_setpoint.setName(&quot;#{obj_name_hpwh} WaterHeaterHPSchedule&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">    hp_setpoint.setValue(tset_C)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">    hpwh_bottom_element_sp = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">    hpwh_bottom_element_sp.setName(&quot;#{obj_name_hpwh} BottomElementSetpoint&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">    hpwh_top_element_sp = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">    hpwh_top_element_sp.setName(&quot;#{obj_name_hpwh} TopElementSetpoint&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">      hpwh_bottom_element_sp.setValue(tset_C)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">      sp = (tset_C - 2.89).round(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">      hpwh_top_element_sp.setValue(sp)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">      hpwh_bottom_element_sp.setValue(-60)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">      sp = (tset_C - 9.0001).round(4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">      hpwh_top_element_sp.setValue(sp)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">    # WaterHeater:HeatPump:WrappedCondenser</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">    hpwh = OpenStudio::Model::WaterHeaterHeatPumpWrappedCondenser.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">    hpwh.setName(&quot;#{obj_name_hpwh} hpwh&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">    hpwh.setCompressorSetpointTemperatureSchedule(hp_setpoint)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">      hpwh.setDeadBandTemperatureDifference(0.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">      hpwh.setDeadBandTemperatureDifference(3.89)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    hpwh.setCondenserBottomLocation(h_condbot)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">    hpwh.setCondenserTopLocation(h_condtop)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">    hpwh.setEvaporatorAirFlowRate(UnitConversions.convert(airflow_rate, &quot;ft^3/min&quot;, &quot;m^3/s&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">    hpwh.setInletAirConfiguration(&quot;Schedule&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    hpwh.setInletAirTemperatureSchedule(hpwh_tamb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">    hpwh.setInletAirHumiditySchedule(hpwh_rhamb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">    hpwh.setMinimumInletAirTemperatureforCompressorOperation(UnitConversions.convert(min_temp, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">    hpwh.setMaximumInletAirTemperatureforCompressorOperation(UnitConversions.convert(max_temp, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    hpwh.setCompressorLocation(&quot;Schedule&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">    hpwh.setCompressorAmbientTemperatureSchedule(hpwh_tamb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">    hpwh.setFanPlacement(&quot;DrawThrough&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">    hpwh.setOnCycleParasiticElectricLoad(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">    hpwh.setOffCycleParasiticElectricLoad(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">    hpwh.setParasiticHeatRejectionLocation(&quot;Outdoors&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">    hpwh.setTankElementControlLogic(&quot;MutuallyExclusive&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">      hpwh.setControlSensor1HeightInStratifiedTank(h_hpctrl)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="355">
          
          
          <code class="ruby">      hpwh.setControlSensor1Weight(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">      hpwh.setControlSensor2HeightInStratifiedTank(h_hpctrl)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">      hpwh.setControlSensor1HeightInStratifiedTank(h_hpctrl_up)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">      hpwh.setControlSensor1Weight(0.75)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">      hpwh.setControlSensor2HeightInStratifiedTank(h_hpctrl_low)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">    # Curves</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="364">
          
          
          <code class="ruby">    hpwh_cap = OpenStudio::Model::CurveBiquadratic.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">    hpwh_cap.setName(&quot;HPWH-Cap-fT&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">    hpwh_cap.setCoefficient1Constant(0.563)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">    hpwh_cap.setCoefficient2x(0.0437)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">    hpwh_cap.setCoefficient3xPOW2(0.000039)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="369">
          
          
          <code class="ruby">    hpwh_cap.setCoefficient4y(0.0055)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="370">
          
          
          <code class="ruby">    hpwh_cap.setCoefficient5yPOW2(-0.000148)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="371">
          
          
          <code class="ruby">    hpwh_cap.setCoefficient6xTIMESY(-0.000145)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="372">
          
          
          <code class="ruby">    hpwh_cap.setMinimumValueofx(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="373">
          
          
          <code class="ruby">    hpwh_cap.setMaximumValueofx(100)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="374">
          
          
          <code class="ruby">    hpwh_cap.setMinimumValueofy(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">    hpwh_cap.setMaximumValueofy(100)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">    hpwh_cop = OpenStudio::Model::CurveBiquadratic.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">    hpwh_cop.setName(&quot;HPWH-COP-fT&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="379">
          
          
          <code class="ruby">    hpwh_cop.setCoefficient1Constant(1.1332)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">    hpwh_cop.setCoefficient2x(0.063)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="381">
          
          
          <code class="ruby">    hpwh_cop.setCoefficient3xPOW2(-0.0000979)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">    hpwh_cop.setCoefficient4y(-0.00972)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">    hpwh_cop.setCoefficient5yPOW2(-0.0000214)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">    hpwh_cop.setCoefficient6xTIMESY(-0.000686)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">    hpwh_cop.setMinimumValueofx(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">    hpwh_cop.setMaximumValueofx(100)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">    hpwh_cop.setMinimumValueofy(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">    hpwh_cop.setMaximumValueofy(100)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="389">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">    # Coil:WaterHeating:AirToWaterHeatPump:Wrapped</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="391">
          
          
          <code class="ruby">    coil = hpwh.dXCoil.to_CoilWaterHeatingAirToWaterHeatPumpWrapped.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">    coil.setName(&quot;#{obj_name_hpwh} coil&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">    coil.setRatedHeatingCapacity(UnitConversions.convert(cap, &quot;kW&quot;, &quot;W&quot;) * cop)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">    coil.setRatedCOP(cop)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="395">
          
          
          <code class="ruby">    coil.setRatedSensibleHeatRatio(shr)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="396">
          
          
          <code class="ruby">    coil.setRatedEvaporatorInletAirDryBulbTemperature(rated_edb)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="397">
          
          
          <code class="ruby">    coil.setRatedEvaporatorInletAirWetBulbTemperature(UnitConversions.convert(twb_adj, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">    coil.setRatedCondenserWaterTemperature(48.89)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">    coil.setRatedEvaporatorAirFlowRate(UnitConversions.convert(airflow_rate, &quot;ft^3/min&quot;, &quot;m^3/s&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">    coil.setEvaporatorFanPowerIncludedinRatedCOP(true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">    coil.setEvaporatorAirTemperatureTypeforCurveObjects(&quot;WetBulbTemperature&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="402">
          
          
          <code class="ruby">    coil.setHeatingCapacityFunctionofTemperatureCurve(hpwh_cap)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">    coil.setHeatingCOPFunctionofTemperatureCurve(hpwh_cop)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">    coil.setMaximumAmbientTemperatureforCrankcaseHeaterOperation(0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">    # WaterHeater:Stratified</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="407">
          
          
          <code class="ruby">    tank = hpwh.tank.to_WaterHeaterStratified.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="408">
          
          
          <code class="ruby">    tank.setName(&quot;#{obj_name_hpwh} tank&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">    tank.setEndUseSubcategory(&quot;Domestic Hot Water&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="410">
          
          
          <code class="ruby">    tank.setTankVolume(UnitConversions.convert(v_actual, &quot;gal&quot;, &quot;m^3&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="411">
          
          
          <code class="ruby">    tank.setTankHeight(h_tank)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="412">
          
          
          <code class="ruby">    tank.setMaximumTemperatureLimit(90)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">    tank.setHeaterPriorityControl(&quot;MasterSlave&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="414">
          
          
          <code class="ruby">    tank.setHeater1SetpointTemperatureSchedule(hpwh_top_element_sp) # Overwritten later by EMS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="415">
          
          
          <code class="ruby">    tank.setHeater1Capacity(UnitConversions.convert(e_cap, &quot;kW&quot;, &quot;W&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="416">
          
          
          <code class="ruby">    tank.setHeater1Height(h_UE)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="418">
          
          
          <code class="ruby">      tank.setHeater1DeadbandTemperatureDifference(25)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="420">
          
          
          <code class="ruby">      tank.setHeater1DeadbandTemperatureDifference(18.5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="422">
          
          
          <code class="ruby">    tank.setHeater2SetpointTemperatureSchedule(hpwh_bottom_element_sp)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="423">
          
          
          <code class="ruby">    tank.setHeater2Capacity(UnitConversions.convert(e_cap, &quot;kW&quot;, &quot;W&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">    tank.setHeater2Height(h_LE)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">      tank.setHeater2DeadbandTemperatureDifference(30)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="428">
          
          
          <code class="ruby">      tank.setHeater2DeadbandTemperatureDifference(3.89)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    tank.setHeaterFuelType(&quot;Electricity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="431">
          
          
          <code class="ruby">    tank.setHeaterThermalEfficiency(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">    tank.setOffCycleParasiticFuelConsumptionRate(parasitics)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">    tank.setOffCycleParasiticFuelType(&quot;Electricity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="434">
          
          
          <code class="ruby">    tank.setOnCycleParasiticFuelConsumptionRate(parasitics)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="435">
          
          
          <code class="ruby">    tank.setOnCycleParasiticFuelType(&quot;Electricity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">    tank.setAmbientTemperatureIndicator(&quot;Schedule&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="437">
          
          
          <code class="ruby">    tank.setUniformSkinLossCoefficientperUnitAreatoAmbientTemperature(u_tank)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="438">
          
          
          <code class="ruby">    if ducting == Constants.VentTypeSupply or ducting == Constants.VentTypeBalanced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="439">
          
          
          <code class="ruby">      tank.setAmbientTemperatureSchedule(hpwh_tamb2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">      tank.setAmbientTemperatureSchedule(hpwh_tamb)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="443">
          
          
          <code class="ruby">    tank.setNumberofNodes(12)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="444">
          
          
          <code class="ruby">    tank.setAdditionalDestratificationConductivity(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">    tank.setNode1AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="446">
          
          
          <code class="ruby">    tank.setNode2AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="447">
          
          
          <code class="ruby">    tank.setNode3AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">    tank.setNode4AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    tank.setNode5AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">    tank.setNode6AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">    tank.setNode7AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">    tank.setNode8AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="453">
          
          
          <code class="ruby">    tank.setNode9AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">    tank.setNode10AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">    tank.setNode11AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="456">
          
          
          <code class="ruby">    tank.setNode12AdditionalLossCoefficient(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="457">
          
          
          <code class="ruby">    tank.setUseSideDesignFlowRate((UnitConversions.convert(v_actual, &quot;gal&quot;, &quot;m^3&quot;)) / 60.1) # 60.1 (seconds) ensures that the autosizing doesn&#39;t draw the whole tank volume in one minute</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="458">
          
          
          <code class="ruby">    tank.setSourceSideDesignFlowRate(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="459">
          
          
          <code class="ruby">    tank.setSourceSideFlowControlMode(&quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">    tank.setSourceSideInletHeight(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">    tank.setSourceSideOutletHeight(0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby">    # Fan:OnOff</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">    fan = hpwh.fan.to_FanOnOff.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="465">
          
          
          <code class="ruby">    fan.setName(&quot;#{obj_name_hpwh} fan&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="466">
          
          
          <code class="ruby">    if hpwh_param == 50</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="467">
          
          
          <code class="ruby">      fan.setFanEfficiency(23 / fan_power * UnitConversions.convert(1, &quot;ft^3/min&quot;, &quot;m^3/s&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="468">
          
          
          <code class="ruby">      fan.setPressureRise(23)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="469">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">      fan.setFanEfficiency(65 / fan_power * UnitConversions.convert(1, &quot;ft^3/min&quot;, &quot;m^3/s&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="471">
          
          
          <code class="ruby">      fan.setPressureRise(65)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="473">
          
          
          <code class="ruby">    fan.setMaximumFlowRate(UnitConversions.convert(airflow_rate, &quot;ft^3/min&quot;, &quot;m^3/s&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="474">
          
          
          <code class="ruby">    fan.setMotorEfficiency(1.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">    fan.setMotorInAirstreamFraction(1.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="476">
          
          
          <code class="ruby">    fan.setEndUseSubcategory(&quot;Domestic Hot Water&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">    # Add in EMS program for HPWH interaction with the living space &amp; ambient air temperature depression</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="479">
          
          
          <code class="ruby">    if int_factor != 1 and ducting != &quot;none&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">      runner.registerWarning(&quot;Interaction factor must be 1 when ducting a HPWH. The input interaction factor value will be ignored and a value of 1 will be used instead.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="481">
          
          
          <code class="ruby">      int_factor = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">    # Add in other equipment objects for sensible/latent gains</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="485">
          
          
          <code class="ruby">    hpwh_sens_def = OpenStudio::Model::OtherEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">    hpwh_sens_def.setName(&quot;#{obj_name_hpwh} sens&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="487">
          
          
          <code class="ruby">    hpwh_sens = OpenStudio::Model::OtherEquipment.new(hpwh_sens_def)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="488">
          
          
          <code class="ruby">    hpwh_sens.setName(hpwh_sens_def.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    hpwh_sens.setSpace(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="490">
          
          
          <code class="ruby">    hpwh_sens_def.setDesignLevel(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="491">
          
          
          <code class="ruby">    hpwh_sens_def.setFractionRadiant(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="492">
          
          
          <code class="ruby">    hpwh_sens_def.setFractionLatent(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">    hpwh_sens_def.setFractionLost(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="494">
          
          
          <code class="ruby">    hpwh_sens.setSchedule(model.alwaysOnDiscreteSchedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="496">
          
          
          <code class="ruby">    hpwh_lat_def = OpenStudio::Model::OtherEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="497">
          
          
          <code class="ruby">    hpwh_lat_def.setName(&quot;#{obj_name_hpwh} lat&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="498">
          
          
          <code class="ruby">    hpwh_lat = OpenStudio::Model::OtherEquipment.new(hpwh_lat_def)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="499">
          
          
          <code class="ruby">    hpwh_lat.setName(hpwh_lat_def.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="500">
          
          
          <code class="ruby">    hpwh_lat.setSpace(space)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="501">
          
          
          <code class="ruby">    hpwh_lat_def.setDesignLevel(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="502">
          
          
          <code class="ruby">    hpwh_lat_def.setFractionRadiant(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="503">
          
          
          <code class="ruby">    hpwh_lat_def.setFractionLatent(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="504">
          
          
          <code class="ruby">    hpwh_lat_def.setFractionLost(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">    hpwh_lat.setSchedule(model.alwaysOnDiscreteSchedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby">    # If ducted to outside, get outdoor air T &amp; RH and add a separate actuator for the space temperature for tank losses</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="508">
          
          
          <code class="ruby">    if ducting == Constants.VentTypeSupply or ducting == Constants.VentTypeBalanced</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">      tout_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Zone Outdoor Air Drybulb Temperature&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">      tout_sensor.setName(&quot;#{obj_name_hpwh} Tout&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="512">
          
          
          <code class="ruby">      tout_sensor.setKeyName(unit.living_zone.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">      sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Zone Outdoor Air Relative Humidity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="515">
          
          
          <code class="ruby">      sensor.setName(&quot;#{obj_name_hpwh} RHout&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="516">
          
          
          <code class="ruby">      sensor.setKeyName(unit.living_zone.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="517">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="518">
          
          
          <code class="ruby">      hpwh_tamb2 = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="519">
          
          
          <code class="ruby">      hpwh_tamb2.setName(&quot;#{obj_name_hpwh} Tamb act2&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="520">
          
          
          <code class="ruby">      hpwh_tamb2.setValue(23)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="521">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="522">
          
          
          <code class="ruby">      tamb_act2_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_tamb2, &quot;Schedule:Constant&quot;, &quot;Schedule Value&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="523">
          
          
          <code class="ruby">      tamb_act2_actuator.setName(&quot;#{obj_name_hpwh} Tamb act2&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="525">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">    # EMS Sensors: Space Temperature &amp; RH, HP sens and latent loads, tank losses, fan power</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="528">
          
          
          <code class="ruby">    amb_temp_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Zone Mean Air Temperature&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">    amb_temp_sensor.setName(&quot;#{obj_name_hpwh} amb temp&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="530">
          
          
          <code class="ruby">    amb_temp_sensor.setKeyName(water_heater_tz.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="532">
          
          
          <code class="ruby">    amb_rh_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Zone Air Relative Humidity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="533">
          
          
          <code class="ruby">    amb_rh_sensor.setName(&quot;#{obj_name_hpwh} amb rh&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="534">
          
          
          <code class="ruby">    amb_rh_sensor.setKeyName(water_heater_tz.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="536">
          
          
          <code class="ruby">    tl_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Water Heater Heat Loss Rate&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="537">
          
          
          <code class="ruby">    tl_sensor.setName(&quot;#{obj_name_hpwh} tl&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="538">
          
          
          <code class="ruby">    tl_sensor.setKeyName(&quot;#{obj_name_hpwh} tank&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="540">
          
          
          <code class="ruby">    sens_cool_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Cooling Coil Sensible Cooling Rate&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="541">
          
          
          <code class="ruby">    sens_cool_sensor.setName(&quot;#{obj_name_hpwh} sens cool&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">    sens_cool_sensor.setKeyName(&quot;#{obj_name_hpwh} coil&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="544">
          
          
          <code class="ruby">    lat_cool_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Cooling Coil Latent Cooling Rate&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    lat_cool_sensor.setName(&quot;#{obj_name_hpwh} lat cool&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="546">
          
          
          <code class="ruby">    lat_cool_sensor.setKeyName(&quot;#{obj_name_hpwh} coil&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="548">
          
          
          <code class="ruby">    fan_power_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Fan Electric Power&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="549">
          
          
          <code class="ruby">    fan_power_sensor.setName(&quot;#{obj_name_hpwh} fan pwr&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="550">
          
          
          <code class="ruby">    fan_power_sensor.setKeyName(&quot;#{obj_name_hpwh} fan&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">    # EMS Actuators: Inlet T &amp; RH, sensible and latent gains to the space</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="553">
          
          
          <code class="ruby">    tamb_act_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_tamb, &quot;Schedule:Constant&quot;, &quot;Schedule Value&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="554">
          
          
          <code class="ruby">    tamb_act_actuator.setName(&quot;#{obj_name_hpwh} Tamb act&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="556">
          
          
          <code class="ruby">    rhamb_act_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_rhamb, &quot;Schedule:Constant&quot;, &quot;Schedule Value&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="557">
          
          
          <code class="ruby">    rhamb_act_actuator.setName(&quot;#{obj_name_hpwh} RHamb act&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="559">
          
          
          <code class="ruby">    sens_act_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_sens, &quot;OtherEquipment&quot;, &quot;Power Level&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="560">
          
          
          <code class="ruby">    sens_act_actuator.setName(&quot;#{hpwh_sens.name} act&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="562">
          
          
          <code class="ruby">    lat_act_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_lat, &quot;OtherEquipment&quot;, &quot;Power Level&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="563">
          
          
          <code class="ruby">    lat_act_actuator.setName(&quot;#{hpwh_lat.name} act&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="565">
          
          
          <code class="ruby">    on_off_trend_var = OpenStudio::Model::EnergyManagementSystemTrendVariable.new(model, &quot;#{obj_name_hpwh} sens cool&quot;.gsub(&quot; &quot;, &quot;_&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="566">
          
          
          <code class="ruby">    on_off_trend_var.setName(&quot;#{obj_name_hpwh} on off&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="567">
          
          
          <code class="ruby">    on_off_trend_var.setNumberOfTimestepsToBeLogged(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="568">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="569">
          
          
          <code class="ruby">    # Additioanl sensors if supply or exhaust to calculate the load on the space from the HPWH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">    if ducting == Constants.VentTypeSupply or ducting == Constants.VentTypeExhaust</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">      amb_w_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Zone Mean Air Humidity Ratio&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="573">
          
          
          <code class="ruby">      amb_w_sensor.setName(&quot;#{obj_name_hpwh} amb w&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="574">
          
          
          <code class="ruby">      amb_w_sensor.setKeyName(water_heater_tz)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="576">
          
          
          <code class="ruby">      sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;System Node Pressure&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="577">
          
          
          <code class="ruby">      sensor.setName(&quot;#{obj_name_hpwh} amb p&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">      sensor.setKeyName(water_heater_tz)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="580">
          
          
          <code class="ruby">      sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;System Node Temperature&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="581">
          
          
          <code class="ruby">      sensor.setName(&quot;#{obj_name_hpwh} tair out&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="582">
          
          
          <code class="ruby">      sensor.setKeyName(water_heater_tz)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="584">
          
          
          <code class="ruby">      sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;System Node Humidity Ratio&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="585">
          
          
          <code class="ruby">      sensor.setName(&quot;#{obj_name_hpwh} wair out&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">      sensor.setKeyName(water_heater_tz)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="588">
          
          
          <code class="ruby">      sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;System Node Current Density Volume Flow Rate&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="589">
          
          
          <code class="ruby">      sensor.setName(&quot;#{obj_name_hpwh} v air&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="590">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="593">
          
          
          <code class="ruby">    temp_depress_c = temp_depress / 1.8 # don&#39;t use convert because it&#39;s a delta</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="594">
          
          
          <code class="ruby">    timestep_minutes = (60 / model.getTimestep.numberOfTimestepsPerHour).to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="595">
          
          
          <code class="ruby">    # EMS Program for ducting</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="596">
          
          
          <code class="ruby">    hpwh_ducting_program = OpenStudio::Model::EnergyManagementSystemProgram.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="597">
          
          
          <code class="ruby">    hpwh_ducting_program.setName(&quot;#{obj_name_hpwh} InletAir&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="598">
          
          
          <code class="ruby">    if not (Geometry.is_finished_basement(water_heater_tz) or Geometry.is_living(water_heater_tz)) and temp_depress_c &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">      runner.registerWarning(&quot;Confined space HPWH installations are typically used to represent installations in locations like a utility closet. Utility closets installations are typically only done in conditioned spaces.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="600">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="601">
          
          
          <code class="ruby">    if temp_depress_c &gt; 0 and ducting == &quot;none&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="602">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWH_last_#{unit_index} = (@TrendValue #{on_off_trend_var.name} 1)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="603">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWH_now_#{unit_index} = #{on_off_trend_var.name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="604">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set num = (@Ln 2)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="605">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;If (HPWH_last_#{unit_index} == 0) &amp;&amp; (HPWH_now_#{unit_index}&lt;&gt;0)&quot;) # HPWH just turned on</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="606">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWHOn_#{unit_index} = 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="607">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set exp = -(HPWHOn_#{unit_index} / 9.4) * num&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="608">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set exponent = (@Exp exp)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="609">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set T_dep = (#{temp_depress_c} * exponent) - #{temp_depress_c}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="610">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWHOn_#{unit_index} = HPWHOn_#{unit_index} + #{timestep_minutes}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="611">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;ElseIf (HPWH_last_#{unit_index} &lt;&gt; 0) &amp;&amp; (HPWH_now_#{unit_index}&lt;&gt;0)&quot;) # HPWH has been running for more than 1 timestep</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="612">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set exp = -(HPWHOn_#{unit_index} / 9.4) * num&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="613">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set exponent = (@Exp exp)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="614">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set T_dep = (#{temp_depress_c} * exponent) - #{temp_depress_c}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="615">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWHOn_#{unit_index} = HPWHOn_#{unit_index} + #{timestep_minutes}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Else&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="617">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;If (Hour == 0) &amp;&amp; (DayOfYear == 1)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="618">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWHOn_#{unit_index} = 0&quot;) # Assume HPWH starts off for initial conditions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="619">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;EndIF&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="620">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWHOn_#{unit_index} = HPWHOn_#{unit_index} - #{timestep_minutes}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="621">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;If HPWHOn_#{unit_index} &lt; 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="622">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWHOn_#{unit_index} = 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="623">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;EndIf&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="624">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set exp = -(HPWHOn_#{unit_index} / 9.4) * num&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="625">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set exponent = (@Exp exp)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="626">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set T_dep = (#{temp_depress_c} * exponent) - #{temp_depress_c}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="627">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;EndIf&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="628">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set T_hpwh_inlet_#{unit_index} = #{amb_temp_sensor.name} + T_dep&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="630">
          
          
          <code class="ruby">      if ducting == Constants.VentTypeBalanced or ducting == Constants.VentTypeSupply</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="631">
          
          
          <code class="ruby">        hpwh_ducting_program.addLine(&quot;Set T_hpwh_inlet_#{unit_index} = HPWH_out_temp_#{unit_index}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="633">
          
          
          <code class="ruby">        hpwh_ducting_program.addLine(&quot;Set T_hpwh_inlet_#{unit_index} = #{amb_temp_sensor.name}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="636">
          
          
          <code class="ruby">    if ducting == &quot;none&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="637">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{tamb_act_actuator.name} = T_hpwh_inlet_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="638">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{rhamb_act_actuator.name} = #{amb_rh_sensor.name}/100&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="639">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set temp1=(#{tl_sensor.name}*#{int_factor})+#{fan_power_sensor.name}*#{int_factor}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{sens_act_actuator.name} = 0-(#{sens_cool_sensor.name}*#{int_factor})-temp1&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="641">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{lat_act_actuator.name} = 0 - #{lat_cool_sensor.name} * #{int_factor}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="642">
          
          
          <code class="ruby">    elsif ducting == Constants.VentTypeBalanced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="643">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{tamb_act_actuator.name} = T_hpwh_inlet_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="644">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{tamb_act2_actuator.name} = #{amb_temp_sensor.name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="645">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{rhamb_act_actuator.name} = HPWH_out_rh_#{unit_index}/100&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{sens_act_actuator.name} = 0 - #{tl_sensor.name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="647">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{lat_act_actuator.name} = 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="648">
          
          
          <code class="ruby">    elsif ducting == Constants.VentTypeSupply</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="649">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set rho = (@RhoAirFnPbTdbW HPWH_amb_P_#{unit_index} HPWHTair_out_#{unit_index} HPWHWair_out_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="650">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set cp = (@CpAirFnWTdb HPWHWair_out_#{unit_index} HPWHTair_out_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="651">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set h = (@HFnTdbW HPWHTair_out_#{unit_index} HPWHWair_out_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="652">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWH_sens_gain = rho*cp*(HPWHTair_out_#{unit_index}-#{amb_temp_sensor.name})*V_airHPWH_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="653">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWH_lat_gain = h*rho*(HPWHWair_out_#{unit_index}-#{amb_w_sensor.name})*V_airHPWH_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="654">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{tamb_act_actuator.name} = T_hpwh_inlet_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="655">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{tamb_act2_actuator.name} = #{amb_temp_sensor.name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="656">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{rhamb_act_actuator.name} = HPWH_out_rh_#{unit_index}/100&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="657">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{sens_act_actuator.name} = HPWH_sens_gain_#{unit_index} - #{tl_sensor.name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="658">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{lat_act_actuator.name} = HPWH_lat_gain_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="659">
          
          
          <code class="ruby">    elsif ducting == Constants.VentTypeExhaust</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="660">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set rho = (@RhoAirFnPbTdbW HPWH_amb_P_#{unit_index} HPWHTair_out_#{unit_index} HPWHWair_out_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="661">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set cp = (@CpAirFnWTdb HPWHWair_out_#{unit_index} HPWHTair_out_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="662">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set h = (@HFnTdbW HPWHTair_out_#{unit_index} HPWHWair_out_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="663">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWH_sens_gain = rho*cp*(#{tout_sensor.name}-#{amb_temp_sensor.name})*V_airHPWH_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="664">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set HPWH_lat_gain = h*rho*(Wout_#{unit_index}-#{amb_w_sensor.name})*V_airHPWH_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="665">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{tamb_act_actuator.name} = T_hpwh_inlet_#{unit_index}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="666">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{rhamb_act_actuator.name} = #{amb_rh_sensor.name}/100&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="667">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{sens_act_actuator.name} = HPWH_sens_gain_#{unit_index} - #{tl_sensor.name}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="668">
          
          
          <code class="ruby">      hpwh_ducting_program.addLine(&quot;Set #{lat_act_actuator.name} = HPWH_lat_gain_#{unit_index}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="670">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="671">
          
          
          <code class="ruby">    leschedoverride_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_bottom_element_sp, &quot;Schedule:Constant&quot;, &quot;Schedule Value&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="672">
          
          
          <code class="ruby">    leschedoverride_actuator.setName(&quot;#{obj_name_hpwh} LESchedOverride&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby">    # EMS for the 50 gal HPWH control logic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="675">
          
          
          <code class="ruby">    if hpwh_param == 80</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="676">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">      hpwh_ctrl_program = OpenStudio::Model::EnergyManagementSystemProgram.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">      hpwh_ctrl_program.setName(&quot;#{obj_name_hpwh} Control&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="679">
          
          
          <code class="ruby">      if ducting == Constants.VentTypeSupply or ducting == Constants.VentTypeBalanced</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="680">
          
          
          <code class="ruby">        hpwh_ctrl_program.addLine(&quot;If (HPWH_out_temp_#{unit_index} &lt; #{UnitConversions.convert(min_temp, &quot;F&quot;, &quot;C&quot;)}) || (HPWH_out_temp_#{unit_index} &gt; #{UnitConversions.convert(max_temp, &quot;F&quot;, &quot;C&quot;)})&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="682">
          
          
          <code class="ruby">        hpwh_ctrl_program.addLine(&quot;If (#{amb_temp_sensor.name}&lt;#{UnitConversions.convert(min_temp, &quot;F&quot;, &quot;C&quot;).round(2)}) || (#{amb_temp_sensor.name}&gt;#{UnitConversions.convert(max_temp, &quot;F&quot;, &quot;C&quot;).round(2)})&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="684">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{leschedoverride_actuator.name} = #{tset_C}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="685">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Else&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="686">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{leschedoverride_actuator.name} = 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="687">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;EndIf&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">    else # hpwh_param == 50</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="691">
          
          
          <code class="ruby">      t_ctrl_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Water Heater Temperature Node 3&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="692">
          
          
          <code class="ruby">      t_ctrl_sensor.setName(&quot;#{obj_name_hpwh} T ctrl&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="693">
          
          
          <code class="ruby">      t_ctrl_sensor.setKeyName(&quot;#{obj_name_hpwh} tank&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="694">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="695">
          
          
          <code class="ruby">      le_p_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Water Heater Heater 2 Heating Energy&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="696">
          
          
          <code class="ruby">      le_p_sensor.setName(&quot;#{obj_name_hpwh} LE P&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="697">
          
          
          <code class="ruby">      le_p_sensor.setKeyName(&quot;#{obj_name_hpwh} tank&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="699">
          
          
          <code class="ruby">      ue_p_sensor = OpenStudio::Model::EnergyManagementSystemSensor.new(model, &quot;Water Heater Heater 1 Heating Energy&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="700">
          
          
          <code class="ruby">      ue_p_sensor.setName(&quot;#{obj_name_hpwh} UE P&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="701">
          
          
          <code class="ruby">      ue_p_sensor.setKeyName(&quot;#{obj_name_hpwh} tank&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="702">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="703">
          
          
          <code class="ruby">      hpschedoverride_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hp_setpoint, &quot;Schedule:Constant&quot;, &quot;Schedule Value&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="704">
          
          
          <code class="ruby">      hpschedoverride_actuator.setName(&quot;#{obj_name_hpwh} HPSchedOverride&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="705">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="706">
          
          
          <code class="ruby">      ueschedoverride_actuator = OpenStudio::Model::EnergyManagementSystemActuator.new(hpwh_top_element_sp, &quot;Schedule:Constant&quot;, &quot;Schedule Value&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="707">
          
          
          <code class="ruby">      ueschedoverride_actuator.setName(&quot;#{obj_name_hpwh} UESchedOverride&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="709">
          
          
          <code class="ruby">      uetrend_trend_var = OpenStudio::Model::EnergyManagementSystemTrendVariable.new(model, ue_p_sensor.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="710">
          
          
          <code class="ruby">      uetrend_trend_var.setName(&quot;#{obj_name_hpwh} UETrend&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="711">
          
          
          <code class="ruby">      uetrend_trend_var.setNumberOfTimestepsToBeLogged(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="713">
          
          
          <code class="ruby">      letrend_trend_var = OpenStudio::Model::EnergyManagementSystemTrendVariable.new(model, le_p_sensor.name.to_s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="714">
          
          
          <code class="ruby">      letrend_trend_var.setName(&quot;#{obj_name_hpwh} LETrend&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">      letrend_trend_var.setNumberOfTimestepsToBeLogged(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="717">
          
          
          <code class="ruby">      ueschedoverridetemp = (tset_C - 1.89).round(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="718">
          
          
          <code class="ruby">      t_ems_control1 = (tset_C - 11.29).round(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="719">
          
          
          <code class="ruby">      t_ems_control2 = (tset_C - 0.39).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="721">
          
          
          <code class="ruby">      hpwh_ctrl_program = OpenStudio::Model::EnergyManagementSystemProgram.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="722">
          
          
          <code class="ruby">      hpwh_ctrl_program.setName(&quot;#{obj_name_hpwh} Control&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="723">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{ueschedoverride_actuator.name} = #{ueschedoverridetemp}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{hpschedoverride_actuator.name} = #{tset_C}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="725">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set UEMax_#{unit_index} = (@TrendMax #{uetrend_trend_var.name} 2)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set LEMax_#{unit_index} = (@TrendMax #{letrend_trend_var.name} 2)&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="727">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set ElemOn_#{unit_index} = (@Max UEMax_#{unit_index} LEMax_#{unit_index})&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="728">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;If (#{t_ctrl_sensor.name}&lt;#{t_ems_control1}) || ((ElemOn_#{unit_index}&gt;0) &amp;&amp; (#{t_ctrl_sensor.name}&lt;#{t_ems_control2}))&quot;) # Small offset in second value is to prevent the element overshooting the setpoint due to mixing</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="729">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{leschedoverride_actuator.name} = 70&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="730">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{hpschedoverride_actuator.name} = 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="731">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Else&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{leschedoverride_actuator.name} = 0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="733">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;Set #{hpschedoverride_actuator.name} = #{tset_C}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="734">
          
          
          <code class="ruby">      hpwh_ctrl_program.addLine(&quot;EndIf&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="735">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="736">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="737">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="738">
          
          
          <code class="ruby">    # ProgramCallingManagers</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="739">
          
          
          <code class="ruby">    program_calling_manager = OpenStudio::Model::EnergyManagementSystemProgramCallingManager.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="740">
          
          
          <code class="ruby">    program_calling_manager.setName(&quot;#{obj_name_hpwh} ProgramManager&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="741">
          
          
          <code class="ruby">    program_calling_manager.setCallingPoint(&quot;InsideHVACSystemIterationLoop&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="742">
          
          
          <code class="ruby">    program_calling_manager.addProgram(hpwh_ctrl_program)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="743">
          
          
          <code class="ruby">    program_calling_manager.addProgram(hpwh_ducting_program)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="744">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="745">
          
          
          <code class="ruby">    storage_tank = Waterheater.get_shw_storage_tank(model, unit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="747">
          
          
          <code class="ruby">    if storage_tank.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="748">
          
          
          <code class="ruby">      loop.addSupplyBranchForComponent(tank)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="749">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="750">
          
          
          <code class="ruby">      storage_tank.setHeater1SetpointTemperatureSchedule(tank.heater1SetpointTemperatureSchedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="751">
          
          
          <code class="ruby">      storage_tank.setHeater2SetpointTemperatureSchedule(tank.heater2SetpointTemperatureSchedule)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="752">
          
          
          <code class="ruby">      tank.addToNode(storage_tank.supplyOutletModelObject.get.to_Node.get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="754">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="755">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="758">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove(model, runner) # TODO: Make unit specific</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="759">
          
          
          <code class="ruby">    obj_name = Constants.ObjectNameWaterHeater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="760">
          
          
          <code class="ruby">    model.getPlantLoops.each do |pl|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="761">
          
          
          <code class="ruby">      next if not pl.name.to_s.start_with? Constants.PlantLoopDomesticWater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="763">
          
          
          <code class="ruby">      # Remove existing water heater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">      objects_to_remove = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="765">
          
          
          <code class="ruby">      pl.supplyComponents.each do |wh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="766">
          
          
          <code class="ruby">        next if !wh.to_WaterHeaterMixed.is_initialized and !wh.to_WaterHeaterStratified.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="767">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="768">
          
          
          <code class="ruby">        if wh.to_WaterHeaterMixed.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="769">
          
          
          <code class="ruby">          objects_to_remove &lt;&lt; wh</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="770">
          
          
          <code class="ruby">          if wh.to_WaterHeaterMixed.get.setpointTemperatureSchedule.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="771">
          
          
          <code class="ruby">            objects_to_remove &lt;&lt; wh.to_WaterHeaterMixed.get.setpointTemperatureSchedule.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="773">
          
          
          <code class="ruby">        elsif wh.to_WaterHeaterStratified.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">          if not wh.to_WaterHeaterStratified.get.secondaryPlantLoop.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">            model.getWaterHeaterHeatPumpWrappedCondensers.each do |hpwh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">              objects_to_remove &lt;&lt; hpwh.tank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="777">
          
          
          <code class="ruby">              objects_to_remove &lt;&lt; hpwh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="779">
          
          
          <code class="ruby">            objects_to_remove &lt;&lt; wh.to_WaterHeaterStratified.get.heater1SetpointTemperatureSchedule</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="780">
          
          
          <code class="ruby">            objects_to_remove &lt;&lt; wh.to_WaterHeaterStratified.get.heater2SetpointTemperatureSchedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="782">
          
          
          <code class="ruby">            # Remove existing HPWH objects</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="783">
          
          
          <code class="ruby">            obj_name_underscore = obj_name.gsub(&quot; &quot;, &quot;_&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="784">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="785">
          
          
          <code class="ruby">            model.getEnergyManagementSystemProgramCallingManagers.each do |program_calling_manager|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="786">
          
          
          <code class="ruby">              next unless program_calling_manager.name.to_s.include? obj_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="788">
          
          
          <code class="ruby">              program_calling_manager.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="789">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="790">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="791">
          
          
          <code class="ruby">            model.getEnergyManagementSystemSensors.each do |sensor|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="792">
          
          
          <code class="ruby">              next unless sensor.name.to_s.include? obj_name_underscore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="793">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="794">
          
          
          <code class="ruby">              sensor.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="796">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="797">
          
          
          <code class="ruby">            model.getEnergyManagementSystemActuators.each do |actuator|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="798">
          
          
          <code class="ruby">              next unless actuator.name.to_s.include? obj_name_underscore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="799">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="800">
          
          
          <code class="ruby">              actuatedComponent = actuator.actuatedComponent</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="801">
          
          
          <code class="ruby">              if actuatedComponent.is_a? OpenStudio::Model::OptionalModelObject # 2.4.0 or higher</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="802">
          
          
          <code class="ruby">                actuatedComponent = actuatedComponent.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="803">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="804">
          
          
          <code class="ruby">              if actuatedComponent.to_OtherEquipment.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="805">
          
          
          <code class="ruby">                actuatedComponent.to_OtherEquipment.get.otherEquipmentDefinition.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="806">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="807">
          
          
          <code class="ruby">              actuator.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="808">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="809">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">            model.getScheduleConstants.each do |schedule|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="811">
          
          
          <code class="ruby">              next unless schedule.name.to_s.include? obj_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="813">
          
          
          <code class="ruby">              schedule.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="814">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="815">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="816">
          
          
          <code class="ruby">            model.getEnergyManagementSystemPrograms.each do |program|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="817">
          
          
          <code class="ruby">              next unless program.name.to_s.include? obj_name_underscore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="819">
          
          
          <code class="ruby">              program.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="820">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">            model.getEnergyManagementSystemTrendVariables.each do |trend_var|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="823">
          
          
          <code class="ruby">              next unless trend_var.name.to_s.include? obj_name_underscore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="825">
          
          
          <code class="ruby">              trend_var.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="826">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="827">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="830">
          
          
          <code class="ruby">      if objects_to_remove.size &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="831">
          
          
          <code class="ruby">        runner.registerInfo(&quot;Removed existing water heater from plant loop &#39;#{pl.name.to_s}&#39;.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="832">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="833">
          
          
          <code class="ruby">      objects_to_remove.uniq.each do |object|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="834">
          
          
          <code class="ruby">        begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="835">
          
          
          <code class="ruby">          object.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby">        rescue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="837">
          
          
          <code class="ruby">          # no op</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="838">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="839">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="840">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="841">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="842">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="843">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_location_hierarchy(ba_cz_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="844">
          
          
          <code class="ruby">    if [Constants.BAZoneHotDry, Constants.BAZoneHotHumid].include? ba_cz_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="845">
          
          
          <code class="ruby">      return [Constants.SpaceTypeGarage,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="846">
          
          
          <code class="ruby">              Constants.SpaceTypeLiving,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="847">
          
          
          <code class="ruby">              Constants.SpaceTypeFinishedBasement,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="848">
          
          
          <code class="ruby">              Constants.SpaceTypeLaundryRoom,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="849">
          
          
          <code class="ruby">              Constants.SpaceTypeCrawl,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="850">
          
          
          <code class="ruby">              Constants.SpaceTypeUnfinishedAttic]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="851">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="852">
          
          
          <code class="ruby">    elsif [Constants.BAZoneMarine, Constants.BAZoneMixedHumid, Constants.BAZoneMixedDry, Constants.BAZoneCold, Constants.BAZoneVeryCold, Constants.BAZoneSubarctic].include? ba_cz_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="853">
          
          
          <code class="ruby">      return [Constants.SpaceTypeFinishedBasement,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby">              Constants.SpaceTypeUnfinishedBasement,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="855">
          
          
          <code class="ruby">              Constants.SpaceTypeLiving,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="856">
          
          
          <code class="ruby">              Constants.SpaceTypeLaundryRoom,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="857">
          
          
          <code class="ruby">              Constants.SpaceTypeCrawl,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="858">
          
          
          <code class="ruby">              Constants.SpaceTypeUnfinishedAttic]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="859">
          
          
          <code class="ruby">    elsif ba_cz_name.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="860">
          
          
          <code class="ruby">      return [Constants.SpaceTypeFinishedBasement,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="861">
          
          
          <code class="ruby">              Constants.SpaceTypeUnfinishedBasement,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="862">
          
          
          <code class="ruby">              Constants.SpaceTypeGarage,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="863">
          
          
          <code class="ruby">              Constants.SpaceTypeLiving]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="864">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="865">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="866">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="867">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calc_capacity(cap, fuel, num_beds, num_baths)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="868">
          
          
          <code class="ruby">    # Calculate the capacity of the water heater based on the fuel type and number of bedrooms and bathrooms in a home</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="869">
          
          
          <code class="ruby">    # returns the capacity in kBtu/hr</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="870">
          
          
          <code class="ruby">    if cap == Constants.Auto</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="871">
          
          
          <code class="ruby">      if fuel != Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="872">
          
          
          <code class="ruby">        if num_beds &lt;= 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="873">
          
          
          <code class="ruby">          input_power = 36</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="874">
          
          
          <code class="ruby">        elsif num_beds == 4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="875">
          
          
          <code class="ruby">          if num_baths &lt;= 2.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="876">
          
          
          <code class="ruby">            input_power = 36</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="877">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="878">
          
          
          <code class="ruby">            input_power = 38</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="879">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="880">
          
          
          <code class="ruby">        elsif num_beds == 5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="881">
          
          
          <code class="ruby">          input_power = 47</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="882">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="883">
          
          
          <code class="ruby">          input_power = 50</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="884">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="885">
          
          
          <code class="ruby">        return input_power</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="886">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="887">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="888">
          
          
          <code class="ruby">        if num_beds == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="889">
          
          
          <code class="ruby">          input_power = UnitConversions.convert(2.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="890">
          
          
          <code class="ruby">        elsif num_beds == 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="891">
          
          
          <code class="ruby">          if num_baths &lt;= 1.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="892">
          
          
          <code class="ruby">            input_power = UnitConversions.convert(3.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="893">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="894">
          
          
          <code class="ruby">            input_power = UnitConversions.convert(4.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="895">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="896">
          
          
          <code class="ruby">        elsif num_beds == 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="897">
          
          
          <code class="ruby">          if num_baths &lt;= 1.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="898">
          
          
          <code class="ruby">            input_power = UnitConversions.convert(4.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="899">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="900">
          
          
          <code class="ruby">            input_power = UnitConversions.convert(5.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="901">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="902">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="903">
          
          
          <code class="ruby">          input_power = UnitConversions.convert(5.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="904">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="905">
          
          
          <code class="ruby">        return input_power</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="906">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="907">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="908">
          
          
          <code class="ruby">    else # fixed heater size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="909">
          
          
          <code class="ruby">      return cap.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="910">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="911">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="912">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="913">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calc_water_heater_capacity(fuel, num_beds)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="914">
          
          
          <code class="ruby">    # Calculate the capacity of the water heater based on the fuel type and number of bedrooms and bathrooms in a home</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="915">
          
          
          <code class="ruby">    # returns the capacity in kBtu/hr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="916">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="917">
          
          
          <code class="ruby">    # From https://www.sansomeandgeorge.co.uk/news-updates/what-is-the-ideal-ratio-of-bathrooms-to-bedrooms.html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="918">
          
          
          <code class="ruby">    # &quot;According to 70% of estate agents, a property should have two bathrooms for every three bedrooms...&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="919">
          
          
          <code class="ruby">    num_baths = 2.0 / 3.0 * num_beds</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="920">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="921">
          
          
          <code class="ruby">    if fuel != Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="922">
          
          
          <code class="ruby">      if num_beds &lt;= 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="923">
          
          
          <code class="ruby">        input_power = 36</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="924">
          
          
          <code class="ruby">      elsif num_beds == 4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="925">
          
          
          <code class="ruby">        if num_baths &lt;= 2.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="926">
          
          
          <code class="ruby">          input_power = 36</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="927">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="928">
          
          
          <code class="ruby">          input_power = 38</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="929">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="930">
          
          
          <code class="ruby">      elsif num_beds == 5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="931">
          
          
          <code class="ruby">        input_power = 47</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="932">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="933">
          
          
          <code class="ruby">        input_power = 50</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="934">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="935">
          
          
          <code class="ruby">      return input_power</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="936">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="937">
          
          
          <code class="ruby">      if num_beds == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="938">
          
          
          <code class="ruby">        input_power = UnitConversions.convert(2.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="939">
          
          
          <code class="ruby">      elsif num_beds == 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="940">
          
          
          <code class="ruby">        if num_baths &lt;= 1.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="941">
          
          
          <code class="ruby">          input_power = UnitConversions.convert(3.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="942">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="943">
          
          
          <code class="ruby">          input_power = UnitConversions.convert(4.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="944">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="945">
          
          
          <code class="ruby">      elsif num_beds == 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="946">
          
          
          <code class="ruby">        if num_baths &lt;= 1.5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="947">
          
          
          <code class="ruby">          input_power = UnitConversions.convert(4.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="948">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="949">
          
          
          <code class="ruby">          input_power = UnitConversions.convert(5.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="950">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="951">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="952">
          
          
          <code class="ruby">        input_power = UnitConversions.convert(5.5, &quot;kW&quot;, &quot;kBtu/hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="953">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="954">
          
          
          <code class="ruby">      return input_power</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="955">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="956">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="957">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="958">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calc_ef_from_uef(uef, type, fuel_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="959">
          
          
          <code class="ruby">    # Interpretation on Water Heater UEF</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="960">
          
          
          <code class="ruby">    if fuel_type == Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="961">
          
          
          <code class="ruby">      if type == Constants.WaterHeaterTypeTank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="962">
          
          
          <code class="ruby">        return [2.4029 * uef - 1.2844, 0.96].min</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="963">
          
          
          <code class="ruby">      elsif type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="964">
          
          
          <code class="ruby">        return uef</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="965">
          
          
          <code class="ruby">      elsif type == Constants.WaterHeaterTypeHeatPump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="966">
          
          
          <code class="ruby">        return 1.2101 * uef - 0.6052</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="967">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="968">
          
          
          <code class="ruby">    else # Fuel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="969">
          
          
          <code class="ruby">      if type == Constants.WaterHeaterTypeTank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="970">
          
          
          <code class="ruby">        return 0.9066 * uef + 0.0711</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="971">
          
          
          <code class="ruby">      elsif type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="972">
          
          
          <code class="ruby">        return uef</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="973">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="974">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="975">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="976">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="977">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="978">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_default_hot_water_temperature(eri_version)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="979">
          
          
          <code class="ruby">    if eri_version.include? &quot;A&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="980">
          
          
          <code class="ruby">      return 125.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="981">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="982">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="983">
          
          
          <code class="ruby">    return 120.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="984">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="985">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="986">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_ef_multiplier(type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="987">
          
          
          <code class="ruby">    if type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="988">
          
          
          <code class="ruby">      return 0.92</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="989">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="990">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="991">
          
          
          <code class="ruby">    return 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="992">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="993">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="994">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="995">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="996">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_shw_storage_tank(model, unit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="997">
          
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="998">
          
          
          <code class="ruby">      next unless plant_loop.name.to_s == Constants.PlantLoopSolarHotWater(unit.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="999">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1000">
          
          
          <code class="ruby">      (plant_loop.supplyComponents + plant_loop.demandComponents).each do |component|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1001">
          
          
          <code class="ruby">        if component.to_WaterHeaterStratified.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1002">
          
          
          <code class="ruby">          return component.to_WaterHeaterStratified.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1003">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1004">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1005">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1006">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1007">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1008">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1009">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_plant_loop_from_string(model, runner, plantloop_s, unit)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="1010">
          <span class="hits">22</span>
          
          <code class="ruby">    if plantloop_s == Constants.Auto</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="1011">
          <span class="hits">22</span>
          
          <code class="ruby">      model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="1012">
          <span class="hits">55</span>
          
          <code class="ruby">        next if plant_loop.name.to_s != Constants.PlantLoopDomesticWater(unit.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1013">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="1014">
          <span class="hits">21</span>
          
          <code class="ruby">        return plant_loop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1015">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1016">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1017">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1018">
          <span class="hits">1</span>
          
          <code class="ruby">    model.getPlantLoops.each do |plant_loop|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1019">
          
          
          <code class="ruby">      next if pl.name.to_s != plantloop_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1020">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1021">
          
          
          <code class="ruby">      return plant_loop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1022">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1023">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1024">
          <span class="hits">1</span>
          
          <code class="ruby">    runner.registerError(&quot;Could not find plant loop.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1025">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1026">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1027">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1028">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.deadband(wh_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1029">
          
          
          <code class="ruby">    if wh_type == Constants.WaterHeaterTypeTank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1030">
          
          
          <code class="ruby">      return 2.0 # deg-C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1031">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1032">
          
          
          <code class="ruby">      return 0.0 # deg-C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1033">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1034">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1035">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1036">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calc_actual_tankvol(vol, fuel, wh_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1037">
          
          
          <code class="ruby">    # Convert the nominal tank volume to an actual volume</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1038">
          
          
          <code class="ruby">    if wh_type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1039">
          
          
          <code class="ruby">      act_vol = 1 # gal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1040">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1041">
          
          
          <code class="ruby">      if fuel == Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1042">
          
          
          <code class="ruby">        act_vol = 0.9 * vol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1043">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1044">
          
          
          <code class="ruby">        act_vol = 0.95 * vol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1045">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1046">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1047">
          
          
          <code class="ruby">    return act_vol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1048">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1049">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1050">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calc_tank_UA(vol, fuel, ef, re, pow, wh_type, cyc_derate)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1051">
          
          
          <code class="ruby">    # Calculates the U value, UA of the tank and conversion efficiency (eta_c)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1052">
          
          
          <code class="ruby">    # based on the Energy Factor and recovery efficiency of the tank</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1053">
          
          
          <code class="ruby">    # Source: Burch and Erickson 2004 - http://www.nrel.gov/docs/gen/fy04/36035.pdf</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1054">
          
          
          <code class="ruby">    if wh_type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1055">
          
          
          <code class="ruby">      eta_c = ef * (1 - cyc_derate)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1056">
          
          
          <code class="ruby">      ua = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1057">
          
          
          <code class="ruby">      surface_area = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1058">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1059">
          
          
          <code class="ruby">      pi = Math::PI</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1060">
          
          
          <code class="ruby">      volume_drawn = 64.3 # gal/day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1061">
          
          
          <code class="ruby">      density = 8.2938 # lb/gal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1062">
          
          
          <code class="ruby">      draw_mass = volume_drawn * density # lb</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1063">
          
          
          <code class="ruby">      cp = 1.0007 # Btu/lb-F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1064">
          
          
          <code class="ruby">      t = 135 # F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1065">
          
          
          <code class="ruby">      t_in = 58 # F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1066">
          
          
          <code class="ruby">      t_env = 67.5 # F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1067">
          
          
          <code class="ruby">      q_load = draw_mass * cp * (t - t_in) # Btu/day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1068">
          
          
          <code class="ruby">      height = 48 # inches</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1069">
          
          
          <code class="ruby">      diameter = 24 * ((vol * 0.1337) / (height / 12 * pi))**0.5 # inches</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1070">
          
          
          <code class="ruby">      surface_area = 2 * pi * (diameter / 12)**2 / 4 + pi * (diameter / 12) * (height / 12) # sqft</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1071">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1072">
          
          
          <code class="ruby">      if fuel != Constants.FuelTypeElectric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1073">
          
          
          <code class="ruby">        ua = (re / ef - 1) / ((t - t_env) * (24 / q_load - 1 / (1000 * (pow) * ef))) # Btu/hr-F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1074">
          
          
          <code class="ruby">        eta_c = (re + ua * (t - t_env) / (1000 * pow))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1075">
          
          
          <code class="ruby">      else # is Electric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1076">
          
          
          <code class="ruby">        ua = q_load * (1 / ef - 1) / ((t - t_env) * 24)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1077">
          
          
          <code class="ruby">        eta_c = 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1078">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1079">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1080">
          
          
          <code class="ruby">    u = ua / surface_area # Btu/hr-ft^2-F</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1081">
          
          
          <code class="ruby">    return u, ua, eta_c</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1082">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1083">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1084">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_new_pump(model)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1085">
          
          
          <code class="ruby">    # Add a pump to the new DHW loop</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1086">
          
          
          <code class="ruby">    pump = OpenStudio::Model::PumpVariableSpeed.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1087">
          
          
          <code class="ruby">    pump.setRatedFlowRate(0.01)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1088">
          
          
          <code class="ruby">    pump.setFractionofMotorInefficienciestoFluidStream(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1089">
          
          
          <code class="ruby">    pump.setMotorEfficiency(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1090">
          
          
          <code class="ruby">    pump.setRatedPowerConsumption(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1091">
          
          
          <code class="ruby">    pump.setRatedPumpHead(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1092">
          
          
          <code class="ruby">    pump.setCoefficient1ofthePartLoadPerformanceCurve(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1093">
          
          
          <code class="ruby">    pump.setCoefficient2ofthePartLoadPerformanceCurve(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1094">
          
          
          <code class="ruby">    pump.setCoefficient3ofthePartLoadPerformanceCurve(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1095">
          
          
          <code class="ruby">    pump.setCoefficient4ofthePartLoadPerformanceCurve(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1096">
          
          
          <code class="ruby">    pump.setPumpControlType(&quot;Intermittent&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1097">
          
          
          <code class="ruby">    return pump</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1098">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1099">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1100">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_new_schedule_manager(t_set, model, wh_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1101">
          
          
          <code class="ruby">    new_schedule = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1102">
          
          
          <code class="ruby">    new_schedule.setName(&quot;dhw temp&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1103">
          
          
          <code class="ruby">    new_schedule.setValue(UnitConversions.convert(t_set, &quot;F&quot;, &quot;C&quot;) + deadband(wh_type) / 2.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1104">
          
          
          <code class="ruby">    OpenStudio::Model::SetpointManagerScheduled.new(model, new_schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1107">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_new_heater(name, cap, fuel, vol, ef, re, t_set, thermal_zone, oncycle_p, offcycle_p, ec_adj, wh_type, cyc_derate, nbeds, model, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1108">
          
          
          <code class="ruby">    new_heater = OpenStudio::Model::WaterHeaterMixed.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1109">
          
          
          <code class="ruby">    new_heater.setName(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1110">
          
          
          <code class="ruby">    act_vol = calc_actual_tankvol(vol, fuel, wh_type)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1111">
          
          
          <code class="ruby">    u, ua, eta_c = calc_tank_UA(act_vol, fuel, ef, re, cap, wh_type, cyc_derate)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1112">
          
          
          <code class="ruby">    configure_setpoint_schedule(new_heater, t_set, wh_type, model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1113">
          
          
          <code class="ruby">    new_heater.setMaximumTemperatureLimit(99.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1114">
          
          
          <code class="ruby">    if wh_type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1115">
          
          
          <code class="ruby">      new_heater.setHeaterControlType(&quot;Modulate&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1116">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1117">
          
          
          <code class="ruby">      new_heater.setHeaterControlType(&quot;Cycle&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1119">
          
          
          <code class="ruby">    new_heater.setDeadbandTemperatureDifference(deadband(wh_type))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1121">
          
          
          <code class="ruby">    new_heater.setHeaterMinimumCapacity(0.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1122">
          
          
          <code class="ruby">    new_heater.setHeaterMaximumCapacity(UnitConversions.convert(cap, &quot;kBtu/hr&quot;, &quot;W&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1123">
          
          
          <code class="ruby">    new_heater.setHeaterFuelType(HelperMethods.eplus_fuel_map(fuel))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1124">
          
          
          <code class="ruby">    new_heater.setHeaterThermalEfficiency(eta_c / ec_adj)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1125">
          
          
          <code class="ruby">    new_heater.setTankVolume(UnitConversions.convert(act_vol, &quot;gal&quot;, &quot;m^3&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1127">
          
          
          <code class="ruby">    # Set parasitic power consumption</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1128">
          
          
          <code class="ruby">    if wh_type == Constants.WaterHeaterTypeTankless</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1129">
          
          
          <code class="ruby">      # Tankless WHs are set to &quot;modulate&quot;, not &quot;cycle&quot;, so they end up</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1130">
          
          
          <code class="ruby">      # effectively always on. Thus, we need to use a weighted-average of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1131">
          
          
          <code class="ruby">      # on-cycle and off-cycle parasitics.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1132">
          
          
          <code class="ruby">      # Values used here are based on the average across 10 units originally used when modeling MF buildings</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1133">
          
          
          <code class="ruby">      avg_runtime_frac = [0.0268, 0.0333, 0.0397, 0.0462, 0.0529]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1134">
          
          
          <code class="ruby">      runtime_frac = avg_runtime_frac[nbeds - 1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1135">
          
          
          <code class="ruby">      avg_elec = oncycle_p * runtime_frac + offcycle_p * (1 - runtime_frac)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1137">
          
          
          <code class="ruby">      new_heater.setOnCycleParasiticFuelConsumptionRate(avg_elec)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1138">
          
          
          <code class="ruby">      new_heater.setOffCycleParasiticFuelConsumptionRate(avg_elec)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1139">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1140">
          
          
          <code class="ruby">      new_heater.setOnCycleParasiticFuelConsumptionRate(oncycle_p)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1141">
          
          
          <code class="ruby">      new_heater.setOffCycleParasiticFuelConsumptionRate(offcycle_p)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1142">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1143">
          
          
          <code class="ruby">    new_heater.setOnCycleParasiticFuelType(&quot;Electricity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1144">
          
          
          <code class="ruby">    new_heater.setOffCycleParasiticFuelType(&quot;Electricity&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1145">
          
          
          <code class="ruby">    new_heater.setOnCycleParasiticHeatFractiontoTank(0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1146">
          
          
          <code class="ruby">    new_heater.setOffCycleParasiticHeatFractiontoTank(0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1148">
          
          
          <code class="ruby">    # Set fraction of heat loss from tank to ambient (vs out flue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1149">
          
          
          <code class="ruby">    # Based on lab testing done by LBNL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1150">
          
          
          <code class="ruby">    skinlossfrac = 1.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1151">
          
          
          <code class="ruby">    if fuel != Constants.FuelTypeElectric and wh_type == Constants.WaterHeaterTypeTank</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1152">
          
          
          <code class="ruby">      if oncycle_p == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1153">
          
          
          <code class="ruby">        skinlossfrac = 0.64</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1154">
          
          
          <code class="ruby">      elsif ef &lt; 0.8</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1155">
          
          
          <code class="ruby">        skinlossfrac = 0.91</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1156">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1157">
          
          
          <code class="ruby">        skinlossfrac = 0.96</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1158">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1159">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1160">
          
          
          <code class="ruby">    new_heater.setOffCycleLossFractiontoThermalZone(skinlossfrac)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1161">
          
          
          <code class="ruby">    new_heater.setOnCycleLossFractiontoThermalZone(1.0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1163">
          
          
          <code class="ruby">    new_heater.setAmbientTemperatureIndicator(&quot;ThermalZone&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1164">
          
          
          <code class="ruby">    new_heater.setAmbientTemperatureThermalZone(thermal_zone)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1165">
          
          
          <code class="ruby">    if new_heater.ambientTemperatureSchedule.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1166">
          
          
          <code class="ruby">      new_heater.ambientTemperatureSchedule.get.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1167">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1168">
          
          
          <code class="ruby">    ua_w_k = UnitConversions.convert(ua, &quot;Btu/(hr*F)&quot;, &quot;W/K&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1169">
          
          
          <code class="ruby">    new_heater.setOnCycleLossCoefficienttoAmbientTemperature(ua_w_k)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1170">
          
          
          <code class="ruby">    new_heater.setOffCycleLossCoefficienttoAmbientTemperature(ua_w_k)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1171">
          
          
          <code class="ruby">    new_heater.setEndUseSubcategory(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1173">
          
          
          <code class="ruby">    return new_heater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1174">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1176">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.configure_setpoint_schedule(new_heater, t_set, wh_type, model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1177">
          
          
          <code class="ruby">    set_temp_c = UnitConversions.convert(t_set, &quot;F&quot;, &quot;C&quot;) + deadband(wh_type) / 2.0 # Half the deadband to account for E+ deadband</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1178">
          
          
          <code class="ruby">    new_schedule = OpenStudio::Model::ScheduleConstant.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1179">
          
          
          <code class="ruby">    new_schedule.setName(&quot;WH Setpoint Temp&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1180">
          
          
          <code class="ruby">    new_schedule.setValue(set_temp_c)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1181">
          
          
          <code class="ruby">    if new_heater.setpointTemperatureSchedule.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1182">
          
          
          <code class="ruby">      new_heater.setpointTemperatureSchedule.get.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1183">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1184">
          
          
          <code class="ruby">    new_heater.setSetpointTemperatureSchedule(new_schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1185">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1187">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_new_loop(model, name, t_set, wh_type)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1188">
          
          
          <code class="ruby">    # Create a new plant loop for the water heater</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1189">
          
          
          <code class="ruby">    loop = OpenStudio::Model::PlantLoop.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1190">
          
          
          <code class="ruby">    loop.setName(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1191">
          
          
          <code class="ruby">    loop.sizingPlant.setDesignLoopExitTemperature(UnitConversions.convert(t_set, &quot;F&quot;, &quot;C&quot;) + deadband(wh_type) / 2.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1192">
          
          
          <code class="ruby">    loop.sizingPlant.setLoopDesignTemperatureDifference(UnitConversions.convert(10, &quot;R&quot;, &quot;K&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1193">
          
          
          <code class="ruby">    loop.setPlantLoopVolume(0.003) # ~1 gal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1194">
          
          
          <code class="ruby">    loop.setMaximumLoopFlowRate(0.01) # This size represents the physical limitations to flow due to losses in the piping system. For BEopt we assume that the pipes are always adequately sized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1196">
          
          
          <code class="ruby">    bypass_pipe = OpenStudio::Model::PipeAdiabatic.new(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1197">
          
          
          <code class="ruby">    out_pipe = OpenStudio::Model::PipeAdiabatic.new(model)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1199">
          
          
          <code class="ruby">    loop.addSupplyBranchForComponent(bypass_pipe)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1200">
          
          
          <code class="ruby">    out_pipe.addToNode(loop.supplyOutletNode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1202">
          
          
          <code class="ruby">    return loop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1203">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1205">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1206">
          
          
          <code class="ruby">    plant_loop.supplyComponents.each do |wh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1207">
          
          
          <code class="ruby">      if wh.to_WaterHeaterMixed.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1208">
          
          
          <code class="ruby">        return wh.to_WaterHeaterMixed.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1209">
          
          
          <code class="ruby">      elsif wh.to_WaterHeaterStratified.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1210">
          
          
          <code class="ruby">        waterHeater = wh.to_WaterHeaterStratified.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1211">
          
          
          <code class="ruby">        # Look for attached HPWH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1212">
          
          
          <code class="ruby">        model.getWaterHeaterHeatPumpWrappedCondensers.each do |hpwh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1213">
          
          
          <code class="ruby">          next if not hpwh.tank.to_WaterHeaterStratified.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1214">
          
          
          <code class="ruby">          next if hpwh.tank.to_WaterHeaterStratified.get != waterHeater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1216">
          
          
          <code class="ruby">          return hpwh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1217">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1218">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1219">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1220">
          
          
          <code class="ruby">    runner.registerError(&quot;No water heater found; add a residential water heater first.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1221">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1222">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1224">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_water_heater_setpoint(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1225">
          
          
          <code class="ruby">    waterHeater = get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1226">
          
          
          <code class="ruby">    if waterHeater.is_a? OpenStudio::Model::WaterHeaterMixed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1227">
          
          
          <code class="ruby">      if waterHeater.setpointTemperatureSchedule.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1228">
          
          
          <code class="ruby">        runner.registerError(&quot;Water heater found without a setpoint temperature schedule.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1229">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1230">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1231">
          
          
          <code class="ruby">      return UnitConversions.convert(waterHeater.setpointTemperatureSchedule.get.to_ScheduleConstant.get.value - waterHeater.deadbandTemperatureDifference / 2.0, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1232">
          
          
          <code class="ruby">    elsif waterHeater.is_a? OpenStudio::Model::WaterHeaterHeatPumpWrappedCondenser</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1233">
          
          
          <code class="ruby">      if waterHeater.compressorSetpointTemperatureSchedule.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1234">
          
          
          <code class="ruby">        runner.registerError(&quot;Heat pump water heater found without a setpoint temperature schedule.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1235">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1236">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1237">
          
          
          <code class="ruby">      return UnitConversions.convert(waterHeater.compressorSetpointTemperatureSchedule.to_ScheduleConstant.get.value, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1238">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1239">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1240">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1242">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_water_heater_setpoint_schedule(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1243">
          
          
          <code class="ruby">    waterHeater = get_water_heater(model, plant_loop, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1244">
          
          
          <code class="ruby">    if waterHeater.is_a? OpenStudio::Model::WaterHeaterMixed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1245">
          
          
          <code class="ruby">      if waterHeater.setpointTemperatureSchedule.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1246">
          
          
          <code class="ruby">        runner.registerError(&quot;Water heater found without a setpoint temperature schedule.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1247">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1248">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1249">
          
          
          <code class="ruby">      return waterHeater.setpointTemperatureSchedule.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1250">
          
          
          <code class="ruby">    elsif waterHeater.is_a? OpenStudio::Model::WaterHeaterHeatPumpWrappedCondenser</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1251">
          
          
          <code class="ruby">      if waterHeater.compressorSetpointTemperatureSchedule.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1252">
          
          
          <code class="ruby">        runner.registerError(&quot;Heat pump water heater found without a setpoint temperature schedule.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1253">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1254">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1255">
          
          
          <code class="ruby">      return waterHeater.compressorSetpointTemperatureSchedule</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1256">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1257">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1258">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1259">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="0aa39e41020e8931587412864b17907370c35c3d">
  <div class="header">
    <h3>measures/HPXMLtoOpenStudio/resources/weather.rb</h3>
    <h4><span class="red">9.17 %</span> covered</h4>
    <div>
      <b>458</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>416</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;psychrometrics&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;constants&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &quot;unit_conversions&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class WeatherHeader</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  ATTRS ||= [:City, :State, :Country, :DataSource, :Station, :Latitude, :Longitude, :Timezone, :Altitude, :LocalPressure, :RecordsPerHour]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor(*ATTRS)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">class WeatherData</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  ATTRS ||= [:AnnualAvgDrybulb, :AnnualMinDrybulb, :AnnualMaxDrybulb, :CDD50F, :CDD65F, :HDD50F, :HDD65F, :AnnualAvgWindspeed, :MonthlyAvgDrybulbs, :GroundMonthlyTemps, :WSF, :MonthlyAvgDailyHighDrybulbs, :MonthlyAvgDailyLowDrybulbs]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor(*ATTRS)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">class WeatherDesign</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  ATTRS ||= [:HeatingDrybulb, :HeatingWindspeed, :CoolingDrybulb, :CoolingWetbulb, :CoolingHumidityRatio, :CoolingWindspeed, :DailyTemperatureRange, :DehumidDrybulb, :DehumidHumidityRatio, :CoolingDirectNormal, :CoolingDiffuseHorizontal]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor(*ATTRS)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">class WeatherProcess</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(model, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    @error = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    @model = model</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    @runner = runner</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    @header = WeatherHeader.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    @data = WeatherData.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    @design = WeatherDesign.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    @epw_path = WeatherProcess.get_epw_path(@model, @runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    if @epw_path.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      @error = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    if not File.exist?(@epw_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      @runner.registerError(&quot;Cannot find weather file at #{epw_path}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      @error = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    @epw_file = OpenStudio::EpwFile.new(@epw_path, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    cached = get_cached_weather(@model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    return if cached or @error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    process_epw</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    cache_weather(@model)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def epw_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    return @epw_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_design_days_for_autosizing</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    heating_design_day = OpenStudio::Model::DesignDay.new(@model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    heating_design_day.setName(&quot;Ann Htg 99% Condns DB&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    heating_design_day.setMaximumDryBulbTemperature(UnitConversions.convert(@design.HeatingDrybulb, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    heating_design_day.setHumidityIndicatingConditionsAtMaximumDryBulb(UnitConversions.convert(@design.HeatingDrybulb, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    heating_design_day.setBarometricPressure(UnitConversions.convert(Psychrometrics.Pstd_fZ(@header.Altitude), &quot;psi&quot;, &quot;pa&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    heating_design_day.setWindSpeed(@design.HeatingWindspeed)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    heating_design_day.setDayOfMonth(21)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    heating_design_day.setMonth(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    heating_design_day.setDayType(&quot;WinterDesignDay&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    heating_design_day.setHumidityIndicatingType(&quot;Wetbulb&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    heating_design_day.setDryBulbTemperatureRangeModifierType(&quot;DefaultMultipliers&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    heating_design_day.setSolarModelIndicator(&quot;ASHRAEClearSky&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    cooling_design_day = OpenStudio::Model::DesignDay.new(@model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    cooling_design_day.setName(&quot;Ann Clg 1% Condns DB=&gt;MWB&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    cooling_design_day.setMaximumDryBulbTemperature(UnitConversions.convert(@design.CoolingDrybulb, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    cooling_design_day.setDailyDryBulbTemperatureRange(UnitConversions.convert(@design.DailyTemperatureRange, &quot;R&quot;, &quot;K&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    cooling_design_day.setHumidityIndicatingConditionsAtMaximumDryBulb(UnitConversions.convert(@design.CoolingWetbulb, &quot;F&quot;, &quot;C&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    cooling_design_day.setBarometricPressure(UnitConversions.convert(Psychrometrics.Pstd_fZ(@header.Altitude), &quot;psi&quot;, &quot;pa&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    cooling_design_day.setWindSpeed(@design.CoolingWindspeed)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    cooling_design_day.setDayOfMonth(21)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    cooling_design_day.setMonth(7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    cooling_design_day.setDayType(&quot;SummerDesignDay&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    cooling_design_day.setHumidityIndicatingType(&quot;Wetbulb&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    cooling_design_day.setDryBulbTemperatureRangeModifierType(&quot;DefaultMultipliers&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    cooling_design_day.setSolarModelIndicator(&quot;ASHRAEClearSky&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_days_for_month(month, is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    if [1, 3, 5, 7, 8, 10, 12].include? month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">      days = (1..31)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    elsif [4, 6, 9, 11].include? month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      days = (1..30)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    elsif [2].include? month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">      days = (1..(28 + is_leap_year))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  def actual_year_timestamps(reporting_frequency)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    start_actual_year = @epw_file.startDateActualYear</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    end_actual_year = @epw_file.endDateActualYear</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">    timestamps = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    if start_actual_year.is_initialized and end_actual_year.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">      start_actual_year = start_actual_year.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      end_actual_year = end_actual_year.get</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">      is_leap_year = { true =&gt; 1, false =&gt; 0 }[@model.getYearDescription.isLeapYear]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      run_period = @model.getRunPeriod</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      start_time = Time.new(start_actual_year, run_period.getBeginMonth, run_period.getBeginDayOfMonth, 0, 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      end_time = Time.new(end_actual_year, run_period.getEndMonth, run_period.getEndDayOfMonth, 24)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      if reporting_frequency == &quot;Timestep&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">        tstep = @model.getTimestep.numberOfTimestepsPerHour</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">        (start_actual_year..(end_actual_year + 1)).to_a.each do |year|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">          (1..12).to_a.each do |month|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">            days = get_days_for_month(month, is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">            days.to_a.each do |day|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">              (0..23).to_a.each do |hour|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">                (0..60 - (60 / tstep)).step(60 / tstep).to_a.each do |minute|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">                  ts = Time.new(year, month, day, hour, minute)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">                  next if ts &lt; start_time or ts &gt; end_time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">                  ts = ts.strftime(&quot;%Y/%m/%d %H:%M:00&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">                  timestamps &lt;&lt; ts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">      elsif reporting_frequency == &quot;Hourly&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">        (start_actual_year..end_actual_year).to_a.each do |year|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">          (1..12).to_a.each do |month|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">            days = get_days_for_month(month, is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">            days.to_a.each do |day|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">              (1..24).to_a.each do |hour|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">                ts = Time.new(year, month, day, hour)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">                next if ts &lt; start_time or ts &gt; end_time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">                ts = ts.strftime(&quot;%Y/%m/%d %H:00:00&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">                timestamps &lt;&lt; ts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">      elsif reporting_frequency == &quot;Daily&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">        (start_actual_year..end_actual_year + 1).to_a.each do |year|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">          (1..12).to_a.each do |month|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">            days = get_days_for_month(month, is_leap_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">            days.to_a.each do |day|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">              ts = Time.new(year, month, day)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">              next if ts &lt; start_time or ts &gt; end_time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">              ts = ts.strftime(&quot;%Y/%m/%d 00:00:00&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">              timestamps &lt;&lt; ts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">      elsif reporting_frequency == &quot;Monthly&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">        (start_actual_year..end_actual_year + 1).to_a.each do |year|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">          (1..12).to_a.each do |month|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">            ts = Time.new(year, month)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">            next if ts &lt; start_time or ts &gt; end_time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">            ts = ts.strftime(&quot;%Y/%m/01 00:00:00&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">            timestamps &lt;&lt; ts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">      elsif reporting_frequency == &quot;Runperiod&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">        ts = Time.new(end_actual_year + 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">        ts = ts.strftime(&quot;%Y/01/01 00:00:00&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">        timestamps &lt;&lt; ts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">    return timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="181">
          <span class="hits">1</span>
          
          <code class="ruby">  def error?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">    return @error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">  def cache_weather(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">    wf_ap = model.weatherFile.get.additionalProperties</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">    # Header</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    WeatherHeader::ATTRS.each do |k|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">      k = k.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">      # string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">      if [&#39;City&#39;, &#39;State&#39;, &#39;Country&#39;, &#39;DataSource&#39;, &#39;Station&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">        wf_ap.setFeature(&quot;EPWHeader#{k}&quot;, @header.send(k).to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">      # double</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">      elsif [&#39;Latitude&#39;, &#39;Longitude&#39;, &#39;Timezone&#39;, &#39;Altitude&#39;, &#39;LocalPressure&#39;, &#39;RecordsPerHour&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="196">
          
          
          <code class="ruby">        wf_ap.setFeature(&quot;EPWHeader#{k}&quot;, @header.send(k).to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="198">
          
          
          <code class="ruby">        @runner.registerError(&quot;Weather header key #{k} not handled.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">    # Data</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="205">
          
          
          <code class="ruby">    WeatherData::ATTRS.each do |k|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">      k = k.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">      # double</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">      if [&#39;AnnualAvgDrybulb&#39;, &#39;AnnualMinDrybulb&#39;, &#39;AnnualMaxDrybulb&#39;, &#39;CDD50F&#39;, &#39;CDD65F&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">          &#39;HDD50F&#39;, &#39;HDD65F&#39;, &#39;AnnualAvgWindspeed&#39;, &#39;WSF&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">        wf_ap.setFeature(&quot;EPWData#{k}&quot;, @data.send(k).to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">      # array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="212">
          
          
          <code class="ruby">      elsif [&#39;MonthlyAvgDrybulbs&#39;, &#39;GroundMonthlyTemps&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">             &#39;MonthlyAvgDailyHighDrybulbs&#39;, &#39;MonthlyAvgDailyLowDrybulbs&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">        wf_ap.setFeature(&quot;EPWData#{k}&quot;, @data.send(k).join(&quot;,&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">        @runner.registerError(&quot;Weather data key #{k} not handled.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    # Design</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">    WeatherDesign::ATTRS.each do |k|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">      k = k.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">      # double</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">      wf_ap.setFeature(&quot;EPWDesign#{k}&quot;, @design.send(k).to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">  def marshal_dump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">    return [@header, @data, @design]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">  def marshal_load(array)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">    @header, @data, @design = array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor(:header, :data, :design)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="240">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_epw_path(model, runner)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">    if model.weatherFile.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">      wf = model.weatherFile.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">      # Sometimes path is available, sometimes just url. Should be improved in OS 2.0.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      if wf.path.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">        epw_path = wf.path.get.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">        epw_path = wf.url.to_s.sub(&quot;file:///&quot;, &quot;&quot;).sub(&quot;file://&quot;, &quot;&quot;).sub(&quot;file:&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">      if not File.exists? epw_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">        epw_path = File.absolute_path(File.join(File.dirname(__FILE__), epw_path))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">      return epw_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    runner.registerError(&quot;Model has not been assigned a weather file.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_cached_weather(model)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="263">
          
          
          <code class="ruby">    wf_ap = model.weatherFile.get.additionalProperties</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    # Header</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    WeatherHeader::ATTRS.each do |k|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">      k = k.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">      # string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">      if [&#39;City&#39;, &#39;State&#39;, &#39;Country&#39;, &#39;DataSource&#39;, &#39;Station&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">        @header.send(k + &quot;=&quot;, wf_ap.getFeatureAsString(&quot;EPWHeader#{k}&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">        return false if !@header.send(k).is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">        @header.send(k + &quot;=&quot;, @header.send(k).get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">      # double</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">      elsif [&#39;Latitude&#39;, &#39;Longitude&#39;, &#39;Timezone&#39;, &#39;Altitude&#39;, &#39;LocalPressure&#39;, &#39;RecordsPerHour&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">        @header.send(k + &quot;=&quot;, wf_ap.getFeatureAsDouble(&quot;EPWHeader#{k}&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">        return false if !@header.send(k).is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">        @header.send(k + &quot;=&quot;, @header.send(k).get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="281">
          
          
          <code class="ruby">        @runner.registerError(&quot;Weather header key #{k} not handled.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">    # Data</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">    WeatherData::ATTRS.each do |k|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">      k = k.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">      # double</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">      if [&#39;AnnualAvgDrybulb&#39;, &#39;AnnualMinDrybulb&#39;, &#39;AnnualMaxDrybulb&#39;, &#39;CDD50F&#39;, &#39;CDD65F&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">          &#39;HDD50F&#39;, &#39;HDD65F&#39;, &#39;AnnualAvgWindspeed&#39;, &#39;WSF&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">        @data.send(k + &quot;=&quot;, wf_ap.getFeatureAsDouble(&quot;EPWData#{k}&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">        return false if !@data.send(k).is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">        @data.send(k + &quot;=&quot;, @data.send(k).get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">      # array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">      elsif [&#39;MonthlyAvgDrybulbs&#39;, &#39;GroundMonthlyTemps&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">             &#39;MonthlyAvgDailyHighDrybulbs&#39;, &#39;MonthlyAvgDailyLowDrybulbs&#39;].include? k</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">        @data.send(k + &quot;=&quot;, wf_ap.getFeatureAsString(&quot;EPWData#{k}&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">        return false if !@data.send(k).is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">        @data.send(k + &quot;=&quot;, @data.send(k).get.split(&quot;,&quot;).map(&amp;:to_f))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">        @runner.registerError(&quot;Weather data key #{k} not handled.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby">    # Design</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">    WeatherDesign::ATTRS.each do |k|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="313">
          
          
          <code class="ruby">      k = k.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">      # double</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="315">
          
          
          <code class="ruby">      @design.send(k + &quot;=&quot;, wf_ap.getFeatureAsDouble(&quot;EPWDesign#{k}&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">      return false if !@design.send(k).is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">      @design.send(k + &quot;=&quot;, @design.send(k).get)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="324">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_epw</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">    # Header info:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">    @header.City = @epw_file.city</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">    @header.State = @epw_file.stateProvinceRegion</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">    @header.Country = @epw_file.country</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="329">
          
          
          <code class="ruby">    @header.DataSource = @epw_file.dataSource</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">    @header.Station = @epw_file.wmoNumber</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">    @header.Latitude = @epw_file.latitude</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">    @header.Longitude = @epw_file.longitude</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    @header.Timezone = @epw_file.timeZone</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">    @header.Altitude = UnitConversions.convert(@epw_file.elevation, &quot;m&quot;, &quot;ft&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">    @header.LocalPressure = Math::exp(-0.0000368 * @header.Altitude) # atm</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">    @header.RecordsPerHour = @epw_file.recordsPerHour</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    epw_file_data = @epw_file.data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">    epwHasDesignData = get_design_info_from_epw</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">    # Timeseries data:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">    rowdata = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">    dailydbs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">    dailyhighdbs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">    dailylowdbs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">    epw_file_data.each_with_index do |epwdata, rownum|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">      rowdict = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">      rowdict[&#39;month&#39;] = epwdata.month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">      rowdict[&#39;day&#39;] = epwdata.day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">      rowdict[&#39;hour&#39;] = epwdata.hour</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">      if epwdata.dryBulbTemperature.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">        rowdict[&#39;db&#39;] = epwdata.dryBulbTemperature.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="355">
          
          
          <code class="ruby">        @runner.registerError(&quot;Cannot retrieve dryBulbTemperature from the EPW for hour #{rownum + 1}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">      if epwdata.dewPointTemperature.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">        rowdict[&#39;dp&#39;] = epwdata.dewPointTemperature.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="361">
          
          
          <code class="ruby">        @runner.registerError(&quot;Cannot retrieve dewPointTemperature from the EPW for hour #{rownum + 1}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="362">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="364">
          
          
          <code class="ruby">      if epwdata.relativeHumidity.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">        rowdict[&#39;rh&#39;] = epwdata.relativeHumidity.get / 100.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">        @runner.registerError(&quot;Cannot retrieve relativeHumidity from the EPW for hour #{rownum + 1}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="368">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="370">
          
          
          <code class="ruby">      if epwdata.directNormalRadiation.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="371">
          
          
          <code class="ruby">        rowdict[&#39;dirnormal&#39;] = epwdata.directNormalRadiation.get # W/m^2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="373">
          
          
          <code class="ruby">        @runner.registerError(&quot;Cannot retrieve directNormalRadiation from the EPW for hour #{rownum + 1}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="374">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">      if epwdata.diffuseHorizontalRadiation.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">        rowdict[&#39;diffhoriz&#39;] = epwdata.diffuseHorizontalRadiation.get # W/m^2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="379">
          
          
          <code class="ruby">        @runner.registerError(&quot;Cannot retrieve diffuseHorizontalRadiation from the EPW for hour #{rownum + 1}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">      if epwdata.windSpeed.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">        rowdict[&#39;ws&#39;] = epwdata.windSpeed.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">        @runner.registerError(&quot;Cannot retrieve windSpeed from the EPW for hour #{rownum + 1}.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">        @error = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">      if @error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">        return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">      rowdata &lt;&lt; rowdict</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">      if (rownum + 1) % (24 * @header.RecordsPerHour) == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="396">
          
          
          <code class="ruby">        db = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="397">
          
          
          <code class="ruby">        maxdb = rowdata[rowdata.length - (24 * @header.RecordsPerHour)][&#39;db&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">        mindb = rowdata[rowdata.length - (24 * @header.RecordsPerHour)][&#39;db&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">        rowdata[rowdata.length - (24 * @header.RecordsPerHour)..-1].each do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">          if x[&#39;db&#39;] &gt; maxdb</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">            maxdb = x[&#39;db&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">          if x[&#39;db&#39;] &lt; mindb</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">            mindb = x[&#39;db&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="406">
          
          
          <code class="ruby">          db &lt;&lt; x[&#39;db&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">        dailydbs &lt;&lt; db.inject { |sum, n| sum + n } / (24.0 * @header.RecordsPerHour)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="410">
          
          
          <code class="ruby">        dailyhighdbs &lt;&lt; maxdb</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="411">
          
          
          <code class="ruby">        dailylowdbs &lt;&lt; mindb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="413">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="416">
          
          
          <code class="ruby">    year_description = @model.getYearDescription</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">    num_days_in_months = Constants.NumDaysInMonths(year_description.isLeapYear)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">    calc_annual_drybulbs(rowdata)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="420">
          
          
          <code class="ruby">    calc_monthly_drybulbs(rowdata)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="421">
          
          
          <code class="ruby">    calc_heat_cool_degree_days(rowdata, dailydbs)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="422">
          
          
          <code class="ruby">    calc_avg_highs_lows(dailyhighdbs, dailylowdbs, num_days_in_months)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="423">
          
          
          <code class="ruby">    calc_avg_windspeed(rowdata)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">    calc_ground_temperatures</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">    @data.WSF = get_ashrae_622_wsf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="427">
          
          
          <code class="ruby">    if not epwHasDesignData</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="428">
          
          
          <code class="ruby">      @runner.registerWarning(&quot;No design condition info found; calculating design conditions from EPW weather data.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="429">
          
          
          <code class="ruby">      calc_design_info(rowdata)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">      @design.DailyTemperatureRange = @data.MonthlyAvgDailyHighDrybulbs[7] - @data.MonthlyAvgDailyLowDrybulbs[7]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">    calc_design_solar_radiation(rowdata)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="435">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="436">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_annual_drybulbs(hd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">    # Calculates and stores annual average, minimum, and maximum drybulbs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="438">
          
          
          <code class="ruby">    db = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="439">
          
          
          <code class="ruby">    mindict = hd[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="440">
          
          
          <code class="ruby">    maxdict = hd[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">    hd.each do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">      if x[&#39;db&#39;] &gt; maxdict[&#39;db&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="443">
          
          
          <code class="ruby">        maxdict = x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="445">
          
          
          <code class="ruby">      if x[&#39;db&#39;] &lt; mindict[&#39;db&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="446">
          
          
          <code class="ruby">        mindict = x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">      db &lt;&lt; x[&#39;db&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="449">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="450">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">    @data.AnnualAvgDrybulb = UnitConversions.convert(db.inject { |sum, n| sum + n } / db.length, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="452">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby">    # Peak temperatures:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">    @data.AnnualMinDrybulb = UnitConversions.convert(mindict[&#39;db&#39;], &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">    @data.AnnualMaxDrybulb = UnitConversions.convert(maxdict[&#39;db&#39;], &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="458">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_monthly_drybulbs(hd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">    # Calculates and stores monthly average drybulbs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">    @data.MonthlyAvgDrybulbs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">    (1..12).to_a.each do |month|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">      y = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">      hd.each do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">        if x[&#39;month&#39;] == month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="465">
          
          
          <code class="ruby">          y &lt;&lt; x[&#39;db&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="468">
          
          
          <code class="ruby">      month_dbtotal = y.inject { |sum, n| sum + n }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="469">
          
          
          <code class="ruby">      month_hours = y.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">      @data.MonthlyAvgDrybulbs &lt;&lt; UnitConversions.convert(month_dbtotal / month_hours, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="473">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="474">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_avg_windspeed(hd)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="475">
          
          
          <code class="ruby">    # Calculates and stores annual average windspeed</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="476">
          
          
          <code class="ruby">    ws = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="477">
          
          
          <code class="ruby">    hd.each do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="478">
          
          
          <code class="ruby">      ws &lt;&lt; x[&#39;ws&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="480">
          
          
          <code class="ruby">    avgws = ws.inject { |sum, n| sum + n } / ws.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="481">
          
          
          <code class="ruby">    @data.AnnualAvgWindspeed = avgws</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="484">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_heat_cool_degree_days(hd, dailydbs)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby">    # Calculates and stores heating/cooling degree days</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="486">
          
          
          <code class="ruby">    @data.HDD65F = calc_degree_days(dailydbs, 65, true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="487">
          
          
          <code class="ruby">    @data.HDD50F = calc_degree_days(dailydbs, 50, true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="488">
          
          
          <code class="ruby">    @data.CDD65F = calc_degree_days(dailydbs, 65, false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    @data.CDD50F = calc_degree_days(dailydbs, 50, false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="492">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_degree_days(daily_dbs, base_temp_f, is_heating)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">    # Calculates and returns degree days from a base temperature for either heating or cooling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="494">
          
          
          <code class="ruby">    base_temp_c = UnitConversions.convert(base_temp_f, &quot;F&quot;, &quot;C&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="496">
          
          
          <code class="ruby">    deg_days = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="497">
          
          
          <code class="ruby">    if is_heating</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="498">
          
          
          <code class="ruby">      daily_dbs.each do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="499">
          
          
          <code class="ruby">        if x &lt; base_temp_c</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="500">
          
          
          <code class="ruby">          deg_days &lt;&lt; base_temp_c - x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="504">
          
          
          <code class="ruby">      daily_dbs.each do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">        if x &gt; base_temp_c</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="506">
          
          
          <code class="ruby">          deg_days &lt;&lt; x - base_temp_c</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">    if deg_days.size == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">      return 0.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">    deg_days = deg_days.inject { |sum, n| sum + n }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="515">
          
          
          <code class="ruby">    return 1.8 * deg_days</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="517">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="518">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_avg_highs_lows(daily_high_dbs, daily_low_dbs, num_days_in_months)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby">    # Calculates and stores avg daily highs and lows for each month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="520">
          
          
          <code class="ruby">    @data.MonthlyAvgDailyHighDrybulbs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="521">
          
          
          <code class="ruby">    @data.MonthlyAvgDailyLowDrybulbs = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="523">
          
          
          <code class="ruby">    first_day = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="524">
          
          
          <code class="ruby">    for month in 1..12</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="525">
          
          
          <code class="ruby">      ndays = num_days_in_months[month - 1] # Number of days in current month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="526">
          
          
          <code class="ruby">      if month &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="527">
          
          
          <code class="ruby">        first_day += num_days_in_months[month - 2] # Number of days in previous month</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">      avg_high = daily_high_dbs[first_day, ndays].inject { |sum, n| sum + n } / ndays.to_f</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="530">
          
          
          <code class="ruby">      avg_low = daily_low_dbs[first_day, ndays].inject { |sum, n| sum + n } / ndays.to_f</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="531">
          
          
          <code class="ruby">      @data.MonthlyAvgDailyHighDrybulbs &lt;&lt; UnitConversions.convert(avg_high, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="532">
          
          
          <code class="ruby">      @data.MonthlyAvgDailyLowDrybulbs &lt;&lt; UnitConversions.convert(avg_low, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="534">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="535">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="536">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_design_solar_radiation(rowdata)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby">    # Calculate cooling design day info, for roof surface sol air temperature, which is used for attic temperature calculation for Manual J/ASHRAE Std 152:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby">    # Max summer direct normal solar radiation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby">    # Diffuse horizontal solar radiation during hour with max direct normal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="540">
          
          
          <code class="ruby">    summer_rowdata = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="541">
          
          
          <code class="ruby">    months = [6, 7, 8, 9]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">    for hr in 0..(rowdata.size - 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="543">
          
          
          <code class="ruby">      next if not months.include?(rowdata[hr][&#39;month&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">      summer_rowdata &lt;&lt; rowdata[hr]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="548">
          
          
          <code class="ruby">    r_d = (1 + Math::cos(26.565052 * Math::PI / 180)) / 2 # Correct diffuse horizontal for tilt. Assume 6:12 roof pitch for this calculation.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="549">
          
          
          <code class="ruby">    max_solar_radiation_hour = summer_rowdata[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="550">
          
          
          <code class="ruby">    for hr in 1..(summer_rowdata.size - 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="551">
          
          
          <code class="ruby">      next if summer_rowdata[hr][&#39;dirnormal&#39;] + summer_rowdata[hr][&#39;diffhoriz&#39;] * r_d &lt; max_solar_radiation_hour[&#39;dirnormal&#39;] + max_solar_radiation_hour[&#39;diffhoriz&#39;] * r_d</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="553">
          
          
          <code class="ruby">      max_solar_radiation_hour = summer_rowdata[hr]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="556">
          
          
          <code class="ruby">    @design.CoolingDirectNormal = max_solar_radiation_hour[&#39;dirnormal&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="557">
          
          
          <code class="ruby">    @design.CoolingDiffuseHorizontal = max_solar_radiation_hour[&#39;diffhoriz&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="560">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_ashrae_622_wsf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">    # Looks up the ASHRAE 62.2 weather and shielding factor from ASHRAE622WSF</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">    # for the specified WMO station number. If not found, uses the average value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby">    # in the file.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">    # Sets the WSF value.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="566">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="567">
          
          
          <code class="ruby">    ashrae_csv = File.join(File.dirname(__FILE__), &#39;ASHRAE622WSF.csv&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="568">
          
          
          <code class="ruby">    if not File.exists?(ashrae_csv)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="570">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">    ashrae_csvlines = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="573">
          
          
          <code class="ruby">    File.open(ashrae_csv) do |file|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby">      # if not os.path.exists(ashrae_csv):</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">      #    raise IOError(&quot;Cannot find file &quot; + ashrae_csv)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="576">
          
          
          <code class="ruby">      file.each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="577">
          
          
          <code class="ruby">        line = line.strip.chomp.chomp(&#39;,&#39;).chomp # remove RHS whitespace and extra comma</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">        ashrae_csvlines &lt;&lt; line</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="581">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="582">
          
          
          <code class="ruby">    keys = ashrae_csvlines.delete_at(0).split(&#39;,&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="583">
          
          
          <code class="ruby">    ashrae_dict = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="584">
          
          
          <code class="ruby">    ashrae_csvlines.each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="585">
          
          
          <code class="ruby">      line = line.split(&#39;,&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">      ashrae_dict &lt;&lt; Hash[keys.zip(line)]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="588">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="589">
          
          
          <code class="ruby">    wsfs = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="590">
          
          
          <code class="ruby">    ashrae_dict.each do |adict|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="591">
          
          
          <code class="ruby">      if adict[&#39;TMY3&#39;] == @header.Station</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="592">
          
          
          <code class="ruby">        return adict[&#39;wsf&#39;].to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="595">
          
          
          <code class="ruby">      wsfs &lt;&lt; adict[&#39;wsf&#39;].to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="597">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="598">
          
          
          <code class="ruby">    # Value not found, use average</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">    wsf_avg = wsfs.inject { |sum, n| sum + n } / wsfs.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="600">
          
          
          <code class="ruby">    @runner.registerWarning(&quot;ASHRAE 62.2 WSF not found for station number #{@header.Station.to_s}, using the national average value of #{wsf_avg.round(3).to_s} instead.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="601">
          
          
          <code class="ruby">    return wsf_avg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="603">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="604">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_design_info_from_epw</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="605">
          
          
          <code class="ruby">    epw_design_conditions = @epw_file.designConditions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="606">
          
          
          <code class="ruby">    epwHasDesignData = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="607">
          
          
          <code class="ruby">    if epw_design_conditions.length &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="608">
          
          
          <code class="ruby">      epwHasDesignData = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="609">
          
          
          <code class="ruby">      epw_design_conditions = epw_design_conditions[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="610">
          
          
          <code class="ruby">      @design.HeatingDrybulb = UnitConversions.convert(epw_design_conditions.heatingDryBulb99, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="611">
          
          
          <code class="ruby">      @design.HeatingWindspeed = epw_design_conditions.heatingColdestMonthWindSpeed1 # TODO: This field is consistent with BEopt, but should be heatingMeanCoincidentWindSpeed99pt6 instead?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="612">
          
          
          <code class="ruby">      @design.CoolingDrybulb = UnitConversions.convert(epw_design_conditions.coolingDryBulb1, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="613">
          
          
          <code class="ruby">      @design.CoolingWetbulb = UnitConversions.convert(epw_design_conditions.coolingMeanCoincidentWetBulb1, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="614">
          
          
          <code class="ruby">      @design.CoolingWindspeed = epw_design_conditions.coolingMeanCoincidentWindSpeed0pt4</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="615">
          
          
          <code class="ruby">      @design.DailyTemperatureRange = UnitConversions.convert(epw_design_conditions.coolingDryBulbRange, &quot;K&quot;, &quot;R&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">      @design.DehumidDrybulb = UnitConversions.convert(epw_design_conditions.coolingDehumidificationMeanCoincidentDryBulb2, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="617">
          
          
          <code class="ruby">      dehum02per_dp = UnitConversions.convert(epw_design_conditions.coolingDehumidificationDewPoint2, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="618">
          
          
          <code class="ruby">      std_press = Psychrometrics.Pstd_fZ(@header.Altitude)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="619">
          
          
          <code class="ruby">      @design.CoolingHumidityRatio = Psychrometrics.w_fT_Twb_P(design.CoolingDrybulb, design.CoolingWetbulb, std_press)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="620">
          
          
          <code class="ruby">      @design.DehumidHumidityRatio = Psychrometrics.w_fT_Twb_P(dehum02per_dp, dehum02per_dp, std_press)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="621">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="622">
          
          
          <code class="ruby">    return epwHasDesignData</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="623">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="624">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="625">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_design_info(rowdata)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby">    # Calculate design day info:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="627">
          
          
          <code class="ruby">    # - Heating 99% drybulb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="628">
          
          
          <code class="ruby">    # - Heating mean coincident windspeed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby">    # - Cooling 99% drybulb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="630">
          
          
          <code class="ruby">    # - Cooling mean coincident windspeed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">    # - Cooling mean coincident wetbulb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby">    # - Cooling mean coincident humidity ratio</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="634">
          
          
          <code class="ruby">    std_press = Psychrometrics.Pstd_fZ(@header.Altitude)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="635">
          
          
          <code class="ruby">    annual_hd_sorted_by_db = rowdata.sort_by { |x| x[&#39;db&#39;] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="636">
          
          
          <code class="ruby">    annual_hd_sorted_by_dp = rowdata.sort_by { |x| x[&#39;dp&#39;] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="637">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="638">
          
          
          <code class="ruby">    # 1%/99%/2% values</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="639">
          
          
          <code class="ruby">    heat99per_db = annual_hd_sorted_by_db[88 * @header.RecordsPerHour][&#39;db&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">    cool01per_db = annual_hd_sorted_by_db[8673 * @header.RecordsPerHour][&#39;db&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="641">
          
          
          <code class="ruby">    dehum02per_dp = annual_hd_sorted_by_dp[8584 * @header.RecordsPerHour][&#39;dp&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="642">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="643">
          
          
          <code class="ruby">    # Mean coincident values for cooling</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="644">
          
          
          <code class="ruby">    cool_windspeed = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="645">
          
          
          <code class="ruby">    cool_wetbulb = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">    for i in 0..(annual_hd_sorted_by_db.size - 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="647">
          
          
          <code class="ruby">      if (annual_hd_sorted_by_db[i][&#39;db&#39;] &gt; cool01per_db - 0.5) and (annual_hd_sorted_by_db[i][&#39;db&#39;] &lt; cool01per_db + 0.5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="648">
          
          
          <code class="ruby">        cool_windspeed &lt;&lt; annual_hd_sorted_by_db[i][&#39;ws&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="649">
          
          
          <code class="ruby">        wb = Psychrometrics.Twb_fT_R_P(UnitConversions.convert(annual_hd_sorted_by_db[i][&#39;db&#39;], &quot;C&quot;, &quot;F&quot;), annual_hd_sorted_by_db[i][&#39;rh&#39;], std_press)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="650">
          
          
          <code class="ruby">        cool_wetbulb &lt;&lt; wb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="651">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="652">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="653">
          
          
          <code class="ruby">    cool_design_wb = cool_wetbulb.inject { |sum, n| sum + n } / cool_wetbulb.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="654">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="655">
          
          
          <code class="ruby">    # Mean coincident values for heating</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="656">
          
          
          <code class="ruby">    heat_windspeed = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="657">
          
          
          <code class="ruby">    for i in 0..(annual_hd_sorted_by_db.size - 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="658">
          
          
          <code class="ruby">      if (annual_hd_sorted_by_db[i][&#39;db&#39;] &gt; heat99per_db - 0.5) and (annual_hd_sorted_by_db[i][&#39;db&#39;] &lt; heat99per_db + 0.5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="659">
          
          
          <code class="ruby">        heat_windspeed &lt;&lt; annual_hd_sorted_by_db[i][&#39;ws&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="660">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="661">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="662">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="663">
          
          
          <code class="ruby">    # Mean coincident values for dehumidification</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="664">
          
          
          <code class="ruby">    dehum_drybulb = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="665">
          
          
          <code class="ruby">    for i in 0..(annual_hd_sorted_by_dp.size - 1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="666">
          
          
          <code class="ruby">      if (annual_hd_sorted_by_dp[i][&#39;dp&#39;] &gt; dehum02per_dp - 0.5) and (annual_hd_sorted_by_dp[i][&#39;dp&#39;] &lt; dehum02per_dp + 0.5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="667">
          
          
          <code class="ruby">        dehum_drybulb &lt;&lt; annual_hd_sorted_by_dp[i][&#39;db&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="668">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="670">
          
          
          <code class="ruby">    dehum_design_db = dehum_drybulb.inject { |sum, n| sum + n } / dehum_drybulb.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="672">
          
          
          <code class="ruby">    @design.CoolingDrybulb = UnitConversions.convert(cool01per_db, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="673">
          
          
          <code class="ruby">    @design.CoolingWetbulb = cool_design_wb</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="674">
          
          
          <code class="ruby">    @design.CoolingHumidityRatio = Psychrometrics.w_fT_Twb_P(design.CoolingDrybulb, design.CoolingWetbulb, std_press)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="675">
          
          
          <code class="ruby">    @design.CoolingWindspeed = cool_windspeed.inject { |sum, n| sum + n } / cool_windspeed.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="676">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">    @design.HeatingDrybulb = UnitConversions.convert(heat99per_db, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">    @design.HeatingWindspeed = heat_windspeed.inject { |sum, n| sum + n } / heat_windspeed.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="679">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="680">
          
          
          <code class="ruby">    @design.DehumidDrybulb = UnitConversions.convert(dehum_design_db, &quot;C&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="681">
          
          
          <code class="ruby">    @design.DehumidHumidityRatio = Psychrometrics.w_fT_Twb_P(UnitConversions.convert(dehum02per_dp, &quot;C&quot;, &quot;F&quot;), UnitConversions.convert(dehum02per_dp, &quot;C&quot;, &quot;F&quot;), std_press)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="684">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_ground_temperatures</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby">    # Return monthly ground temperatures.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="686">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="687">
          
          
          <code class="ruby">    amon = [15.0, 46.0, 74.0, 95.0, 135.0, 166.0, 196.0, 227.0, 258.0, 288.0, 319.0, 349.0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="688">
          
          
          <code class="ruby">    po = 0.6</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="689">
          
          
          <code class="ruby">    dif = 0.025</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="690">
          
          
          <code class="ruby">    p = UnitConversions.convert(1.0, &quot;yr&quot;, &quot;hr&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="691">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="692">
          
          
          <code class="ruby">    beta = Math::sqrt(Math::PI / (p * dif)) * 10.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="693">
          
          
          <code class="ruby">    x = Math::exp(-beta)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="694">
          
          
          <code class="ruby">    x2 = x * x</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="695">
          
          
          <code class="ruby">    s = Math::sin(beta)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="696">
          
          
          <code class="ruby">    c = Math::cos(beta)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="697">
          
          
          <code class="ruby">    y = (x2 - 2.0 * x * c + 1.0) / (2.0 * beta**2.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="698">
          
          
          <code class="ruby">    gm = Math::sqrt(y)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="699">
          
          
          <code class="ruby">    z = (1.0 - x * (c + s)) / (1.0 - x * (c - s))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="700">
          
          
          <code class="ruby">    phi = Math::atan(z)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="701">
          
          
          <code class="ruby">    bo = (data.MonthlyAvgDrybulbs.max - data.MonthlyAvgDrybulbs.min) * 0.5</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="702">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="703">
          
          
          <code class="ruby">    @data.GroundMonthlyTemps = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="704">
          
          
          <code class="ruby">    (0..11).to_a.each do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="705">
          
          
          <code class="ruby">      theta = amon[i] * 24.0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="706">
          
          
          <code class="ruby">      @data.GroundMonthlyTemps &lt;&lt; UnitConversions.convert(data.AnnualAvgDrybulb - bo * Math::cos(2.0 * Math::PI / p * theta - po - phi) * gm + 460.0, &quot;R&quot;, &quot;F&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="707">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="709">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="710">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.calc_mains_temperatures(avgOAT, maxDiffMonthlyAvgOAT, latitude, num_days_in_year)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="711">
          
          
          <code class="ruby">    pi = Math::PI</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="712">
          
          
          <code class="ruby">    deg_rad = pi / 180</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="713">
          
          
          <code class="ruby">    mainsDailyTemps = Array.new(num_days_in_year, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="714">
          
          
          <code class="ruby">    mainsMonthlyTemps = Array.new(12, 0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">    mainsAvgTemp = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="717">
          
          
          <code class="ruby">    tmains_ratio = 0.4 + 0.01 * (avgOAT - 44)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="718">
          
          
          <code class="ruby">    tmains_lag = 35 - (avgOAT - 44)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="719">
          
          
          <code class="ruby">    if latitude &lt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="720">
          
          
          <code class="ruby">      sign = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="721">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="722">
          
          
          <code class="ruby">      sign = -1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="723">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="724">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="725">
          
          
          <code class="ruby">    # Calculate daily and annual</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">    for d in 1..num_days_in_year</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="727">
          
          
          <code class="ruby">      mainsDailyTemps[d - 1] = avgOAT + 6 + tmains_ratio * maxDiffMonthlyAvgOAT / 2 * Math.sin(deg_rad * (0.986 * (d - 15 - tmains_lag) + sign * 90))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="728">
          
          
          <code class="ruby">      mainsAvgTemp += mainsDailyTemps[d - 1] / num_days_in_year</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="730">
          
          
          <code class="ruby">    # Calculate monthly</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="731">
          
          
          <code class="ruby">    for m in 1..12</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">      mainsMonthlyTemps[m - 1] = avgOAT + 6 + tmains_ratio * maxDiffMonthlyAvgOAT / 2 * Math.sin(deg_rad * (0.986 * ((m * 30 - 15) - 15 - tmains_lag) + sign * 90))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="734">
          
          
          <code class="ruby">    return mainsAvgTemp, mainsMonthlyTemps, mainsDailyTemps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="735">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="736">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="bd7e86cc71296baf36f11dc1c3c7434beed899f7">
  <div class="header">
    <h3>measures/ResidentialHotWaterFixtures/measure.rb</h3>
    <h4><span class="green">94.92 %</span> covered</h4>
    <div>
      <b>256</b> relevant lines. 
      <span class="green"><b>243</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">resources_path = File.absolute_path(File.join(File.dirname(__FILE__), &quot;../HPXMLtoOpenStudio/resources&quot;))</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">unless File.exists? resources_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="3">
          
          
          <code class="ruby">  resources_path = File.join(OpenStudio::BCLMeasure::userMeasuresDir.to_s, &quot;HPXMLtoOpenStudio/resources&quot;) # Hack to run measures in the OS App since applied measures are copied off into a temporary directory</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;schedules&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;constants&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;util&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;weather&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;unit_conversions&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;geometry&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">require File.join(resources_path, &quot;waterheater&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"># start the measure</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">class ResidentialHotWaterFixtures &lt; OpenStudio::Measure::ModelMeasure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  # define the name that a user will see, this method may be deprecated as</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  # the display name in PAT comes from the name field in measure.xml</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def name</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="18">
          <span class="hits">11</span>
          
          <code class="ruby">    return &quot;Set Residential Hot Water Fixtures&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def description</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="22">
          <span class="hits">11</span>
          
          <code class="ruby">    return &quot;Adds (or replaces) residential hot water fixtures -- showers, sinks, and baths. For multifamily buildings, the hot water fixtures can be set for all units of the building.#{Constants.WorkflowDescription}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def modeler_description</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="26">
          <span class="hits">11</span>
          
          <code class="ruby">    return &quot;Creates three new WaterUse:Equipment objects to represent showers, sinks, and baths in a home. OtherEquipment objects are also added to take into account the heat gain in the space due to hot water use.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def arguments(model)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="30">
          <span class="hits">32</span>
          
          <code class="ruby">    ruleset = OpenStudio::Measure</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="31">
          <span class="hits">32</span>
          
          <code class="ruby">    osargument = ruleset::OSArgument</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="33">
          <span class="hits">32</span>
          
          <code class="ruby">    args = ruleset::OSArgumentVector.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    # Shower hot water use multiplier</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="36">
          <span class="hits">32</span>
          
          <code class="ruby">    shower_mult = OpenStudio::Measure::OSArgument::makeDoubleArgument(&quot;shower_mult&quot;, true)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="37">
          <span class="hits">32</span>
          
          <code class="ruby">    shower_mult.setDisplayName(&quot;Multiplier on shower hot water use&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="38">
          <span class="hits">32</span>
          
          <code class="ruby">    shower_mult.setDescription(&quot;Multiplier on Building America HSP shower hot water consumption. HSP prescribes shower hot water consumption of 14 + 4.67 * n_bedrooms gal/day at 110 F.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="39">
          <span class="hits">32</span>
          
          <code class="ruby">    shower_mult.setDefaultValue(1.0)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="40">
          <span class="hits">32</span>
          
          <code class="ruby">    args &lt;&lt; shower_mult</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    # Sink hot water use multiplier</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="43">
          <span class="hits">32</span>
          
          <code class="ruby">    sink_mult = OpenStudio::Measure::OSArgument::makeDoubleArgument(&quot;sink_mult&quot;, true)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="44">
          <span class="hits">32</span>
          
          <code class="ruby">    sink_mult.setDisplayName(&quot;Multiplier on sink hot water use&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="45">
          <span class="hits">32</span>
          
          <code class="ruby">    sink_mult.setDescription(&quot;Multiplier on Building America HSP sink hot water consumption. HSP prescribes sink hot water consumption of 12.5 + 4.16 * n_bedrooms gal/day at 110 F.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="46">
          <span class="hits">32</span>
          
          <code class="ruby">    sink_mult.setDefaultValue(1.0)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="47">
          <span class="hits">32</span>
          
          <code class="ruby">    args &lt;&lt; sink_mult</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    # Bath hot water use multiplier</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="50">
          <span class="hits">32</span>
          
          <code class="ruby">    bath_mult = OpenStudio::Measure::OSArgument::makeDoubleArgument(&quot;bath_mult&quot;, true)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="51">
          <span class="hits">32</span>
          
          <code class="ruby">    bath_mult.setDisplayName(&quot;Multiplier on bath hot water use&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="52">
          <span class="hits">32</span>
          
          <code class="ruby">    bath_mult.setDescription(&quot;Multiplier on Building America HSP bath hot water consumption. HSP prescribes bath hot water consumption of 3.5 + 1.17 * n_bedrooms gal/day at 110 F.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="53">
          <span class="hits">32</span>
          
          <code class="ruby">    bath_mult.setDefaultValue(1.0)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="54">
          <span class="hits">32</span>
          
          <code class="ruby">    args &lt;&lt; bath_mult</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    # make a choice argument for plant loop</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="57">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loops = model.getPlantLoops</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="58">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loop_args = OpenStudio::StringVector.new</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="59">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loop_args &lt;&lt; Constants.Auto</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="60">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loops.each do |plant_loop|</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="61">
          <span class="hits">48</span>
          
          <code class="ruby">      plant_loop_args &lt;&lt; plant_loop.name.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="63">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loop = OpenStudio::Measure::OSArgument::makeChoiceArgument(&quot;plant_loop&quot;, plant_loop_args, true, true)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="64">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loop.setDisplayName(&quot;Plant Loop&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="65">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loop.setDescription(&quot;Select the plant loop for the hot water fixtures. &#39;#{Constants.Auto}&#39; will try to choose the plant loop associated with the specified space. For multifamily buildings, &#39;#{Constants.Auto}&#39; will choose the plant loop for each unit of the building.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="66">
          <span class="hits">32</span>
          
          <code class="ruby">    plant_loop.setDefaultValue(Constants.Auto)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="67">
          <span class="hits">32</span>
          
          <code class="ruby">    args &lt;&lt; plant_loop</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    # make an argument for the number of days to shift the draw profile by</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="70">
          <span class="hits">32</span>
          
          <code class="ruby">    schedule_day_shift = OpenStudio::Measure::OSArgument::makeIntegerArgument(&quot;schedule_day_shift&quot;, true)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="71">
          <span class="hits">32</span>
          
          <code class="ruby">    schedule_day_shift.setDisplayName(&quot;Schedule Day Shift&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="72">
          <span class="hits">32</span>
          
          <code class="ruby">    schedule_day_shift.setDescription(&quot;Draw profiles are shifted to prevent coincident hot water events when performing portfolio analyses. For multifamily buildings, draw profiles for each unit are automatically shifted by one week.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="73">
          <span class="hits">32</span>
          
          <code class="ruby">    schedule_day_shift.setDefaultValue(0)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="74">
          <span class="hits">32</span>
          
          <code class="ruby">    args &lt;&lt; schedule_day_shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="76">
          <span class="hits">32</span>
          
          <code class="ruby">    return args</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end # end the arguments method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  # define what happens when the measure is run</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  def run(model, runner, user_arguments)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="81">
          <span class="hits">16</span>
          
          <code class="ruby">    super(model, runner, user_arguments)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    # use the built-in error checking</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="84">
          <span class="hits">16</span>
          
          <code class="ruby">    if not runner.validateUserArguments(arguments(model), user_arguments)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    # assign the user inputs to variables</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="89">
          <span class="hits">16</span>
          
          <code class="ruby">    sh_mult = runner.getDoubleArgumentValue(&quot;shower_mult&quot;, user_arguments)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="90">
          <span class="hits">16</span>
          
          <code class="ruby">    s_mult = runner.getDoubleArgumentValue(&quot;sink_mult&quot;, user_arguments)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="91">
          <span class="hits">16</span>
          
          <code class="ruby">    b_mult = runner.getDoubleArgumentValue(&quot;bath_mult&quot;, user_arguments)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="92">
          <span class="hits">16</span>
          
          <code class="ruby">    plant_loop_s = runner.getStringArgumentValue(&quot;plant_loop&quot;, user_arguments)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="93">
          <span class="hits">16</span>
          
          <code class="ruby">    d_sh = runner.getIntegerArgumentValue(&quot;schedule_day_shift&quot;, user_arguments)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    # Check for valid and reasonable inputs</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="96">
          <span class="hits">16</span>
          
          <code class="ruby">    if sh_mult &lt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">      runner.registerError(&quot;Shower hot water usage multiplier must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="100">
          <span class="hits">15</span>
          
          <code class="ruby">    if s_mult &lt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">      runner.registerError(&quot;Sink hot water usage multiplier must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="104">
          <span class="hits">14</span>
          
          <code class="ruby">    if b_mult &lt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">      runner.registerError(&quot;Bath hot water usage multiplier must be greater than or equal to 0.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="108">
          <span class="hits">13</span>
          
          <code class="ruby">    if d_sh &lt; 0 or d_sh &gt; 364</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      runner.registerError(&quot;Hot water draw profile can only be shifted by 0-364 days.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">    # Get building units</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="114">
          <span class="hits">13</span>
          
          <code class="ruby">    units = Geometry.get_building_units(model, runner)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="115">
          <span class="hits">13</span>
          
          <code class="ruby">    if units.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    # Remove all existing objects</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="120">
          <span class="hits">12</span>
          
          <code class="ruby">    obj_names = [Constants.ObjectNameShower,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">                 Constants.ObjectNameSink,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">                 Constants.ObjectNameBath]</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="123">
          <span class="hits">12</span>
          
          <code class="ruby">    model.getSpaces.each do |space|</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="124">
          <span class="hits">68</span>
          
          <code class="ruby">      remove_existing(runner, space, obj_names)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="127">
          <span class="hits">12</span>
          
          <code class="ruby">    location_hierarchy = [Constants.SpaceTypeBathroom,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">                          Constants.SpaceTypeLiving,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">                          Constants.SpaceTypeFinishedBasement]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="131">
          <span class="hits">12</span>
          
          <code class="ruby">    tot_sh_gpd = 0</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="132">
          <span class="hits">12</span>
          
          <code class="ruby">    tot_s_gpd = 0</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="133">
          <span class="hits">12</span>
          
          <code class="ruby">    tot_b_gpd = 0</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="134">
          <span class="hits">12</span>
          
          <code class="ruby">    msgs = []</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="135">
          <span class="hits">12</span>
          
          <code class="ruby">    units.each_with_index do |unit, unit_index|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      # Get unit beds/baths</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="137">
          <span class="hits">22</span>
          
          <code class="ruby">      nbeds, nbaths = Geometry.get_unit_beds_baths(model, unit, runner)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="138">
          <span class="hits">22</span>
          
          <code class="ruby">      if nbeds.nil? or nbaths.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">      # Get space</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="143">
          <span class="hits">22</span>
          
          <code class="ruby">      space = Geometry.get_space_from_location(unit, Constants.Auto, location_hierarchy)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="144">
          <span class="hits">22</span>
          
          <code class="ruby">      next if space.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      # Get plant loop</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="147">
          <span class="hits">22</span>
          
          <code class="ruby">      plant_loop = Waterheater.get_plant_loop_from_string(model, runner, plant_loop_s, unit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="149">
          <span class="hits">22</span>
          
          <code class="ruby">      if plant_loop.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="153">
          <span class="hits">21</span>
          
          <code class="ruby">      obj_name_sh = Constants.ObjectNameShower(unit.name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="154">
          <span class="hits">21</span>
          
          <code class="ruby">      obj_name_s = Constants.ObjectNameSink(unit.name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="155">
          <span class="hits">21</span>
          
          <code class="ruby">      obj_name_b = Constants.ObjectNameBath(unit.name.to_s)</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="156">
          <span class="hits">21</span>
          
          <code class="ruby">      obj_name_recirc_pump = Constants.ObjectNameHotWaterRecircPump(unit.name.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="158">
          <span class="hits">21</span>
          
          <code class="ruby">      mixed_use_t = Constants.MixedUseT # F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">      # Calc daily gpm and annual gain of each end use</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="161">
          <span class="hits">21</span>
          
          <code class="ruby">      sh_gpd = (14.0 + 4.67 * nbeds) * sh_mult</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="162">
          <span class="hits">21</span>
          
          <code class="ruby">      s_gpd = (12.5 + 4.16 * nbeds) * s_mult</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="163">
          <span class="hits">21</span>
          
          <code class="ruby">      b_gpd = (3.5 + 1.17 * nbeds) * b_mult</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">      # Shower internal gains</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="166">
          <span class="hits">21</span>
          
          <code class="ruby">      sh_sens_load = (741 + 247 * nbeds) * sh_mult # Btu/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="167">
          <span class="hits">21</span>
          
          <code class="ruby">      sh_lat_load = (703 + 235 * nbeds) * sh_mult # Btu/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="168">
          <span class="hits">21</span>
          
          <code class="ruby">      sh_tot_load = UnitConversions.convert(sh_sens_load + sh_lat_load, &quot;Btu&quot;, &quot;kWh&quot;) # kWh/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="169">
          <span class="hits">21</span>
          
          <code class="ruby">      sh_lat = sh_lat_load / (sh_lat_load + sh_sens_load)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">      # Sink internal gains</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="172">
          <span class="hits">21</span>
          
          <code class="ruby">      s_sens_load = (310 + 103 * nbeds) * s_mult # Btu/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="173">
          <span class="hits">21</span>
          
          <code class="ruby">      s_lat_load = (140 + 47 * nbeds) * s_mult # Btu/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="174">
          <span class="hits">21</span>
          
          <code class="ruby">      s_tot_load = UnitConversions.convert(s_sens_load + s_lat_load, &quot;Btu&quot;, &quot;kWh&quot;) # kWh/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="175">
          <span class="hits">21</span>
          
          <code class="ruby">      s_lat = s_lat_load / (s_lat_load + s_sens_load)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">      # Bath internal gains</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="178">
          <span class="hits">21</span>
          
          <code class="ruby">      b_sens_load = (185 + 62 * nbeds) * b_mult # Btu/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="179">
          <span class="hits">21</span>
          
          <code class="ruby">      b_lat_load = 0 # Btu/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="180">
          <span class="hits">21</span>
          
          <code class="ruby">      b_tot_load = UnitConversions.convert(b_sens_load + b_lat_load, &quot;Btu&quot;, &quot;kWh&quot;) # kWh/day</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="181">
          <span class="hits">21</span>
          
          <code class="ruby">      b_lat = b_lat_load / (b_lat_load + b_sens_load)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="183">
          <span class="hits">21</span>
          
          <code class="ruby">      if sh_gpd &gt; 0 or s_gpd &gt; 0 or b_gpd &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">        # Reuse existing water use connection if possible</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="186">
          <span class="hits">19</span>
          
          <code class="ruby">        water_use_connection = nil</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="187">
          <span class="hits">19</span>
          
          <code class="ruby">        plant_loop.demandComponents.each do |component|</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="188">
          <span class="hits">93</span>
          
          <code class="ruby">          next unless component.to_WaterUseConnections.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="190">
          <span class="hits">2</span>
          
          <code class="ruby">          water_use_connection = component.to_WaterUseConnections.get</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="191">
          <span class="hits">2</span>
          
          <code class="ruby">          break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="193">
          <span class="hits">19</span>
          
          <code class="ruby">        if water_use_connection.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">          # Need new water heater connection</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="195">
          <span class="hits">17</span>
          
          <code class="ruby">          water_use_connection = OpenStudio::Model::WaterUseConnections.new(model)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="196">
          <span class="hits">17</span>
          
          <code class="ruby">          plant_loop.addDemandBranchForComponent(water_use_connection)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      # Showers</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="202">
          <span class="hits">21</span>
          
          <code class="ruby">      if sh_gpd &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">        # Create schedule</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="205">
          <span class="hits">17</span>
          
          <code class="ruby">        sch_sh = HotWaterSchedule.new(model, runner, Constants.ObjectNameShower + &quot; schedule&quot;, Constants.ObjectNameShower + &quot; temperature schedule&quot;, nbeds, d_sh, &quot;Shower&quot;, mixed_use_t, create_sch_object = true, schedule_type_limits_name = Constants.ScheduleTypeLimitsFraction)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="206">
          <span class="hits">17</span>
          
          <code class="ruby">        if not sch_sh.validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">          return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="210">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_peak_flow = sch_sh.calcPeakFlowFromDailygpm(sh_gpd)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="211">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_design_level = sch_sh.calcDesignLevelFromDailykWh(sh_tot_load)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">        # Add water use equipment objects</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="214">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu_def = OpenStudio::Model::WaterUseEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="215">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu = OpenStudio::Model::WaterUseEquipment.new(sh_wu_def)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="216">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu.setName(obj_name_sh)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="217">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu.setSpace(space)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="218">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu_def.setName(obj_name_sh)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="219">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu_def.setPeakFlowRate(sh_peak_flow)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="220">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu_def.setEndUseSubcategory(obj_name_sh)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="221">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu.setFlowRateFractionSchedule(sch_sh.schedule)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="222">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_wu_def.setTargetTemperatureSchedule(sch_sh.temperatureSchedule)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="223">
          <span class="hits">17</span>
          
          <code class="ruby">        water_use_connection.addWaterUseEquipment(sh_wu)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">        # Add other equipment</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="226">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe_def = OpenStudio::Model::OtherEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="227">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe = OpenStudio::Model::OtherEquipment.new(sh_oe_def)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="228">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe.setName(obj_name_sh)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="229">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe.setSpace(space)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="230">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe_def.setName(obj_name_sh)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="231">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe_def.setDesignLevel(sh_design_level)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="232">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe_def.setFractionRadiant(0)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="233">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe_def.setFractionLatent(sh_lat)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="234">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe_def.setFractionLost(0)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="235">
          <span class="hits">17</span>
          
          <code class="ruby">        sh_oe.setSchedule(sch_sh.schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">        # Re-assign recirc pump schedule if needed</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="238">
          <span class="hits">17</span>
          
          <code class="ruby">        recirc_pump = nil</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="239">
          <span class="hits">17</span>
          
          <code class="ruby">        space.otherEquipment.each do |space_equipment|</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="240">
          <span class="hits">18</span>
          
          <code class="ruby">          next if not space_equipment.name.to_s.start_with? Constants.ObjectNameShower</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="242">
          <span class="hits">17</span>
          
          <code class="ruby">          if space_equipment.schedule.is_initialized</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">            # Check if there is a recirc pump referencing this schedule</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="244">
          <span class="hits">17</span>
          
          <code class="ruby">            model.getElectricEquipments.each do |ee|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">              next if ee.name.to_s != obj_name_recirc_pump</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">              next if not ee.schedule.is_initialized</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">              next if ee.schedule.get.handle.to_s != space_equipment.schedule.get.handle.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">              recirc_pump = ee</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="253">
          <span class="hits">17</span>
          
          <code class="ruby">        if not recirc_pump.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">          recirc_pump.setSchedule(sch_sh.schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="257">
          <span class="hits">17</span>
          
          <code class="ruby">        tot_sh_gpd += sh_gpd</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">      # Sinks</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="261">
          <span class="hits">21</span>
          
          <code class="ruby">      if s_gpd &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">        # Create schedule</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="264">
          <span class="hits">19</span>
          
          <code class="ruby">        sch_s = HotWaterSchedule.new(model, runner, Constants.ObjectNameSink + &quot; schedule&quot;, Constants.ObjectNameSink + &quot; temperature schedule&quot;, nbeds, d_sh, &quot;Sink&quot;, mixed_use_t, create_sch_object = true, schedule_type_limits_name = Constants.ScheduleTypeLimitsFraction)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="265">
          <span class="hits">19</span>
          
          <code class="ruby">        if not sch_s.validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">          return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="269">
          <span class="hits">19</span>
          
          <code class="ruby">        s_peak_flow = sch_s.calcPeakFlowFromDailygpm(s_gpd)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="270">
          <span class="hits">19</span>
          
          <code class="ruby">        s_design_level = sch_s.calcDesignLevelFromDailykWh(s_tot_load)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">        # Add water use equipment objects</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="273">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu_def = OpenStudio::Model::WaterUseEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="274">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu = OpenStudio::Model::WaterUseEquipment.new(s_wu_def)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="275">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu.setName(obj_name_s)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="276">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu.setSpace(space)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="277">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu_def.setName(obj_name_s)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="278">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu_def.setPeakFlowRate(s_peak_flow)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="279">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu_def.setEndUseSubcategory(obj_name_s)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="280">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu.setFlowRateFractionSchedule(sch_s.schedule)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="281">
          <span class="hits">19</span>
          
          <code class="ruby">        s_wu_def.setTargetTemperatureSchedule(sch_s.temperatureSchedule)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="282">
          <span class="hits">19</span>
          
          <code class="ruby">        water_use_connection.addWaterUseEquipment(s_wu)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">        # Add other equipment</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="285">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe_def = OpenStudio::Model::OtherEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="286">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe = OpenStudio::Model::OtherEquipment.new(s_oe_def)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="287">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe.setName(obj_name_s)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="288">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe.setSpace(space)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="289">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe_def.setName(obj_name_s)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="290">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe_def.setDesignLevel(s_design_level)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="291">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe_def.setFractionRadiant(0)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="292">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe_def.setFractionLatent(s_lat)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="293">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe_def.setFractionLost(0)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="294">
          <span class="hits">19</span>
          
          <code class="ruby">        s_oe.setSchedule(sch_s.schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="296">
          <span class="hits">19</span>
          
          <code class="ruby">        tot_s_gpd += s_gpd</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">      # Baths</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="300">
          <span class="hits">21</span>
          
          <code class="ruby">      if b_gpd &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">        # Create schedule</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="303">
          <span class="hits">19</span>
          
          <code class="ruby">        sch_b = HotWaterSchedule.new(model, runner, Constants.ObjectNameBath + &quot; schedule&quot;, Constants.ObjectNameBath + &quot; temperature schedule&quot;, nbeds, d_sh, &quot;Bath&quot;, mixed_use_t, create_sch_object = true, schedule_type_limits_name = Constants.ScheduleTypeLimitsFraction)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="304">
          <span class="hits">19</span>
          
          <code class="ruby">        if not sch_b.validated?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">          return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="308">
          <span class="hits">19</span>
          
          <code class="ruby">        b_peak_flow = sch_b.calcPeakFlowFromDailygpm(b_gpd)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="309">
          <span class="hits">19</span>
          
          <code class="ruby">        b_design_level = sch_b.calcDesignLevelFromDailykWh(b_tot_load)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby">        # Add water use equipment objects</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="312">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu_def = OpenStudio::Model::WaterUseEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="313">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu = OpenStudio::Model::WaterUseEquipment.new(b_wu_def)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="314">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu.setName(obj_name_b)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="315">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu.setSpace(space)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="316">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu_def.setName(obj_name_b)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="317">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu_def.setPeakFlowRate(b_peak_flow)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="318">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu_def.setEndUseSubcategory(obj_name_b)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="319">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu.setFlowRateFractionSchedule(sch_b.schedule)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="320">
          <span class="hits">19</span>
          
          <code class="ruby">        b_wu_def.setTargetTemperatureSchedule(sch_b.temperatureSchedule)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="321">
          <span class="hits">19</span>
          
          <code class="ruby">        water_use_connection.addWaterUseEquipment(b_wu)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">        # Add other equipment</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="324">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe_def = OpenStudio::Model::OtherEquipmentDefinition.new(model)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="325">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe = OpenStudio::Model::OtherEquipment.new(b_oe_def)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="326">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe.setName(obj_name_b)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="327">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe.setSpace(space)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="328">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe_def.setName(obj_name_b)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="329">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe_def.setDesignLevel(b_design_level)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="330">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe_def.setFractionRadiant(0)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="331">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe_def.setFractionLatent(b_lat)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="332">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe_def.setFractionLost(0)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="333">
          <span class="hits">19</span>
          
          <code class="ruby">        b_oe.setSchedule(sch_b.schedule)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="335">
          <span class="hits">19</span>
          
          <code class="ruby">        tot_b_gpd += b_gpd</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="338">
          <span class="hits">21</span>
          
          <code class="ruby">      if sh_gpd &gt; 0 or s_gpd &gt; 0 or b_gpd &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="339">
          <span class="hits">19</span>
          
          <code class="ruby">        msgs &lt;&lt; &quot;Shower, sinks, and bath fixtures drawing #{sh_gpd.round(1)}, #{s_gpd.round(1)}, and #{b_gpd.round(1)} gal/day respectively have been added to plant loop &#39;#{plant_loop.name}&#39; and assigned to space &#39;#{space.name.to_s}&#39;.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">    # Reporting</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="344">
          <span class="hits">11</span>
          
          <code class="ruby">    if msgs.size &gt; 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="345">
          <span class="hits">2</span>
          
          <code class="ruby">      msgs.each do |msg|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="346">
          <span class="hits">12</span>
          
          <code class="ruby">        runner.registerInfo(msg)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="348">
          <span class="hits">2</span>
          
          <code class="ruby">      runner.registerFinalCondition(&quot;The building has been assigned shower, sink, and bath fixtures drawing a total of #{(tot_sh_gpd + tot_s_gpd + tot_b_gpd).round(1)} gal/day across #{units.size} units.&quot;)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="349">
          <span class="hits">9</span>
          
          <code class="ruby">    elsif msgs.size == 1</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="350">
          <span class="hits">7</span>
          
          <code class="ruby">      runner.registerFinalCondition(msgs[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="352">
          <span class="hits">2</span>
          
          <code class="ruby">      runner.registerFinalCondition(&quot;No shower, sink, or bath fixtures have been assigned.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="355">
          <span class="hits">11</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="358">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_existing(runner, space, obj_names)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">    # Remove any existing ssb</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="360">
          <span class="hits">68</span>
          
          <code class="ruby">    objects_to_remove = []</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="361">
          <span class="hits">68</span>
          
          <code class="ruby">    space.otherEquipment.each do |space_equipment|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="362">
          <span class="hits">10</span>
          
          <code class="ruby">      found = false</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="363">
          <span class="hits">10</span>
          
          <code class="ruby">      obj_names.each do |obj_name|</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="364">
          <span class="hits">30</span>
          
          <code class="ruby">        next if not space_equipment.name.to_s.start_with? obj_name</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="365">
          <span class="hits">9</span>
          
          <code class="ruby">        next if space_equipment.name.to_s.include? &quot;=&quot; # TODO: Skip dummy distribution objects; can remove once we are using AdditionalProperties</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="367">
          <span class="hits">9</span>
          
          <code class="ruby">        found = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="369">
          <span class="hits">10</span>
          
          <code class="ruby">      next if not found</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="371">
          <span class="hits">9</span>
          
          <code class="ruby">      objects_to_remove &lt;&lt; space_equipment</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="372">
          <span class="hits">9</span>
          
          <code class="ruby">      objects_to_remove &lt;&lt; space_equipment.otherEquipmentDefinition</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="373">
          <span class="hits">9</span>
          
          <code class="ruby">      if space_equipment.schedule.is_initialized</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="374">
          <span class="hits">9</span>
          
          <code class="ruby">        objects_to_remove &lt;&lt; space_equipment.schedule.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="377">
          <span class="hits">68</span>
          
          <code class="ruby">    space.waterUseEquipment.each do |space_equipment|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="378">
          <span class="hits">12</span>
          
          <code class="ruby">      found = false</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="379">
          <span class="hits">12</span>
          
          <code class="ruby">      obj_names.each do |obj_name|</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="380">
          <span class="hits">36</span>
          
          <code class="ruby">        next if not space_equipment.name.to_s.start_with? obj_name</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="381">
          <span class="hits">12</span>
          
          <code class="ruby">        next if space_equipment.name.to_s.include? &quot;=&quot; # TODO: Skip dummy distribution objects; can remove once we are using AdditionalProperties</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="383">
          <span class="hits">9</span>
          
          <code class="ruby">        found = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="385">
          <span class="hits">12</span>
          
          <code class="ruby">      next if not found</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="387">
          <span class="hits">9</span>
          
          <code class="ruby">      objects_to_remove &lt;&lt; space_equipment</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="388">
          <span class="hits">9</span>
          
          <code class="ruby">      objects_to_remove &lt;&lt; space_equipment.waterUseEquipmentDefinition</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="389">
          <span class="hits">9</span>
          
          <code class="ruby">      if space_equipment.flowRateFractionSchedule.is_initialized</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="390">
          <span class="hits">9</span>
          
          <code class="ruby">        objects_to_remove &lt;&lt; space_equipment.flowRateFractionSchedule.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="392">
          <span class="hits">9</span>
          
          <code class="ruby">      if space_equipment.waterUseEquipmentDefinition.targetTemperatureSchedule.is_initialized</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="393">
          <span class="hits">9</span>
          
          <code class="ruby">        objects_to_remove &lt;&lt; space_equipment.waterUseEquipmentDefinition.targetTemperatureSchedule.get</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="396">
          <span class="hits">68</span>
          
          <code class="ruby">    if objects_to_remove.size &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="397">
          <span class="hits">3</span>
          
          <code class="ruby">      runner.registerInfo(&quot;Removed existing showers, sinks, and baths from space &#39;#{space.name.to_s}&#39;.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="399">
          <span class="hits">68</span>
          
          <code class="ruby">    objects_to_remove.uniq.each do |object|</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="400">
          <span class="hits">54</span>
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="401">
          <span class="hits">54</span>
          
          <code class="ruby">        object.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">      rescue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby">        # no op</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">end # end the measure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby"># this allows the measure to be use by the application</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="410">
          <span class="hits">1</span>
          
          <code class="ruby">ResidentialHotWaterFixtures.new.registerWithApplication</code>
        </li>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
